function ProjectHubHeaderCtrl(n,t,i,r,u,f){function wi(n){if(n=="gridCapsWaterWaste"&&$("#"+n).data("kendoGrid").dataSource.data().length>=10){alert(moreThanTenRowsInGrid);return}var t=$("#"+n).data("kendoGrid");t.addRow()}function bi(){e.isUnitCost=e.capsDataInfo.EnergyCostImpactPerYear!=null&&e.capsDataInfo.EnergyCostImpactPerYear!=""?!1:null;i.$digest()}function ki(){e.isUnitCostWW=e.capsDataInfo.EnergyWaterImpactCostPerYear!=null&&e.capsDataInfo.EnergyWaterImpactCostPerYear!=""||e.capsDataInfo.EnergyWasteImpactCostPerYear!=null&&e.capsDataInfo.EnergyWasteImpactCostPerYear!=""?!1:null;i.$digest()}function ii(n){var o=n.sender.value();if(confirm(ProjectScopeMessage)){if(n.dataItem.LookUpMemberName!=""){e.selectedScopeData=e.dsProjectScopeData.filter(function(t){return t.ProjectScope==n.dataItem.LookUpMemberName});var t=e.selectedScopeData.filter(function(n){return n.Category=="Duration"}),r=e.selectedScopeData.filter(function(n){return n.Category=="People (FTE Months)"}),u=e.selectedScopeData.filter(function(n){return n.Category=="Total CAPEX"}),f=e.selectedScopeData.filter(function(n){return n.Category=="Total Non Non-FTE OPEX"});e.tops.DurationBaseCase=t[0].BaseCase;e.tops.DurationHighCase=t[0].HighCase;e.tops.PeopleFTEMonthsRequiredBaseCase=r[0].BaseCase;e.tops.PeopleFTEMonthsRequiredHighCase=r[0].HighCase;e.tops.TotalCapExBaseCase=u[0].BaseCase;e.tops.TotalCapExHighCase=u[0].HighCase;e.tops.TotalNonFTEOpExBaseCase=f[0].BaseCase;e.tops.TotalNonFTEOpExHighCase=f[0].HighCase;i.$digest()}}else n.preventDefault(),i.$digest()}function di(){var n=$("#dialogTopsProjectScope");ei();n.data("kendoWindow").open()}function gi(n,t){n==!0?e.SelectedProject.qualityref=!0:confirm(qualityGridClearMessage)?(e.SelectedProject.qualityref=!1,c.length==0?(c=[],$("#qualityGrid").data("kendoGrid").dataSource.read()):$("#qualityGrid").data("kendoGrid")!=undefined&&(rt=$("#qualityGrid").data("kendoGrid").dataSource.data(),c=[],$("#qualityGrid").data("kendoGrid").dataSource.read())):t.preventDefault()}function nr(n,t){n==!0?e.OEProjectVisibleSolution=!0:confirm(oeTypeClearMessage)?(e.OEProjectVisibleSolution=!1,e.selectedOEProjectType=""):t.preventDefault()}function tr(n,t){n==!0?e.agileVisible=!0:confirm(agileTypeClearMessage)?(e.agileVisible=!1,e.selectedAgilePrimaryWorkstream="",e.agileSecWorkstreamIds="",e.selectedAgileWave=""):t.preventDefault()}function ir(n,t){n==!0?e.isPOBOSVisible=!0:confirm(pOBOSClearMessage)?(e.isPOBOSVisible=!1,e.SelectedProject.POBOSCategory=""):t.preventDefault()}function rr(n,t){n==!0?e.IsGMSGQLTAnnualMustWinVisible=!0:confirm(GMSGQLTAnnualMustWinClearMessage)?(e.IsGMSGQLTAnnualMustWinVisible=!1,e.selectedStrategicYear="",e.selectedAnnualMustWin=""):t.preventDefault()}function ur(n,t){n==!0?e.isSiteAssessmentVisible=!0:confirm(SiteAssessmentClearMessage)?(e.isSiteAssessmentVisible=!1,e.SelectedProject.SiteAssessmentCategory=""):t.preventDefault()}function fr(){var t,n,u;trackEvent("Project details and forms - Local Attribute tab");try{t=[];n="";s=[];$.when(f.postDataWCF("getLocalVariableByProjectId",SeletedProjectId)).then(function(r){e.local=JSON.parse(r.getLocalVariableByProjectIdResult);e.local.length>0?(e.NoAttribute=!1,$.each(e.local,function(i,r){if(r.LookupName!=""){var u=$.grep(t,function(n){return r.LookupName===n.LookupName});u.length===0&&(t.push(r),n=n+","+r.LookupName)}r.localVariableID=r.DataType=="People"?r.LocalVariableValue:"";r.MultilocalVariableIDArray=[];r.LocalVariableValueRangeEnd="";r.localVariablepplID=[];r.DataType=="People"&&r.LocalVariableValue!=""&&$.when(f.postDataWCF("getUserDetailsByIdMultiple",r.LocalVariableValue)).then(function(n){var t=JSON.parse(n.getUserDetailsByIdMultipleResult);angular.forEach(t,function(n){var t={};t.text=n.UserDisplayName;t.value=n.UserADId;t.UserDisplayName=n.UserDisplayName;t.UserADId=n.UserADId;t.UserCountry=n.UserCountry;t.UserImageUrl=n.UserImageUrl;t.UserEmailAddress=n.UserEmailAddress;t.UserDepartment=n.UserDepartment;r.localVariablepplID.push(t);r.MultilocalVariableIDArray.push(n.UserADId);s.push(t)})})}),$.when(f.postDataWCFAsync("getLookupData",n.substring(1))).then(function(n){try{nt=JSON.parse(n.getLookupDataResult);er();i.$digest()}catch(t){var r={method:"getLocalAttributes",exceptionMessage:"message:"+t.message+" stack:"+t.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",r)).then(function(){alert(errormessage)})}})):(e.NoAttribute=!0,i.$digest())})}catch(r){u={method:"getLocalAttributes",exceptionMessage:"message:"+r.message+" stack:"+r.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",u)).then(function(){alert(errormessage)})}}function er(){var n=[{field:"LocalVariableUniqueID",title:"LocalVariableUniqueID",hidden:!0},{field:"DataType",title:"Type",hidden:!0},{field:"LocalVariableName",title:"Local Variable Name"},{field:"LocalVariableValue",title:"Value",template:or}],t=new kendo.data.DataSource({data:e.local,schema:{model:{id:"LocalVariableUniqueID",fields:{LocalVariableUniqueID:{editable:!1,nullable:!0},LocalVariableName:{type:"string",editable:!1},DataType:{type:"string",editable:!1}}}}});$("#gridLocalAttributes").kendoGrid({dataSource:t,columns:n,dataBound:function(){var n=this,a,tt,c,vt,w,k,r,b,g,yt,st,p,t,ht,ct;$("#gridLocalAttributes .k-grid-content").on("change","input.chkbxLocal",function(n){var i=$("#gridLocalAttributes").data("kendoGrid"),t=i.dataItem($(n.target).closest("tr"));t!=undefined&&t.set("LocalVariableValue",this.checked)});$("#gridLocalAttributes .k-grid-content").on("change","input.textbox",function(n){var i=$("#gridLocalAttributes").data("kendoGrid"),t=i.dataItem($(n.target).closest("tr"));t!=undefined&&t.set("LocalVariableValue",this.value)});$("#gridLocalAttributes .k-grid-content").on("change","textarea.multiTextbox",function(n){var i=$("#gridLocalAttributes").data("kendoGrid"),t=i.dataItem($(n.target).closest("tr"));t!=undefined&&t.set("LocalVariableValue",this.value)});for(a=$(".date"),tt=$(".dateValidationMsg"),c=0;c<a.length;c++){var lt=$(a[c]),at=lt.closest("tr"),h=n.dataItem(at);$(a[c]).attr("id",h.uid.toString());$(tt[c]).attr("id",h.uid.toString()+"Msg");$("#"+h.uid).kendoDatePicker({parseFormats:["MM/dd/yyyy"],placeholder:e.dateFormatlabel});vt=$("#"+h.uid).kendoValidator({rules:{datepicker:function(t){var i=t.val(),r,u,f;i!=""&&i!="null"?parseDate(i)?(d=!0,$("#"+h.uid+"Msg").hide(),r=this.element.closest("tr"),u=n.dataItem(r),u.LocalVariableValue=i):($("#"+h.uid+"Msg").show(),d=!1):($("#"+h.uid+"Msg").hide(),d=!0,f=n.dataItem(this.element.closest("tr")),f.LocalVariableValue="")}}}).data("kendoValidator")}for($(".numeric").kendoNumericTextBox({format:"n13",decimals:13,min:0,restrictDecimals:!0,max:999999999999,change:function(){var i=this.element.closest("tr"),t=n.dataItem(i);t.LocalVariableValue=this.value();t.dirty=!0}}),$(".numeric0").kendoNumericTextBox({format:"n0",decimals:0,min:0,restrictDecimals:!0,max:999999999999,change:function(){var i=this.element.closest("tr"),t=n.dataItem(i);t.LocalVariableValue=this.value();t.dirty=!0}}),$(".numeric2").kendoNumericTextBox({format:"n2",decimals:2,min:0,restrictDecimals:!0,max:999999999999,change:function(){var i=this.element.closest("tr"),t=n.dataItem(i);t.LocalVariableValue=this.value();t.dirty=!0}}),$(".numeric4").kendoNumericTextBox({format:"n4",decimals:4,min:0,restrictDecimals:!0,max:999999999999,change:function(){var i=this.element.closest("tr"),t=n.dataItem(i);t.LocalVariableValue=this.value();t.dirty=!0}}),w=$(".dropdown"),r=0;r<w.length;r++){var v=$(w[r]),it=v.closest("tr"),u=n.dataItem(it),y,l,rt=nt.filter(function(n){return n.LookUpName==u.LookupName});y=new kendo.data.DataSource({data:rt});l="LookUpMemberName";u.MultilocalVariableIDArray=u.LocalVariableValue.split("횧");b=u.MultilocalVariableIDArray;v.kendoMultiSelect({valuePrimitive:!0,dataTextField:l,dataValueField:l,dataSource:y,value:b,change:function(t){var f=this.element.closest("tr"),i=n.dataItem(f),r,e,u;t.sender.dataItem()==null?(i.dirty=!0,i.set("LocalVariableValue",""),i.set("LocalVariableValue",""),i.MultilocalVariableIDArray=[],$("#gridLocalAttributes").data("kendoGrid").refresh()):(r=this.value(),e=[],i.MultilocalVariableIDArray=[],angular.forEach(r,function(n){i.MultilocalVariableIDArray.push(n)}),u=i.MultilocalVariableIDArray.join("횧"),i.set("LocalVariableValue",u),i.dirty=!0)}})}for(k=$(".singleselect"),r=0;r<k.length;r++){var v=$(k[r]),it=v.closest("tr"),u=n.dataItem(it),y,l,rt=nt.filter(function(n){return n.LookUpName==u.LookupName});y=new kendo.data.DataSource({data:rt});l="LookUpMemberName";u.MultilocalVariableIDArray=u.LocalVariableValue;b=u.MultilocalVariableIDArray;v.kendoComboBox({valuePrimitive:!0,dataTextField:l,dataValueField:l,dataSource:y,change:function(t){var r=this.element.closest("tr"),i=n.dataItem(r);t.sender.dataItem()==null?(i.dirty=!0,i.set("LocalVariableValue",""),$("#gridLocalAttributes").data("kendoGrid").refresh()):this.value()&&this.select()===-1?(i.set("LocalVariableValue",""),$("#gridLocalAttributes").data("kendoGrid").refresh()):(i.set("LocalVariableValue",this.value()),i.dirty=!0)}})}for(g=$(".people"),t=0;t<g.length;t++){var ut=$(g[t]),ft=ut.closest("tr"),o=n.dataItem(ft),et=[],ot=o.localVariablepplID;angular.forEach(ot,function(n){et.push(n.UserADId)});yt=f.searchPeopleMultiselect(o.uid,et,ot);st=$("#"+o.uid).data("kendoMultiSelect");st.bind("change",function(){var f=this.value(),u=this.element.closest("tr"),t=n.dataItem(u),i=[],r=[];angular.forEach(this.dataItems(),function(n){i.push(n);r.push(n.UserADId)});t.set("localVariablepplID",i);t.set("MultilocalVariableIDArray",r);t.dirty=!0})}for(p=$(".singlePeople"),t=0;t<p.length;t++){var ut=$(p[t]),ft=ut.closest("tr"),o=n.dataItem(ft);$(p[t]).attr("id",o.uid.toString());$("#"+o.uid).kendoComboBox({autoBind:!1,placeholder:"Select and/or Type to Search",dataTextField:"text",dataValueField:"text",valuePrimitive:!0,minLength:3,filtering:function(n){n.preventDefault()},filter:"contains",dataSource:s,valueTemplate:'<span class="selected-value" style="background-image:url(#: UserImageUrl#)"><\/span><span>#: text#<\/span>',template:"<span class='k-state-default' style=background-image:url(#: UserImageUrl#)><\/span><span class='k-state-default'><h3>#: text#<\/h3># if (UserEmailAddress != null) {#<p>#: UserEmailAddress#<\/p># } if (UserDepartment != null) {# <p><span> #:UserDepartment#<\/span># }if (UserCountry != null) {# <span>#:UserCountry#<\/span><\/p># } #<\/span>",change:function(t){var r=this.element.closest("tr"),i=n.dataItem(r);t.sender.dataItem()==null?(i.LocalVariableValue=null,i.dirty=!0):(i.LocalVariableValue=this.value(),i.localVariableID=this.dataItem().value,i.dirty=!0)}});s.length==1?(ht=$("#"+o.uid).data("kendoComboBox"),ht.value(s[0].text)):s.length>1&&(ct=$("#"+o.uid).data("kendoComboBox"),ct.value(o.LocalVariableValue))}$("#gridLocalAttributes .k-grid-content").on("keydown","input.singlePeople",function(n){var i=$("#gridLocalAttributes").data("kendoGrid"),t=i.dataItem($(n.target).closest("tr"));f.searchPeopleBulkEdit(n,t.uid).then(function(n){if(n.length>0){angular.forEach(n,function(n){var t=s.filter(function(t){return t.value===n.UserADId});t.length==0&&s.push({text:n.UserDisplayName,value:n.UserADId,UserCountry:n.UserCountry,UserImageUrl:n.UserImageUrl,UserEmailAddress:n.UserEmailAddress,UserDepartment:n.UserDepartment})});var i=$("#"+t.uid).data("kendoComboBox");i.setDataSource(s);i.dataSource.read();$("#gridLocalAttributes").getKendoGrid().columns[1].values=s}})});i.$digest()}})}function or(n){if(n==null)return"";switch(n.DataType){case"Date":return"<div class='fullWidthAttributes'><input class='date' value='"+n.LocalVariableValue+"' /><label class='dateValidationMsg' style='display:none;color:red'>"+e.dateErrorMsg+"<\/label><\/div>";case"Boolean":if(n.LocalVariableValue=="true"||n.LocalVariableValue==!0)return"<div><input type='checkbox' checked class='chkbxLocal' /><\/div ";if(n.LocalVariableValue==!1||n.LocalVariableValue=="false")return"<div><input type='checkbox' class='chkbxLocal' /><\/div> ";break;case"Text":switch(n.IsMulti){case!1:return"<div class='fullWidthAttributes'><input class='textbox' value='"+n.LocalVariableValue+"' /><\/div>";case!0:return"<div class='fullWidthAttributes'><textarea style='height:"+parseInt(n.LineDecimalCount)*22+"px;width: 100%;'  class='multiTextbox' value='"+n.LocalVariableValue+"' id='"+n.uid+"'>"+n.LocalVariableValue+"<\/textarea><\/div>"}case"Number":switch(n.LineDecimalCount){case 0:return"<div class='fullWidthAttributes'><input class='numeric0' value='"+n.LocalVariableValue+"' /><\/div>";case 2:return"<div class='fullWidthAttributes'><input class='numeric2' value='"+n.LocalVariableValue+"' /><\/div>";case 4:return"<div class='fullWidthAttributes'><input class='numeric4' value='"+n.LocalVariableValue+"' /><\/div>";default:return"<div class='fullWidthAttributes'><input class='numeric' value='"+n.LocalVariableValue+"' /><\/div>"}case"Lookup":switch(n.IsMulti){case!1:return"<div class='fullWidthAttributes'><input class='singleselect' value='"+n.LocalVariableValue+"' /><\/div>";case!0:return"<div class='fullWidthAttributes'><input class='dropdown' value='"+n.MultilocalVariableIDArray+"' /><\/div>"}case"People":switch(n.IsMulti){case!1:return"<div class='fullWidthAttributes'><input class='singlePeople' value='"+n.LocalVariableValue+"' id='"+n.uid+"' /><\/div>";case!0:return"<div class='fullWidthAttributes'><input class='people' value='"+n.localVariablepplID+"' id='"+n.uid+"' /><\/div>"}default:return n.LocalVariableValue}}function ri(){var n=new kendo.data.DataSource({data:e.local,schema:{model:{id:"LocalVariableUniqueID",fields:{LocalVariableUniqueID:{editable:!1,nullable:!0},LocalVariableName:{type:"string",editable:!1},DataType:{type:"string",editable:!1}}}}}),t=$("#gridLocalAttributes").data("kendoGrid");n.read();t.setDataSource(n)}function sr(){var t,n,i,u;displayLoading();try{if(!d)return hideLoading(),!1;t=$("#gridLocalAttributes").data("kendoGrid").dataSource.data();n=[];$.each(t,function(t,i){var u={},r="";i.DataType=="Lookup"&&i.IsMulti==!0&&(angular.forEach(i.MultilocalVariableIDArray,function(n){r=r+"횧"+n}),r=r.substring(1));i.DataType=="Lookup"&&i.IsMulti==!1?r=i.LocalVariableValue:i.DataType=="People"&&i.IsMulti==!0?(angular.forEach(i.MultilocalVariableIDArray,function(n){r=r+"횧"+n}),r=r.substring(1)):i.DataType=="People"&&i.IsMulti==!1&&(r=i.localVariableID);u.LocalVariableUniqueID=i.LocalVariableUniqueID;u.DataType=i.DataType;u.LocalVariableValue=i.DataType=="People"||i.DataType=="Lookup"?r:i.LocalVariableValue;n.push(u)});i={ProjectID:SeletedProjectId,objLocalVariablesData:JSON.stringify(n)};f.postDataWCF("insertUpdateLocalVariableByProjectId",i).then(function(n){n=="Success"?$.when(f.postDataWCF("getLocalVariableByProjectId",SeletedProjectId)).then(function(n){e.local=JSON.parse(n.getLocalVariableByProjectIdResult);e.local.length>0&&(e.NoAttribute=!1,$.each(e.local,function(n,t){t.localVariableID=t.DataType=="People"?t.LocalVariableValue:"";t.MultilocalVariableIDArray=[];t.LocalVariableValueRangeEnd="";t.localVariablepplID=[];t.DataType=="People"&&t.LocalVariableValue!=""&&$.when(f.postDataWCF("getUserDetailsByIdMultiple",t.LocalVariableValue)).then(function(n){var i=JSON.parse(n.getUserDetailsByIdMultipleResult);angular.forEach(i,function(n){var i={};i.text=n.UserDisplayName;i.value=n.UserADId;i.UserDisplayName=n.UserDisplayName;i.UserADId=n.UserADId;i.UserCountry=n.UserCountry;i.UserImageUrl=n.UserImageUrl;i.UserEmailAddress=n.UserEmailAddress;i.UserDepartment=n.UserDepartment;t.localVariablepplID.push(i);t.MultilocalVariableIDArray.push(n.UserADId);s.push(i)});ri()})}),ri());alert(saveMessage);hideLoading()}):(hideLoading(),alert("Error occurred in Local Attribute Insert/Update"))})}catch(r){hideLoading();u={method:"saveLocalAttribute",exceptionMessage:"message:"+r.message+" stack:"+r.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",u)).then(function(){alert(errormessage)})}}function hr(){$.when(f.postDataWCF("getPortfolioDeliverablesStatus",SeletedProjectId)).then(function(n){e.dsDeliverableDate=JSON.parse(n.getPortfolioDeliverablesStatusResult);e.CharterApprovedDate=e.dsDeliverableDate[0].CharterApprovedDate;e.CharterModifiedDate=e.dsDeliverableDate[0].CharterModifiedDate;e.BusinessApprovedDate=e.dsDeliverableDate[0].BusinessApprovedDate;e.BusinessModifiedDate=e.dsDeliverableDate[0].BusinessModifiedDate;e.CloseOutModifiedDate=e.dsDeliverableDate[0].CloseoutModifiedDate;e.CloseOutApprovedDate=e.dsDeliverableDate[0].CloseoutApprovedDate;e.BusinessCaseGeneratedDate=e.dsDeliverableDate[0].BusinessCaseGeneratedDate;e.FundingDeckGeneratedDate=e.dsDeliverableDate[0].FundingDeckGeneratedDate;e.PortfolioReportGeneratedDate=e.dsDeliverableDate[0].PortfolioReportGeneratedDate;e.PortfolioReportPerformanceGeneratedDate=e.dsDeliverableDate[0].PortfolioReportPerformanceGeneratedDate;e.ProjectCharterGeneratedDate=e.dsDeliverableDate[0].ProjectCharterGeneratedDate;e.CloseOutGeneratedDate=e.dsDeliverableDate[0].CloseOutGeneratedDate;e.GMSPTProgramDashboardDate=e.dsDeliverableDate[0].GMSPTProgramDashboard;i.$digest()})}function cr(){trackEvent("Import data");var n={ProjectID:SeletedProjectId,userId:currentUserId};f.postDataWCF("importBuissnessData",n).then(function(n){alert(n);v=!0;n=="Data Import Successful"&&(window.location.href=projectHubpath+"?ProblemTitle="+SeletedProjectName+"&ProblemID="+SeletedProjectId)})}function lr(){var n=$("#qualityGrid").data("kendoGrid");n.addRow()}function ar(){var t,i,r,u,v,s,it,h,a,p,g;try{if(t=[],e.SelectedParentProject==null&&e.SelectedProject.ParentProgramID!=null?ut=!0:e.SelectedProject!=null&&e.SelectedProject!=undefined&&e.SelectedParentProject!=null&&e.SelectedProject.ParentProgramID!=e.SelectedParentProject.ProblemUniqueID&&(ut=!0),e.ExecutionScopeIds!=null&&(r=e.ExecutionScopeIds.join(",")),e.ImpactedProductIds!=null&&(i=e.ImpactedProductIds.join(",")),e.selectedOEProjectType!=null&&e.selectedOEProjectType!=""&&(u=e.selectedOEProjectType.join(",")),e.agileSecWorkstreamIds!=null&&e.agileSecWorkstreamIds!=""&&(v=e.agileSecWorkstreamIds.join(",")),e.qualityInsertListItems=[],e.qualityUpdateListItems=[],$("#qualityGrid").data("kendoGrid")!=undefined){var y=$("#qualityGrid").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),nt=y.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),tt=y.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(nt,function(n){var t={};t.QualityUniqueID=n.QualityUniqueID;t.QualityReferenceTypeID=n.QualityReferenceTypeID;t.QualityReference=n.QualityReference;e.qualityInsertListItems.push(t)});angular.forEach(tt,function(n){var t={};t.QualityUniqueID=n.QualityUniqueID;t.QualityReferenceTypeID=n.QualityReferenceTypeID;t.QualityReference=n.QualityReference;e.qualityUpdateListItems.push(t)})}rt.length>0&&(e.deletedQualityData=[],angular.forEach(rt,function(n){e.deletedQualityData.push({QualityUniqueID:n.QualityUniqueID})}));e.insertUpdateDeleteQuality={insert:e.qualityInsertListItems,update:e.qualityUpdateListItems,"delete":e.deletedQualityData};s=[];s.push(e.insertUpdateDeleteQuality);it=$("#ddl_GI_ParentProg").data("kendoComboBox");$("#ddl_GI_ParentProg").data("kendoComboBox").select()===-1&&(e.SelectedParentProject=null,$("#ddl_GI_ParentProg").data("kendoComboBox").value(""));h=[];a=[];e.POBOSCategoryIds!=null&&e.POBOSCategoryIds!=""&&(h=e.POBOSCategoryIds.length>1?e.POBOSCategoryIds.join(","):e.POBOSCategoryIds[0]);e.SiteAssessmentCategoryIds!=null&&e.SiteAssessmentCategoryIds!=""&&(a=e.SiteAssessmentCategoryIds.length>1?e.SiteAssessmentCategoryIds.join(","):e.SiteAssessmentCategoryIds[0]);e.projectSelectorData={IsConfidential:e.SelectedProject.IsConfidential!=null?e.SelectedProject.IsConfidential:!1,ProjectID:e.SelectedProject.ProjectID,ProjectName:e.SelectedProject.ProjectName!=null?e.SelectedProject.ProjectName:null,PrimaryProductID:e.selectedPrimaryProduct!=null?e.selectedPrimaryProduct.LookUpMemberID:null,OtherImpactedProducts:i!=null?i:null,ExecutionScopeID:r!=null?r:null,ParentProgramID:e.SelectedParentProject!=null&&e.SelectedParentProject.ProblemUniqueID!=""?e.SelectedParentProject.ProblemUniqueID:null,ProjectDescription:e.SelectedProject.ProjectDescription!=null?e.SelectedProject.ProjectDescription:null,PortfolioOwnerID:e.selectedPortfolioOwner!=null?e.selectedPortfolioOwner.LookUpMemberID:null,CampaignTypeID:e.SelectedProject.IsTechTransfer==!0?e.selectedCampaignType!=null?e.selectedCampaignType.LookUpMemberID:null:null,CampaignPhaseID:e.SelectedProject.IsTechTransfer==!0?e.selectedCampaignPhase!=null?e.selectedCampaignPhase.LookUpMemberID:null:null,ProductionStepID:e.SelectedProject.IsTechTransfer==!0?e.selectedProductionStep!=null?e.selectedProductionStep.LookUpMemberID:null:null,IsOEProject:e.SelectedProject.IsOEProject!=null?e.SelectedProject.IsOEProject:null,OEProjectType:e.SelectedProject.IsOEProject==!0?u!=null?u:null:null,IsTechTransfer:e.SelectedProject.IsTechTransfer,ProblemType:e.selectedProjectType.LookUpMemberID,AgilePrimaryWorkstream:e.selectedAgilePrimaryWorkstream!=null&&e.selectedAgilePrimaryWorkstream!=""?e.selectedAgilePrimaryWorkstream.LookUpMemberID:null,AgileSecondaryWorkstream:v,AgileWave:e.selectedAgileWave!=null&&e.selectedAgileWave!=""?e.selectedAgileWave.LookUpMemberID:null,IsArchived:e.SelectedProject.IsArchived,IsCapsProject:e.SelectedProject.IsCapsProject!=null?e.SelectedProject.IsCapsProject:null,EmissionPortfolioID:e.SelectedEmissionPortfolio!=null?e.SelectedEmissionPortfolio.LookUpMemberID:null,IsGoodPractise:e.SelectedProject.IsGoodPractise!=null?e.SelectedProject.IsGoodPractise:null,IsPOBOS:e.SelectedProject.IsPOBOS!=null?e.SelectedProject.IsPOBOS:null,IsSiteAssessment:e.SelectedProject.IsSiteAssessment!=null?e.SelectedProject.IsSiteAssessment:null,POBOSCategory:e.POBOSCategoryIds!=null?h:null,SiteAssessmentCategory:e.SiteAssessmentCategoryIds!=null?a:null,PrimaryKPI:e.SelectedPrimaryKPI!=null&&e.SelectedPrimaryKPI!=""?e.SelectedPrimaryKPI.LookUpMemberID:null,IsGMSGQLTAnnualMustWin:e.SelectedProject.IsGMSGQLTAnnualMustWin!=null?e.SelectedProject.IsGMSGQLTAnnualMustWin:null,StrategicYearID:e.selectedStrategicYear!=null&&e.selectedStrategicYear!=""?e.selectedStrategicYear.LookUpMemberID:null,AnnualMustWinID:e.selectedAnnualMustWin!=null&&e.selectedAnnualMustWin!=""?e.selectedAnnualMustWin.LookUpMemberID:null};t.push(e.projectSelectorData);p={ProjectID:e.SelectedProject.ProjectID,objQualityData:JSON.stringify(s),objProjectInfoData:JSON.stringify(t),strUserAdId:currentUserId};f.postDataWCF("updateProjectInfoByID",p).then(function(t){t=="Success"?(console.log("1"),et=!0,n.$emit("UpdateHubSchedule"),alert(saveMessageGeneralInfo),$.when(f.getDataWCF("getQualityReferenceByProjectId/"+SeletedProjectId),f.getDataWCFAsync("getProjectInfoByID/"+SeletedProjectId)).then(function(n,t){var y,i,r,u,f,o,s,h,a,v;angular.copy(e.SelectedParentProject,l);y=JSON.parse(t.getProjectInfoByIDResult);e.SelectedProject=y[0];e.agileVisible=e.SelectedProject.IsAgile;i=[];e.SelectedProject.CampaignTypeID!=""&&(i=e.dsGICampaignType.filter(function(n){return n.LookUpMemberID==e.SelectedProject.CampaignTypeID}));e.selectedCampaignType=i.length>0?i[0]:null;r=[];e.SelectedProject.CampaignPhaseID!=""&&(r=e.dsGICampaignPhase.filter(function(n){return n.LookUpMemberID==e.SelectedProject.CampaignPhaseID}));e.selectedCampaignPhase=r.length>0?r[0]:null;u=[];e.SelectedProject.ProductionStepID!=""&&(u=e.dsGIProductionStep.filter(function(n){return n.LookUpMemberID==e.SelectedProject.ProductionStepID}));e.selectedProductionStep=u.length>0?u[0]:null;f=[];e.SelectedProject.AgilePrimaryWorkstream!=null&&e.SelectedProject.AgilePrimaryWorkstream!=""&&(f=e.dsAgilePrimaryWorkstation.filter(function(n){return n.LookUpMemberID==e.SelectedProject.AgilePrimaryWorkstream}));e.selectedAgilePrimaryWorkstream=f.length>0?f[0]:"";o=[];e.SelectedProject.AgileWave!=null&&e.SelectedProject.AgileWave!=""&&(o=e.dsAgileWave.filter(function(n){return n.LookUpMemberID==e.SelectedProject.AgileWave}));e.selectedAgileWave=o.length>0?o[0]:"";s=[];e.SelectedProject.EmissionPortfolioID!=null&&e.SelectedProject.EmissionPortfolioID!=""&&(s=e.dsEmissionPortfolio.filter(function(n){return n.LookUpMemberID==e.SelectedProject.EmissionPortfolioID}));e.SelectedEmissionPortfolio=s.length>0?s[0]:"";b=e.SelectedEmissionPortfolio;k=e.SelectedEmissionPortfolio;w=e.SelectedProject.EMDataAssociation;h=[];e.SelectedProject.StrategicYear!=null&&e.SelectedProject.StrategicYear!=""&&(h=e.dsStrategicYear.filter(function(n){return n.LookUpMemberName==e.SelectedProject.StrategicYear}));e.selectedStrategicYear=h.length>0?h[0]:"";a=[];e.SelectedProject.AnnualMustWin!=null&&e.SelectedProject.AnnualMustWin!=""&&(a=e.dsAnnulMustWin.filter(function(n){return n.LookUpMemberName==e.SelectedProject.AnnualMustWin}));e.selectedAnnualMustWin=a.length>0?a[0]:"";v=[];e.SelectedProject.OEProjectType!=null&&e.SelectedProject.OEProjectType!="undefined"&&(v=e.SelectedProject.OEProjectType.split(","));e.selectedOEProjectType=v;e.deletedQualityData=[];c=JSON.parse(n.getQualityReferenceByProjectIdResult);$("#qualityGrid").data("kendoGrid").dataSource.read();e.SelectedProject.qualityref=c.length>0?!0:!1}),$.when(f.postDataWCF("getProjectNameByID",SeletedProjectId)).then(function(t){var i=JSON.parse(t.getProjectNameByIDResult);SeletedProjectName=i[0].ProjectName;ProjectSiteUrl=i[0].ProjectSiteURL;isConfidentialProject=i[0].IsConfidential;n.$emit("UpdateProjectNameHub",SeletedProjectName);n.$emit("ProjectHubGetCall",SeletedProjectName);ProjectSiteUrl!=null&&$.when(f.postDataWCFAsync("GetTokenForDocument")).then(function(n){var t=n.GetTokenForDocumentResult;$.when(f.isSiteUniquePermission(t,ProjectSiteUrl)).then(function(n){isConfidentialProject==!0&&n==!1?$.when(f.breakRolePermissionDocumentLibrary(t,ProjectSiteUrl)).then(function(){console.log("break permission on confidential project in Hub Header");f.createSPGroup(t)}):isConfidentialProject==!1&&n==!0&&$.when(f.resetUniquePermission(t,ProjectSiteUrl)).then(function(){console.log("Reset permission on confidential project in Hub Header");f.getGroupIdSPOTPMT(t,!0,SelectedProblemId+spGroupSuffix)})})})})):alert("Error occurred in Project Info Update")})}catch(d){g={method:"saveGIProjectInfoByID",exceptionMessage:"message:"+d.message+" stack:"+d.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",g)).then(function(){alert(errormessage)})}}function vr(){$("#dialogImportData").data("kendoWindow").bind("close",function(n){v?v=!1:confirm(dialogCloseMessage)||n.preventDefault()})}function yr(n){$("#"+n).data("kendoWindow").close()}function pr(t){ft||et?(ft=!1,et=!1,v=!1,y&&n.$emit("ReloadProjectHub"),ut&&n.$emit("UpdateAssociatedProject")):confirm(dialogCloseMessage)?(y&&n.$emit("ReloadProjectHub"),ut&&n.$emit("UpdateAssociatedProject")):t.preventDefault()}function wr(){var n,t;at==!1&&($("#dialogPrjDetails").data("kendoWindow").bind("close",function(n){pr(n)}),at=!0);n=$("#prjDetailTabStrip").kendoTabStrip().data("kendoTabStrip");n.select("li:first");kr();au("realizationDate");t=$("#dialogPrjDetails");t.data("kendoWindow").open()}function br(){if(confirm(confProgChangMsg)){e.SelectedParentProject={};var n=$("#ddl_GI_ParentProg").data("kendoComboBox");n.setDataSource([]);n.value("");y=!0}else e.SelectedProject.IsConfidential=!e.SelectedProject.IsConfidential}function kr(){var n,r;try{e.optionsCostImpact={format:"n0",decimals:0,restrictDecimals:!0};e.options={format:"n0",decimals:0,min:0,restrictDecimals:!0};e.optionsCurrency={format:"n0",decimals:0,min:0,restrictDecimals:!0};displayLoading();e.deletedQualityData=[];lt==0?(e.isPortfolioOwnerEditable=!1,n=qualityReferenceType+","+oeProjectType+","+portfolioOwner+","+product+","+campaignType+","+campaignPhase+","+ProductionStep+","+executionScope+","+projectType+","+agileAttribute+","+agileWave+","+projectScope+","+emissionPortfolio+","+pOBOSCategory+","+siteAssessmentCategory+","+topsPrimaryKpi+","+strategicYear+","+annualMustWin,$.when(f.postDataWCFAsync("getUserPermissionById",currentUserId),f.getDataWCFAsync("getUserPermissionByProjectUserId/"+currentUserId+"/"+SeletedProjectId),f.postDataWCFAsync("getLookupData",n),f.postDataWCFAsync("getTopsProjectScope",SeletedProjectId)).then(function(n,i,r,u){var c,l,a,s,h,v,y,p,b;try{for(c=$("#ddl_ProjectScope").data("kendoDropDownList"),c.bind("select",ii),l=$("#ddl_EmissionPortfolio").data("kendoComboBox"),l.bind("select",li),a=$("#ddl_EmissionPortfolio").data("kendoComboBox"),a.bind("change",eu),pi=r.getLookupDataResult,s=JSON.parse(r.getLookupDataResult),e.dsGIPortfolioOwner=s.filter(function(n){return n.LookUpName==portfolioOwner}),e.dsGIPrimaryProduct=s.filter(function(n){return n.LookUpName==product}),e.dsGIOEProjectType=s.filter(function(n){return n.LookUpName==oeProjectType}),dt=JSON.parse(n.getUserPermissionByIdResult).filter(function(n){return n.Permission==createConfidential}),e.dsGICampaignType=s.filter(function(n){return n.LookUpName==campaignType}),e.dsGICampaignPhase=s.filter(function(n){return n.LookUpName==campaignPhase}),e.dsGIProductionStep=s.filter(function(n){return n.LookUpName==ProductionStep}),it=s.filter(function(n){return n.LookUpName==qualityReferenceType}),e.dsGIExecutionScope=s.filter(function(n){return n.LookUpName==executionScope}),e.dsProjectType=s.filter(function(n){return n.LookUpName==projectType}),e.dsAgilePrimaryWorkstation=s.filter(function(n){return n.LookUpName==agileAttribute}),e.dsAgileWave=s.filter(function(n){return n.LookUpName==agileWave}),e.dsProjectScope=s.filter(function(n){return n.LookUpName==projectScope}),e.dsEmissionPortfolio=s.filter(function(n){return n.LookUpName==emissionPortfolio}),e.dsPOBOSCategory=s.filter(function(n){return n.LookUpName==pOBOSCategory}),e.dsSiteAssessmentCategory=s.filter(function(n){return n.LookUpName==siteAssessmentCategory}),e.dsGIPrimaryKPI=t("orderBy")(s.filter(function(n){return n.LookUpName==topsPrimaryKpi}),"LookUpMemberOrder"),e.dsStrategicYear=s.filter(function(n){return n.LookUpName==strategicYear}),e.dsAnnulMustWin=s.filter(function(n){return n.LookUpName==annualMustWin}),ct=[],h=0;h<it.length;h++)v={text:it[h].LookUpMemberName,value:it[h].LookUpMemberID},ct.push(v);e.dsPermission=JSON.parse(i.getUserPermissionByProjectUserIdResult);e.dsProjectScopeData=JSON.parse(u.getTopsProjectScopeResult);e.isEditable=e.dsPermission[0].canEdit==!0?!0:!1;y=JSON.parse(n.getUserPermissionByIdResult).filter(function(n){return n.Permission==EditPortfolioOwnerPerm});y.length>0&&e.isEditable==!0?(canPortfolioOwnerEdit=!0,e.isPortfolioOwnerEditable=canPortfolioOwnerEdit):(canPortfolioOwnerEdit=!1,e.isPortfolioOwnerEditable=canPortfolioOwnerEdit);p=new Date;console.log("first load before grid binding "+p.toString());fi();ai();lt++;ui()}catch(w){hideLoading();b={method:"prepareDataForProjectDetails_First",exceptionMessage:"message:"+w.message+" stack:"+w.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",b)).then(function(){alert(errormessage)})}})):ui()}catch(i){hideLoading();r={method:"prepareDataForProjectDetails",exceptionMessage:"message:"+i.message+" stack:"+i.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",r)).then(function(){alert(errormessage)})}}function ui(){e.UpdateDate(SeletedProjectName);var n={ProgramUID:SeletedProjectId,linkToChild:!1};$.when(f.getDataWCFAsync("getProjectInfoByID/"+SeletedProjectId),f.getDataWCFAsync("getQualityReferenceByProjectId/"+SeletedProjectId),f.postDataWCFAsync("getHubSetting",SeletedProjectId),f.postDataWCFAsync("getUserConfidentialProject",currentUserId)).then(function(n,t,r){var u,pt,s,h,a,v,y,p,d,g,nt,it,rt,ut,at;try{dt.length>0&&(e.isConfidentialVisible=!0);u=JSON.parse(n.getProjectInfoByIDResult);e.SelectedProject=u[0];e.localCurrencyAbbrePlaceholder=e.SelectedProject.LocalCurrencyAbbreviation;e.SelectedProject.LocalCurrencyAbbreviation!=null&&(e.localCurrencyAbbre="("+e.SelectedProject.LocalCurrencyAbbreviation+")");e.recordCreationDate=kendo.toString(kendo.parseDate(e.SelectedProject.CreatedDate),"MM/dd/yyyy");tt=u[0].ParentProgramID!=null&&u[0].ParentProgramName!=null?[{ProblemUniqueID:u[0].ParentProgramID,ProjectName:u[0].ParentProgramName}]:[];var vt=SeletedProjectId,yt=e.SelectedProject.ParentProgramID;vi("ddl_GI_ParentProg",tt,"Parent",vt,yt);pt=[];e.SelectedParentProject=tt[0];angular.copy(e.SelectedParentProject,l);e.SelectedProjectName=SeletedProjectName;e.OEProjectVisibleSolution=e.SelectedProject.IsOEProject;e.agileVisible=e.SelectedProject.IsAgile;e.isPOBOSVisible=e.SelectedProject.IsPOBOS;e.isSiteAssessmentVisible=e.SelectedProject.IsSiteAssessment;e.IsGMSGQLTAnnualMustWinVisible=e.SelectedProject.IsGMSGQLTAnnualMustWin;e.dsHubSettings=JSON.parse(r.getHubSettingResult);e.CapsProjectVisible=e.SelectedProject.IsCapsProject;s=[];e.SelectedProject.PortfolioOwnerID!=null&&e.SelectedProject.PortfolioOwnerID!=""&&(s=e.dsProjectType.filter(function(n){return n.LookUpMemberID==e.SelectedProject.ProblemType}));e.selectedProjectType=s.length>0?s[0]:"";h=[];e.SelectedProject.PortfolioOwnerID!=null&&e.SelectedProject.PortfolioOwnerID!=""&&(h=e.dsGIPortfolioOwner.filter(function(n){return n.LookUpMemberID==e.SelectedProject.PortfolioOwnerID}));e.selectedPortfolioOwner=h.length>0?h[0]:"";a=[];e.SelectedProject.PrimaryProductID!=null&&e.SelectedProject.PrimaryProductID!=""&&(a=e.dsGIPrimaryProduct.filter(function(n){return n.LookUpMemberID==e.SelectedProject.PrimaryProductID}));e.selectedPrimaryProduct=a.length>0?a[0]:"";v=[];e.SelectedProject.CampaignTypeID!=""&&e.SelectedProject.CampaignTypeID!=null&&(v=e.dsGICampaignType.filter(function(n){return n.LookUpMemberID==e.SelectedProject.CampaignTypeID}));e.selectedCampaignType=v.length>0?v[0]:"";y=[];e.SelectedProject.CampaignPhaseID!=""&&e.SelectedProject.CampaignPhaseID!=null&&(y=e.dsGICampaignPhase.filter(function(n){return n.LookUpMemberID==e.SelectedProject.CampaignPhaseID}));e.selectedCampaignPhase=y.length>0?y[0]:"";p=[];e.SelectedProject.ProductionStepID!=""&&e.SelectedProject.ProductionStepID!=null&&(p=e.dsGIProductionStep.filter(function(n){return n.LookUpMemberID==e.SelectedProject.ProductionStepID}));e.selectedProductionStep=p.length>0?p[0]:"";d=[];e.SelectedProject.AgilePrimaryWorkstream!=null&&e.SelectedProject.AgilePrimaryWorkstream!=""&&(d=e.dsAgilePrimaryWorkstation.filter(function(n){return n.LookUpMemberID==e.SelectedProject.AgilePrimaryWorkstream}));e.selectedAgilePrimaryWorkstream=d.length>0?d[0]:"";g=[];e.SelectedProject.AgileWave!=null&&e.SelectedProject.AgileWave!=""&&(g=e.dsAgileWave.filter(function(n){return n.LookUpMemberID==e.SelectedProject.AgileWave}));e.selectedAgileWave=g.length>0?g[0]:"";nt=[];e.SelectedProject.PrimaryKPI!=null&&e.SelectedProject.PrimaryKPI!=""&&(nt=e.dsGIPrimaryKPI.filter(function(n){return n.LookUpMemberID==e.SelectedProject.PrimaryKPI}));e.SelectedPrimaryKPI=nt.length>0?nt[0]:"";it=[];e.SelectedProject.StrategicYear!=null&&e.SelectedProject.StrategicYear!=""&&(it=e.dsStrategicYear.filter(function(n){return n.LookUpMemberName==e.SelectedProject.StrategicYear}));e.selectedStrategicYear=it.length>0?it[0]:"";rt=[];e.SelectedProject.AnnualMustWin!=null&&e.SelectedProject.AnnualMustWin!=""&&(rt=e.dsAnnulMustWin.filter(function(n){return n.LookUpMemberName==e.SelectedProject.AnnualMustWin}));e.selectedAnnualMustWin=rt.length>0?rt[0]:"";c=JSON.parse(t.getQualityReferenceByProjectIdResult);e.SelectedProject.qualityref=c.length>0?!0:!1;var st=[],ht=[],ct=[],ft=[],et=[],ot=[];e.SelectedProject.OtherImpactedProducts!=null&&e.SelectedProject.OtherImpactedProducts!="undefined"&&(st=e.SelectedProject.OtherImpactedProducts.split(","));e.SelectedProject.ExecutionScopeID!=null&&e.SelectedProject.ExecutionScopeID!="undefined"&&(ht=e.SelectedProject.ExecutionScopeID.split(","));e.SelectedProject.AgileSecondaryWorkstream!=null&&e.SelectedProject.AgileSecondaryWorkstream!="undefined"&&(ot=e.SelectedProject.AgileSecondaryWorkstream.split(","));e.SelectedProject.POBOSCategory!=null&&e.SelectedProject.POBOSCategory!="undefined"&&(ft=e.SelectedProject.POBOSCategory.split(","));e.SelectedProject.SiteAssessmentCategory!=null&&e.SelectedProject.SiteAssessmentCategory!="undefined"&&(et=e.SelectedProject.SiteAssessmentCategory.split(","));e.OEProjectVisibleSolution=e.SelectedProject.IsOEProject;e.agileVisible=e.SelectedProject.IsAgile;e.isPOBOSVisible=e.SelectedProject.IsPOBOS;e.isSiteAssessmentVisible=e.SelectedProject.IsSiteAssessment;e.IsGMSGQLTAnnualMustWinVisible=e.SelectedProject.IsGMSGQLTAnnualMustWin;e.OETypeOptions={placeholder:"Select OE Project Type...",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsGIOEProjectType,filter:"contains"};e.SelectedProject.IsOEProject&&(e.SelectedProject.OEProjectType!=null&&e.SelectedProject.OEProjectType!="undefined"&&(ct=e.SelectedProject.OEProjectType.split(",")),e.selectedOEProjectType=ct);ut=[];e.SelectedProject.EmissionPortfolioID!=null&&e.SelectedProject.EmissionPortfolioID!=""&&(ut=e.dsEmissionPortfolio.filter(function(n){return n.LookUpMemberID==e.SelectedProject.EmissionPortfolioID}));e.SelectedEmissionPortfolio=ut.length>0?ut[0]:"";b=e.SelectedProject;k=e.SelectedEmissionPortfolio;w=e.SelectedProject.EMDataAssociation;e.ImpactedProductOptions={placeholder:"Select products...",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsGIPrimaryProduct,filter:"contains"};e.ImpactedProductIds=st;e.ExecutionScopeOptions={placeholder:"Select and/or Type to Search",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsGIExecutionScope,filter:"contains"};e.ExecutionScopeIds=ht;e.SelectedProject.AgileSecondaryWorkstream!=null&&e.SelectedProject.AgileSecondaryWorkstream!="undefined"&&(ot=e.SelectedProject.AgileSecondaryWorkstream.split(","));e.dsAgileSecWorkstream={placeholder:"Select secondary workstream...",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsAgilePrimaryWorkstation,filter:"contains"};e.agileSecWorkstreamIds=ot;e.SelectedProject.POBOSCategory!=null&&e.SelectedProject.POBOSCategory!="undefined"&&(ft=e.SelectedProject.POBOSCategory.split(","));e.dsPOBOSCategories={placeholder:"Select and/or Type to Search",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsPOBOSCategory,filter:"contains"};e.POBOSCategoryIds=ft;e.SelectedProject.SiteAssessmentCategory!=null&&e.SelectedProject.SiteAssessmentCategory!="undefined"&&(et=e.SelectedProject.SiteAssessmentCategory.split(","));e.dsSiteAssessmentCategories={placeholder:"Select and/or Type to Search",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsSiteAssessmentCategory,filter:"contains"};e.SiteAssessmentCategoryIds=et;dr();$("#qualityGrid").data("kendoGrid").dataSource.read();$("#gridHubSettings").data("kendoTreeList").dataSource.read();i.$digest();hideLoading()}catch(lt){hideLoading();at={method:"getDataForBinding",exceptionMessage:"message:"+lt.message+" stack:"+lt.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",at)).then(function(){alert(errormessage)})}})}function dr(){bindChangeComboBox("ddl_GI_PrimaryProduct");bindChangeComboBox("ddl_Tops_ImpactMultiplier");bindChangeComboBox("InlineProduct");bindChangeComboBox("functions");bindChangeComboBox("ddl_GI_CampaignType");bindChangeComboBox("ddl_GI_CampaignPhase");bindChangeComboBox("ddl_GI_ProductionStep");bindChangeComboBox("ddl_Tops_RecommendedPriorityGroup");bindChangeComboBox("ddl_GI_PortfolioOwnerDetails");bindChangeComboBox("ddl_Primary_KPI");bindChangeComboBox("primaryWorkstation");bindChangeComboBox("agileSecondaryWorkstream");bindChangeComboBox("agileWave");bindChangeComboBox("ddlSiteAssessment");bindChangeComboBox("ddlPROBSCat");bindChangeComboBox("ddl_PrimaryKPI");bindChangeComboBox("strategicYear");bindChangeComboBox("annualMustWin")}function gr(){return[{field:"QualityReferenceTypeID",title:"Quality Reference Type",values:ct,width:"45%"},{field:"QualityReference",title:"Quality Reference #",width:"45%"},{field:"QualityUniqueID",title:"id",hidden:!0},{hidden:!e.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"10%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.QualityUniqueID!=undefined&&t.QualityUniqueID!=""&&e.deletedQualityData.push({QualityUniqueID:t.QualityUniqueID}),u=$("#qualityGrid").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}]}function fi(){var t=gr(),i=new kendo.data.DataSource({transport:{read:function(n){n.success(c)}},batch:!0,pageSize:20,schema:{model:{id:"QualityUniqueID",fields:{QualityUniqueID:{editable:!1},QualityReferenceTypeID:{type:"string",editable:e.isEditable},QualityReference:{type:"string",editable:e.isEditable}}}}}),n;$("#qualityGrid").kendoGrid({dataSource:i,columns:t,navigatable:!0,editable:{createAt:"bottom"}});e.isEditable&&(n=$("#qualityGrid").data("kendoGrid"),n.addRow())}function ei(){var n=new kendo.data.DataSource({data:e.dsProjectScopeData,group:{field:"ProjectScope",compare:function(n,t){return n.items[0].GroupOrder===t.items[0].GroupOrder?0:n.items[0].GroupOrder>t.items[0].GroupOrder?1:-1}},batch:!0,schema:{model:{fields:{ProjectScope:{type:"string",hidden:!0},Category:{type:"string",editable:!1},BaseCase:{type:"number",editable:!1},HighCase:{type:"number",editable:!1},GroupOrder:{type:"number",editable:!1}}}}});$("#GridTopsProjectScope").kendoGrid({dataSource:n,columns:[{field:"ProjectScope",title:"ProjectScope",hidden:!0},{field:"Category",title:"Category"},{field:"BaseCase",title:"Base Case",template:"#= (InCurrency ==1 ) ?  kendo.toString(BaseCase, 'n0')+' '+LocalCurrencyAbb :  kendo.toString(BaseCase, 'n1')#",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"txt-float-R"}},{field:"HighCase",title:"High Case",template:"#= (InCurrency ==1 ) ? kendo.toString(HighCase, 'n0')+' '+LocalCurrencyAbb :  kendo.toString(HighCase, 'n1')#",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"txt-float-R"}}]})}function oi(){e.isEMPortfolio=!1;e.RealizationDateCaps=!1;st=[];$.when(f.postDataWCFAsync("getProjectCapsDetails",SeletedProjectId),f.postDataWCFAsync("getCapsDataByProjectId",SeletedProjectId),f.postDataWCFAsync("getCAPSWaterWasteByProjectID",SeletedProjectId),f.postDataWCFAsync("getCAPSWaterWaste")).then(function(n,t,r,u){var c,y,s,v;try{kt=JSON.parse(n.getProjectCapsDetailsResult);c=JSON.parse(t.getCapsDataByProjectIdResult);e.capsDataInfo=c[0];pt=JSON.parse(r.getCAPSWaterWasteByProjectIDResult);a=JSON.parse(u.getCAPSWaterWasteResult);ot=Array.from(new Set(a.map(n=>n.WWStream)));wt=Array.from(new Set(a.map(n=>n.WWType)));bt=Array.from(new Set(a.map(n=>n.Category)));e.isUnitCostWW=e.capsDataInfo.isUnitCostWW;y=e.capsDataInfo.isUnitCost;e.isUnitCost=e.capsDataInfo.isUnitCost;s=[];e.capsDataInfo.EmissionPortfolioID!=null&&e.capsDataInfo.EmissionPortfolioID!=""?(s=e.dsEmissionPortfolio.filter(function(n){return n.LookUpMemberID==e.capsDataInfo.EmissionPortfolioID}),e.isEMPortfolio=!0):e.isEMPortfolio=!1;e.SelectedCapsEmissionPortfolio=s.length>0?s[0]:"";h=kt.filter(function(n){return n.EMPortfolioOwnerID==e.capsDataInfo.EmissionPortfolioID});angular.copy(h,gt);ni=e.isUnitCost;ti=e.capsDataInfo.EnergyCostImpactPerYear;e.formattedCalculated=kendo.toString(e.capsDataInfo.CalculatedEmissionsImpact,"n1");nu();vt==!0?(vt=!1,tu()):$("#gridCapsWaterWaste").data("kendoGrid").dataSource.read();i.$digest()}catch(l){v={method:"getDataForCaps",exceptionMessage:"message:"+l.message+" stack:"+l.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",v)).then(function(){alert(errormessage)})}})}function si(){var n,r,u,h;trackEvent("Project details and forms - Tops tab");n=new Date;console.log("tops started"+n.toString());try{r=topsKPI+","+topsFunctionRequired+","+topsImpactMultiplier+","+topsInLineProductStrategy+","+TOPSRecommendedPriorityGroup+","+topsPrimaryKpi;u={kpi:"TOPS KPI",ProjectID:SeletedProjectId};$.when(f.postDataWCFAsync("getLookupData",r),f.postDataWCFAsync("getKPIData",u),f.postDataWCFAsync("getProjectTOPS",SeletedProjectId)).then(function(r,u,s){var h,l,c,k,p,a,d,v,w,b,y,nt;try{for(h=JSON.parse(r.getLookupDataResult),e.dsTopsRecommendedPriorityGroup=h.filter(function(n){return n.LookUpName==TOPSRecommendedPriorityGroup}),e.dsTopsFunctions=h.filter(function(n){return n.LookUpName==topsFunctionRequired}),e.dsTopsImpactMultiplier=h.filter(function(n){return n.LookUpName==topsImpactMultiplier}),e.dsTopsInLineProductStrategy=h.filter(function(n){return n.LookUpName==topsInLineProductStrategy}),e.dsPrimaryKPI=t("orderBy")(h.filter(function(n){return n.LookUpName==topsPrimaryKpi}),"LookUpMemberOrder"),ht=[],l=h.filter(function(n){return n.LookUpName==topsKPI}),c=0;c<l.length;c++)k={text:l[c].LookUpMemberName,value:l[c].LookUpMemberID},ht.push(k);yt=JSON.parse(u.getKPIDataResult);p=JSON.parse(s.getProjectTOPSResult);p.length>0&&(e.tops=p[0],a=[],e.tops.FunctionsRequiredID!=null&&(a=e.dsTopsFunctions.filter(function(n){return n.LookUpMemberID==e.tops.FunctionsRequiredID})),e.tops.FunctionsRequiredID=a.length>0?a[0]:"",e.tops.ProjectScope!=null&&(d=e.dsProjectScope.filter(function(n){return n.LookUpMemberID==e.tops.ProjectScope})),e.tops.ProjectScope=e.tops.ProjectScope!=null&&e.tops.ProjectScope!=""?d[0]:null,v=[],e.tops.TOPSRecommendedPriorityGroupID!=null&&e.tops.TOPSRecommendedPriorityGroupID!=""&&(v=e.dsTopsRecommendedPriorityGroup.filter(function(n){return n.LookUpMemberID==e.tops.TOPSRecommendedPriorityGroupID})),e.tops.TOPSRecommendedPriorityGroupID=v.length>0?v[0]:"",w=[],e.tops.InLineProductStrategyID!=null&&(w=e.dsTopsInLineProductStrategy.filter(function(n){return n.LookUpMemberID==e.tops.InLineProductStrategyID})),e.tops.InLineProductStrategyID=e.tops.InLineProductStrategyID!=null&&e.tops.InLineProductStrategyID!=""?w[0]:"",b=[],e.tops.PrimaryKPI!=null&&(b=e.dsPrimaryKPI.filter(function(n){return n.LookUpMemberID==e.tops.PrimaryKPI})),e.tops.PrimaryKPI=e.tops.PrimaryKPI!=null&&e.tops.PrimaryKPI!=""?b[0]:"",y=[],e.tops.ImpactMultiplierID!=null&&(y=e.dsTopsImpactMultiplier.filter(function(n){return n.LookUpMemberID==e.tops.ImpactMultiplierID})),e.tops.ImpactMultiplierID=y.length>0?y[0]:"");fu();i.$digest()}catch(g){nt={method:"getDataForTops",exceptionMessage:"message:"+g.message+" stack:"+g.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",nt)).then(function(){alert(errormessage)})}n=new Date;console.log("tops loaded"+n.toString())})}catch(s){h={method:"getDataForTops",exceptionMessage:"message:"+s.message+" stack:"+s.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",h)).then(function(){alert(errormessage)})}}function hi(n,t){$('<input name="'+t.field+'" data-bind="value:'+t.field+'"/>').appendTo(n).kendoNumericTextBox({decimals:0,format:"{0:n0}",restrictDecimals:!0,max:9999999,min:-9999999})}function ci(n,t){$('<input name="'+t.field+'" data-bind="value:'+t.field+'"/>').appendTo(n).kendoNumericTextBox({decimals:4,format:"{0:n4}",restrictDecimals:!0,max:9999999999,min:0})}function nu(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(h)}},schema:{model:{id:"EmissionSourceID",fields:{EMSourceID:{hidden:!0},EMSourceName:{type:"string",editable:!1},EMUnit:{type:"number",validation:{maxlength:10},editable:e.isEditable},UnitOfMeasure:{type:"string",editable:!1},UnitCost:{type:"number",editable:e.isEditable},EMBasisOfEstimate:{type:"string",editable:e.isEditable},EMFactorImpact:{hidden:!0}}}}});$("#gridCaps").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:e.isEditable,edit:function(n){e.capsDataInfo.NoCarbonImpact==!0&&$("#gridCaps").data("kendoGrid").closeCell();var t=this,r=t.columns[n.container.index()].field;n.container.find('[name="UnitCost"]').length>0&&n.container.find('[name="UnitCost"]').data("kendoNumericTextBox").bind("change",function(){if(p=!0,r=="UnitCost"){var n=$("#gridCaps").data("kendoGrid"),u=n.dataSource.data(),t=$("#gridCaps").data("kendoGrid").dataSource.data();angular.forEach(t,function(n){if(n.UnitCost!=null){p=!1;return}});p?(e.isUnitCost=null,e.capsDataInfo.EnergyCostImpactPerYear=0):e.isUnitCost=!0}i.$digest()})},columns:[{field:"EMSourceName",title:"Emission Source",headerAttributes:{"class":"wrap-header"},width:"8%"},{field:"EMUnit",title:"Units",editor:hi,width:"5%",format:"{0:n0}",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"},headerTemplate:'<div>Units<span title="Input gross change in emissions type here in the unit provided using whole numbers. Positive values for increase, negative values for decrease" class="k-icon k-i-question"><\/span><\/div>'},{field:"UnitOfMeasure",title:"UoM",width:"2%"},{field:"UnitCost",title:"Unit Cost",width:"4%",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"},headerTemplate:"<div>Unit Cost <span>("+e.capsDataInfo.LocalCurrencyAbbreviation+')<\/span><span title="Input the cost of each energy unit using up to 4 decimal places, positive values only." class="k-icon k-i-question"><\/span><\/div>',editor:ci,format:"{0:n4}",editable:function(){return e.isUnitCost==null?!0:e.isUnitCost}},{field:"EMBasisOfEstimate",title:"Basis of Estimate",width:"13%"}]})}function tu(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(pt)}},sort:[{field:"WWStream",dir:"asc"},{field:"WWType",dir:"asc"},{field:"Category",dir:"asc"}],schema:{model:{id:"EMDataWWID",fields:{EMDataWWID:{hidden:!0},WWStream:{type:"string",editable:e.isEditable},EMWWUnit:{type:"number",validation:{maxlength:10},editable:e.isEditable},StandardUoM:{type:"string",editable:!1},UnitCost:{type:"number",editable:e.isEditable,defaultValue:null},WWType:{type:"string",editable:e.isEditable},Category:{type:"string",editable:e.isEditable},EMBasisOfEstimate:{type:"string",editable:e.isEditable}}}}});$("#gridCapsWaterWaste").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:{createAt:"bottom"},edit:function(n){var t=this,r=t.columns[n.container.index()].field;n.container.find('[name="UnitCost"]').length>0&&n.container.find('[name="UnitCost"]').data("kendoNumericTextBox").bind("change",function(){if(p=!0,r=="UnitCost"){var n=$("#gridCapsWaterWaste").data("kendoGrid").dataSource.data();angular.forEach(n,function(n){if(n.UnitCost!=null){p=!1;return}});p?(e.isUnitCostWW=null,e.capsDataInfo.EnergyWaterImpactCostPerYear=0,e.capsDataInfo.EnergyWasteImpactCostPerYear=0):e.isUnitCostWW=!0}i.$digest()})},columns:[{field:"WWStream",title:"Water/Waste",headerAttributes:{"class":"wrap-header"},width:"15%",editor:iu,values:ot},{field:"WWType",title:"Type",headerAttributes:{"class":"wrap-header"},width:"15%",editor:ru,values:wt},{field:"Category",title:"Category",headerAttributes:{"class":"wrap-header"},width:"15%",editor:uu,values:bt},{field:"EMWWUnit",title:"Units",editor:hi,width:"10%",format:"{0:n0}",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"},headerTemplate:'<div>Units<span title="Input gross change in emissions type here in the unit provided using whole numbers. Positive values for increase, negative values for decrease" class="k-icon k-i-question"><\/span><\/div>'},{field:"StandardUoM",title:"UoM",width:"10%"},{field:"UnitCost",title:"Unit Cost",width:"10%",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"},headerTemplate:"<div>Unit Cost <span>("+e.capsDataInfo.LocalCurrencyAbbreviation+')<\/span><span title="Input the cost of each energy unit using up to 4 decimal places, positive values only." class="k-icon k-i-question"><\/span><\/div>',editor:ci,format:"{0:n4}",editable:function(){return e.isUnitCostWW==null?!0:e.isUnitCostWW}},{field:"EMBasisOfEstimate",title:"Basis of Estimate",width:"20%"},{hidden:!e.isEditable,width:"5%",command:[{name:" ",iconClass:"k-icon k-i-close",click:function(n){var r,t,u,s;try{confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t.EMDataWWID!="undefined"&&t.EMDataWWID!=""&&st.push({EMDataWWID:t.EMDataWWID}),u=$("#gridCapsWaterWaste").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}catch(e){hideLoading();s={method:"InitKendoGridCapsWaterWaste",exceptionMessage:"message:"+e.message+" stack:"+e.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",s)).then(function(){alert(errormessage)})}}}]}]})}function iu(n,t){$('<input id="'+t.field+t.model.EMDataWWID+'" name="'+t.field+'"/>').appendTo(n).kendoComboBox({autoBind:!1,filter:"contains",valuePrimitive:!0,dataSource:ot,change:function(n){var i=n.sender.element.closest(".k-grid").data("kendoGrid"),r=n.sender.element.closest("tr"),t=i.dataItem(r),u=a.filter(function(n){return n.WWStream==t.WWStream});t.Category="";t.WWType="";t.StandardUoM=u[0].StandardUoM;t.dirty=!0;$("#gridCapsWaterWaste").data("kendoGrid").refresh()}})}function ru(n,t){var i=t.model.WWStream,r=a.filter(function(n){return n.WWStream==i}),u=Array.from(new Set(r.map(n=>n.WWType)));$('<input  id="'+t.field+t.model.EMDataWWID+'"name="'+t.field+'"/>').appendTo(n).kendoComboBox({autoBind:!1,filter:"contains",valuePrimitive:!0,dataSource:u,change:function(n){var i=n.sender.element.closest(".k-grid").data("kendoGrid"),r=n.sender.element.closest("tr"),t=i.dataItem(r);t.Category="";t.dirty=!0;$("#gridCapsWaterWaste").data("kendoGrid").refresh()}})}function uu(n,t){var i=t.model.WWStream,r=t.model.WWType,u=a.filter(function(n){return n.WWStream==i&&n.WWType==r});$('<input  id="'+t.field+t.model.EMDataWWID+'" name="'+t.field+'"/>').appendTo(n).kendoComboBox({autoBind:!1,dataTextField:"Category",dataValueField:"WWSourceMasterUniqueID",template:"#:Category#",filter:"contains",valuePrimitive:!0,dataSource:u,change:function(n){var i=n.sender.element.closest(".k-grid").data("kendoGrid"),r=n.sender.element.closest("tr"),t=i.dataItem(r);t.WWSourceMasterUniqueID=n.sender.value();t.Category=n.sender.text()}})}function fu(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(yt)}},group:{field:"ParentKPI"},sort:{field:"KPIOrder",dir:"asc"},schema:{model:{id:"KPIID",fields:{KPIName:{type:"string",editable:!1},KPIID:{hidden:!0},ParentKPI:{hidden:!0},LookUpName:{type:"string",defaultValue:"No Impact",editable:e.isEditable},KPIOrder:{type:"number",editable:!1}}}}});$("#gridTops").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:e.isEditable,columns:[{field:"KPIName",title:"KPIs",headerAttributes:{"class":"wrap-header"},groupHeaderTemplate:"#= value #"},{field:"ParentKPI",title:"ParentKPI",hidden:!0,groupHeaderTemplate:"#= value #"},{field:"LookUpValue",title:"KPI Impact",values:ht}],dataBound:function(){var u,n,t,r;if(e.NoImpactSelected=!0,u=$("#gridTops").data("kendoGrid"),n=this._data.map(function(n){return n}),n.length>0)for(t=0;t<n.length;t++)if(r=n[t].LookUpValue,r!=topsKPIDefaultValue){e.NoImpactSelected=!1;i.$digest();break}},edit:function(n){n.container.find('[name="LookUpValue"]').data("kendoDropDownList")!=undefined&&n.container.find('[name="LookUpValue"]').data("kendoDropDownList").bind("change",function(){var n=$("#gridTops").data("kendoGrid"),t=n.dataItem(this.wrapper.parents("tr")),r,u;t.LookUpValue!=topsKPIDefaultValue&&e.NoImpactSelected===!0?(e.NoImpactSelected=!1,i.$digest()):t.LookUpValue===topsKPIDefaultValue&&e.NoImpactSelected===!1&&(r=n.dataItems(),u=r.filter(function(n){return n.LookUpValue!=topsKPIDefaultValue}),u.length==0&&(e.NoImpactSelected=!0,i.$digest()))})}})}function eu(n){n.sender.value()==""&&w==1&&(confirm(capsTypeClearMessage)?b=null:(n.preventDefault(),e.SelectedEmissionPortfolio=k,i.$digest()))}function li(n){w==1&&n.dataItem.LookUpMemberID!=k.LookUpMemberID?confirm(capsTypeClearMessage)?b={LookUpMemberID:n.dataItem.LookUpMemberID,LookUpMemberName:n.dataItem.LookUpMemberName,LookUpMemberOrder:n.dataItem.LookUpMemberOrder,LookUpName:n.dataItem.LookUpName}:(n.preventDefault(),e.SelectedEmissionPortfolio=k,i.$digest()):b={LookUpMemberID:n.dataItem.LookUpMemberID,LookUpMemberName:n.dataItem.LookUpMemberName,LookUpMemberOrder:n.dataItem.LookUpMemberOrder,LookUpName:n.dataItem.LookUpName}}function ou(){if(e.capsDataInfo.NoCarbonImpact==!0)for(var n=0;n<h.length;n++)h[n].EMUnit=null,h[n].EMBasisOfEstimate=null,h[n].UnitCost=null,e.capsDataInfo.EnergyCostImpactPerYear=null;else angular.copy(gt,h),e.isUnitCost=ni,e.capsDataInfo.EnergyCostImpactPerYear=ti;$("#gridCaps").data("kendoGrid").dataSource.read()}function su(){var s=[],n=!0,t,k,h,c,i,l,a,r,u,y,b;try{if(console.log("save"),t=e.capsDataInfo.EmissionsImpactRealizationDate!=null&&e.capsDataInfo.EmissionsImpactRealizationDate!=""?$("#realizationDate").val():null,t!=null&&(parseDate(t)?e.RealizationDateCaps=!1:(n=!1,e.RealizationDateCaps=!0)),k=[],h=$("#gridCapsWaterWaste").data("kendoGrid").dataSource.data().map(function(n){return n}),angular.forEach(h,function(t){if((t.WWStream==null||t.WWType==null||t.Category==null||t.WWStream==""||t.WWType==""||t.Category=="")&&n==!0){n=!1;alert(waterWasteErrorMsg);return}}),!n){hideLoading();return}if(c={IsCapsProject:e.capsDataInfo.IsCapsProject,CalculatedEmissionsImpact:e.capsDataInfo.CalculatedEmissionsImpact!=null&&e.capsDataInfo.CalculatedEmissionsImpact!==""?e.capsDataInfo.CalculatedEmissionsImpact:null,EmissionPortfolioID:e.SelectedCapsEmissionPortfolio!=null&&e.SelectedCapsEmissionPortfolio!==""?e.SelectedCapsEmissionPortfolio.LookUpMemberID:null,EmissionsImpactRealizationDate:e.capsDataInfo.EmissionsImpactRealizationDate!=null&&e.capsDataInfo.EmissionsImpactRealizationDate!==""?e.capsDataInfo.EmissionsImpactRealizationDate:null,NoCarbonImpact:e.capsDataInfo.NoCarbonImpact!=null&&e.capsDataInfo.NoCarbonImpact!==""?e.capsDataInfo.NoCarbonImpact:null,EnergyCostImpactPerYear:e.capsDataInfo.EnergyCostImpactPerYear!=null&&e.capsDataInfo.EnergyCostImpactPerYear!==""?e.capsDataInfo.EnergyCostImpactPerYear:null,EnergyImpact:e.capsDataInfo.EnergyImpact,EnergyWasteImpactCostPerYear:e.capsDataInfo.EnergyWasteImpactCostPerYear!=null&&e.capsDataInfo.EnergyWasteImpactCostPerYear!==""?e.capsDataInfo.EnergyWasteImpactCostPerYear:null,EnergyWasteImpactPerYear:e.capsDataInfo.EnergyWasteImpactPerYear,EnergyWaterImpactCostPerYear:e.capsDataInfo.EnergyWaterImpactCostPerYear!=null&&e.capsDataInfo.EnergyWaterImpactCostPerYear!==""?e.capsDataInfo.EnergyWaterImpactCostPerYear:null,EnergyWaterImpactPerYear:e.capsDataInfo.EnergyWaterImpactPerYear},s.push(c),i=[],a=$("#gridCaps").data("kendoGrid").dataSource.data().map(function(n){return n}),angular.forEach(a,function(n){l={EMSourceID:n.EMSourceID,EMSourceName:n.EMSourceName,EMUnit:n.EMUnit,UnitOfMeasure:n.UnitOfMeasure,UnitCost:n.UnitCost,EMBasisOfEstimate:n.EMBasisOfEstimate,EMFactorImpact:n.EMFactorImpact};i.push(l)}),r=[],u=[],$("#gridCapsWaterWaste").data("kendoGrid")!=undefined){var v=$("#gridCapsWaterWaste").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),d=v.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),g=v.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(d,function(n){var t={};t.EMDataWWID=n.EMDataWWID;t.WWSourceMasterUniqueID=n.WWSourceMasterUniqueID;t.WWStream=n.WWStream;t.WWType=n.WWType;t.Category=n.Category;t.EMWWUnit=n.EMWWUnit;t.StandardUoM=n.StandardUoM;t.UnitCost=n.UnitCost;t.EMBasisOfEstimate=n.EMBasisOfEstimate;r.push(t)});angular.forEach(g,function(n){var t={};t.EMDataWWID=n.EMDataWWID;t.WWSourceMasterUniqueID=n.WWSourceMasterUniqueID;t.WWStream=n.WWStream;t.WWType=n.WWType;t.Category=n.Category;t.EMWWUnit=n.EMWWUnit;t.StandardUoM=n.StandardUoM;t.UnitCost=n.UnitCost;t.EMBasisOfEstimate=n.EMBasisOfEstimate;u.push(t)})}e.insertUpdateDeleteWaterWaste={insert:r,update:u,"delete":st};y={ProjectID:SeletedProjectId,Capsdata:JSON.stringify(s),Capsgrid:JSON.stringify(i),CapsWaterWaste:JSON.stringify(e.insertUpdateDeleteWaterWaste)};f.postDataWCF("insertUpdateCAPS",y).then(function(){oi();alert(saveMessage);$.when(f.getDataWCFAsync("getProjectInfoByID/"+SeletedProjectId)).then(function(n){var t=JSON.parse(n.getProjectInfoByIDResult);e.SelectedProject=t[0];w=e.SelectedProject.EMDataAssociation})})}catch(p){b={method:"CreateUpdateTops",exceptionMessage:"message:"+p.message+" stack:"+p.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",b)).then(function(){alert(errormessage)})}}function hu(){var t,r,i,u,s,c;try{t=[];r={ProjectID:SeletedProjectId,DurationBaseCase:e.tops.DurationBaseCase!=null&&e.tops.DurationBaseCase!==""?e.tops.DurationBaseCase:null,DurationHighCase:e.tops.DurationHighCase!=null&&e.tops.DurationHighCase!==""?e.tops.DurationHighCase:null,PeopleFTEMonthsRequiredBaseCase:e.tops.PeopleFTEMonthsRequiredBaseCase!=null&&e.tops.PeopleFTEMonthsRequiredBaseCase!==""?e.tops.PeopleFTEMonthsRequiredBaseCase:null,PeopleFTEMonthsRequiredHighCase:e.tops.PeopleFTEMonthsRequiredHighCase!=null&&e.tops.PeopleFTEMonthsRequiredHighCase!==""?e.tops.PeopleFTEMonthsRequiredHighCase:null,TotalNonFTEOpExBaseCase:e.tops.TotalNonFTEOpExBaseCase!=null&&e.tops.TotalNonFTEOpExBaseCase!==""?e.tops.TotalNonFTEOpExBaseCase:null,TotalNonFTEOpExHighCase:e.tops.TotalNonFTEOpExHighCase!=null&&e.tops.TotalNonFTEOpExHighCase!==""?e.tops.TotalNonFTEOpExHighCase:null,TotalCapExBaseCase:e.tops.TotalCapExBaseCase!=null&&e.tops.TotalCapExBaseCase!==""?e.tops.TotalCapExBaseCase:null,TotalCapExHighCase:e.tops.TotalCapExHighCase!=null&&e.tops.TotalCapExHighCase!==""?e.tops.TotalCapExHighCase:null,TOPSRecommendedPriorityGroupID:e.tops.TOPSRecommendedPriorityGroupID!=null?e.tops.TOPSRecommendedPriorityGroupID.LookUpMemberID:null,FunctionsRequiredID:e.tops.FunctionsRequiredID!=null?e.tops.FunctionsRequiredID.LookUpMemberID:null,ImpactMultiplierID:e.tops.ImpactMultiplierID!=null?e.tops.ImpactMultiplierID.LookUpMemberID:null,InLineProductStrategyID:e.tops.InLineProductStrategyID!=null?e.tops.InLineProductStrategyID.LookUpMemberID:null,DurationDescription:e.tops.DurationDescription,PeopleDescription:e.tops.PeopleDescription,TotalCapExDescription:e.tops.TotalCapExDescription,TotalNonFTEDescription:e.tops.TotalNonFTEDescription,InLineProductDescription:e.tops.InLineProductDescription,ImpactMultiplierDescription:e.tops.ImpactMultiplierDescription,TOPSGroup:e.tops.TOPSGroup,CostBenefitRatio:e.tops.CostBenefitRatio,OverallBenefitScore:e.tops.CostBenefitRatio,PrimaryKPI:e.tops.PrimaryKPI!=null?e.tops.PrimaryKPI.LookUpMemberID:null,ProjectScope:e.tops.ProjectScope!=null?e.tops.ProjectScope.LookUpMemberID:null};t.push(r);i=[];u=$("#gridTops").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n});angular.forEach(u,function(n){var t={KPIUniqueID:n.KPIUniqueID,ProjectID:SeletedProjectId,KPIID:n.KPIID,KPIValueID:n.LookUpValue};i.push(t)});s={TOPS:JSON.stringify(t),TOPSKPI:JSON.stringify(i)};f.postDataWCF("insertUpdateTOPS",s).then(function(t){t=="Success"?(ft=!0,si(),g=!0,yi(),n.$emit("RefreshForDataQuality"),alert(saveMessage)):alert("Error occurred in Tops Update")})}catch(h){c={method:"CreateUpdateTops",exceptionMessage:"message:"+h.message+" stack:"+h.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",c)).then(function(){alert(errormessage)})}}function cu(n){var t=[],r={ProjectID:SeletedProjectId,UserADID:currentUserId,ReportName:n},i;t.push(r);i=JSON.stringify({ReportsData:t});f.postDataWCF("InsertReports",i).then(function(n){n.InsertReportsResult=="Success"?(alert(reportprocessmessage),e.UpdateDate(SeletedProjectName)):alert("Error occurred")})}function ai(){var n=new kendo.data.TreeListDataSource({transport:{read:function(n){n.success(e.dsHubSettings)}},schema:{model:{id:"LookUpID",fields:{parentId:{field:"Parent",nullable:!0},LookUpName:{type:"string",editable:!1},HubSettingID:{hidden:!0},ProjectID:{type:"string"},LookUpID:{type:"string",hidden:!0},Parent:{type:"string"},HubValue:{type:"boolean"}}}}});$("#gridHubSettings").kendoTreeList({dataSource:n,batch:!0,expanded:!0,columns:[{field:"LookUpName",title:"Hub Section"},{field:"LookUpID",title:"LookUpID",hidden:!0},{field:"HubValue",title:" ",template:'#if(LookUpName != "Project Board Section") { # <input type="checkbox" #= data.HubValue ? checked="checked" : "" #  class="chkbx"/># } #'}],dataBound:function(){$(".chkbx").bind("click",function(n){var t=$("#gridHubSettings").data("kendoTreeList"),i=t.dataItem($(n.target).closest("tr")),r=$(":checked",t.element).length;i.set("HubValue",this.checked)})}})}function lu(){var n,t,r;try{n=[];$("#gridHubSettings").data("kendoTreeList")!=undefined&&(t=$("#gridHubSettings").data("kendoTreeList").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),angular.forEach(t,function(t){var i={};i.ProjectID=t.ProjectID;i.LookUpID=t.LookUpID;i.HubSettingID=t.HubSettingID;i.HubValue=t.HubValue;n.push(i)}),n.length>0&&f.postDataWCF("InsertUpdateHubSetting",JSON.stringify(n)).then(function(n){n.InsertUpdateHubSettingResult=="Success"?(console.log("Hub setting updated successfully"),y=!0,alert(saveMessage)):alert("Error occurred in Hub Update")}))}catch(i){r={method:"updateHubSettings",exceptionMessage:"message:"+i.message+" stack:"+i.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",r)).then(function(){alert(errormessage)})}}function vi(n,t,r,u,s){var h=$("#"+n).data("kendoComboBox"),a;if(h==undefined){$("#"+n).kendoComboBox({dataTextField:"ProjectName",dataValueField:"ProblemUniqueID",dataSource:t,minLength:3,value:s,select:function(n){var t,r;e.SelectedParentProject={ProblemUniqueID:n.dataItem.ProblemUniqueID,ProjectName:n.dataItem.ProjectName};angular.equals(l,e.SelectedParentProject)==!1&&l.ProblemUniqueID!=undefined&&l.ProblemUniqueID!==null&&(confirm(parentProgChangMsg)?y=!0:(t=[],t.push(e.SelectedParentProject),angular.copy(l,e.SelectedParentProject),r=$("#ddl_GI_ParentProg").data("kendoComboBox"),r.setDataSource(t),$("#ddl_GI_ParentProg").data("kendoComboBox").value(l.ProblemUniqueID),i.$digest()))},placeholder:projectPickerPlaceholder});try{$("#"+n).data().kendoComboBox.input.on("keydown",function(i){var l,h,a,c,s;i.keyCode==13&&(s=$("#"+n).data("kendoComboBox"),l="",console.log(s.value()),h=s.input[0].value,a=e.SelectedProject.IsConfidential===!0?"1":"0",console.log(h),h.length>=3?(displayLoading(),c={programUID:u,searchFor:r+"-"+e.SelectedProject.IsConfidential,filterString:h},$.when(f.postDataWCFAsync("getAllProjectProgramListFilter",c)).then(function(n){try{t=JSON.parse(n);s.setDataSource(t);s.open();hideLoading()}catch(i){var r={method:"searchProjectParent",exceptionMessage:"message:"+i.message+" stack:"+i.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",r)).then(function(){alert(errormessage)});hideLoading()}})):(alert(minThreeLetterMsg),t=[],s=$("#"+n).data("kendoComboBox"),s.setDataSource(t),s.close(),hideLoading()));i.keyCode==8||i.keyCode==46?$("#ddl_GI_ParentProg").data("kendoComboBox").value(""):(t=[],s=$("#"+n).data("kendoComboBox"),s.setDataSource(t),s.close())})}catch(c){a={method:"searchProjectParent",exceptionMessage:"message:"+c.message+" stack:"+c.stack,ErrorParameter:o};$.when(postDataWCFAsync("WriteErrorLog",a)).then(function(){alert(errormessage)});hideLoading()}}else h.setDataSource(t),h.value(s),hideLoading();return""}function yi(){g==!0&&(displayLoading(),$.when(f.getDataWCFAsync("getProjectInfoByID/"+SeletedProjectId)).then(function(n){var t,ht,r,u,s,h,c,a,v,y,p,d,g,et;try{t=JSON.parse(n.getProjectInfoByIDResult);e.SelectedProject=t[0];w=e.SelectedProject.EMDataAssociation;var nt=[{ProblemUniqueID:t[0].ParentProgramID,ProjectName:t[0].ParentProgramName}],ot=SeletedProjectId,st=e.SelectedProject.ParentProgramID;vi("ddl_GI_ParentProg",nt,"Parent",ot,st);ht=[];e.SelectedParentProject=nt[0];angular.copy(e.SelectedParentProject,l);e.SelectedProjectName=SeletedProjectName;e.OEProjectVisibleSolution=e.SelectedProject.IsOEProject;e.agileVisible=e.SelectedProject.IsAgile;e.isPOBOSVisible=e.SelectedProject.IsPOBOS;e.isSiteAssessmentVisible=e.SelectedProject.IsSiteAssessment;e.IsGMSGQLTAnnualMustWinVisible=e.SelectedProject.IsGMSGQLTAnnualMustWin;r=[];e.SelectedProject.PortfolioOwnerID!=null&&e.SelectedProject.PortfolioOwnerID!=""&&(r=e.dsGIPortfolioOwner.filter(function(n){return n.LookUpMemberID==e.SelectedProject.PortfolioOwnerID}));e.selectedPortfolioOwner=r.length>0?r[0]:"";u=[];e.SelectedProject.PrimaryProductID!=null&&e.SelectedProject.PrimaryProductID!=""&&(u=e.dsGIPrimaryProduct.filter(function(n){return n.LookUpMemberID==e.SelectedProject.PrimaryProductID}));e.selectedPrimaryProduct=u.length>0?u[0]:"";s=[];e.SelectedProject.ProjectClassificationID!=null&&e.SelectedProject.ProjectClassificationID!=""&&(s=e.dsGIProjectClassification.filter(function(n){return n.LookUpMemberID==e.SelectedProject.ProjectClassificationID}));e.selectedProjectPOBOS=s.length>0?s[0]:"";h=[];e.SelectedProject.CampaignTypeID!=""&&e.SelectedProject.CampaignTypeID!=null&&(h=e.dsGICampaignType.filter(function(n){return n.LookUpMemberID==e.SelectedProject.CampaignTypeID}));e.selectedCampaignType=h.length>0?h[0]:"";c=[];e.SelectedProject.CampaignPhaseID!=""&&e.SelectedProject.CampaignPhaseID!=null&&(c=e.dsGICampaignPhase.filter(function(n){return n.LookUpMemberID==e.SelectedProject.CampaignPhaseID}));e.selectedCampaignPhase=c.length>0?c[0]:"";a=[];e.SelectedProject.ProductionStepID!=""&&e.SelectedProject.ProductionStepID!=null&&(a=e.dsGIProductionStep.filter(function(n){return n.LookUpMemberID==e.SelectedProject.ProductionStepID}));e.selectedProductionStep=a.length>0?a[0]:"";v=[];e.SelectedProject.AgilePrimaryWorkstream!=null&&e.SelectedProject.AgilePrimaryWorkstream!=""&&(v=e.dsAgilePrimaryWorkstation.filter(function(n){return n.LookUpMemberID==e.SelectedProject.AgilePrimaryWorkstream}));e.selectedAgilePrimaryWorkstream=v.length>0?v[0]:"";y=[];e.SelectedProject.AgileWave!=null&&e.SelectedProject.AgileWave!=""&&(y=e.dsAgileWave.filter(function(n){return n.LookUpMemberID==e.SelectedProject.AgileWave}));e.selectedAgileWave=y.length>0?y[0]:"";p=[];e.SelectedProject.PrimaryKPI!=null&&e.SelectedProject.PrimaryKPI!=""&&(p=e.dsGIPrimaryKPI.filter(function(n){return n.LookUpMemberID==e.SelectedProject.PrimaryKPI}));e.SelectedPrimaryKPI=p.length>0?p[0]:"";e.SelectedProject.POBOSCategory!=null&&e.SelectedProject.POBOSCategory!="undefined"&&(b=e.SelectedProject.POBOSCategory.split(","));e.SelectedProject.SiteAssessmentCategory!=null&&e.SelectedProject.SiteAssessmentCategory!="undefined"&&(k=e.SelectedProject.SiteAssessmentCategory.split(","));var tt=[],it=[],rt=[],ut=[],b=[],k=[];e.SelectedProject.OtherImpactedProducts!=null&&e.SelectedProject.OtherImpactedProducts!="undefined"&&(tt=e.SelectedProject.OtherImpactedProducts.split(","));e.SelectedProject.ExecutionScopeID!=null&&e.SelectedProject.ExecutionScopeID!="undefined"&&(it=e.SelectedProject.ExecutionScopeID.split(","));e.SelectedProject.AgileSecondaryWorkstream!=null&&e.SelectedProject.AgileSecondaryWorkstream!="undefined"&&(ut=e.SelectedProject.AgileSecondaryWorkstream.split(","));e.SelectedProject.POBOSCategory!=null&&e.SelectedProject.POBOSCategory!="undefined"&&(b=e.SelectedProject.POBOSCategory.split(","));e.SelectedProject.SiteAssessmentCategory!=null&&e.SelectedProject.SiteAssessmentCategory!="undefined"&&(k=e.SelectedProject.SiteAssessmentCategory.split(","));d=[];e.SelectedProject.StrategicYear!=null&&e.SelectedProject.StrategicYear!=""&&(d=e.dsStrategicYear.filter(function(n){return n.LookUpMemberName==e.SelectedProject.StrategicYear}));e.selectedStrategicYear=d.length>0?d[0]:"";g=[];e.SelectedProject.AnnualMustWin!=null&&e.SelectedProject.AnnualMustWin!=""&&(g=e.dsAnnulMustWin.filter(function(n){return n.LookUpMemberName==e.SelectedProject.AnnualMustWin}));e.selectedAnnualMustWin=g.length>0?g[0]:"";e.OEProjectVisibleSolution=e.SelectedProject.IsOEProject;e.agileVisible=e.SelectedProject.IsAgile;e.OETypeOptions={placeholder:"Select OE Project Type...",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsGIOEProjectType,filter:"contains"};e.SelectedProject.IsOEProject&&(e.SelectedProject.OEProjectType!=null&&e.SelectedProject.OEProjectType!="undefined"&&(rt=e.SelectedProject.OEProjectType.split(",")),e.selectedOEProjectType=rt);e.ImpactedProductOptions={placeholder:"Select products...",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsGIPrimaryProduct,filter:"contains"};e.ImpactedProductIds=tt;e.ExecutionScopeOptions={placeholder:"Select and/or Type to Search",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsGIExecutionScope,filter:"contains"};e.ExecutionScopeIds=it;e.dsAgileSecWorkstream={placeholder:"Select secondary workstream...",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsAgilePrimaryWorkstation,filter:"contains"};e.agileSecWorkstreamIds=ut;e.SelectedProject.POBOSCategory!=null&&e.SelectedProject.POBOSCategory!="undefined"&&(b=e.SelectedProject.POBOSCategory.split(","));e.dsPOBOSCategories={placeholder:"Select and/or Type to Searchs",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsPOBOSCategory,filter:"contains"};e.POBOSCategoryIds=b;e.SelectedProject.SiteAssessmentCategory!=null&&e.SelectedProject.SiteAssessmentCategory!="undefined"&&(k=e.SelectedProject.SiteAssessmentCategory.split(","));e.dsSiteAssessmentCategories={placeholder:"Select and/or Type to Search",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsSiteAssessmentCategory,filter:"contains"};e.SiteAssessmentCategoryIds=k;i.$digest();hideLoading()}catch(ft){hideLoading();et={method:"reloadGeneralInfo",exceptionMessage:"message:"+ft.message+" stack:"+ft.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",et)).then(function(){alert(errormessage)})}}),g=!1)}function au(n){$("#"+n).on("change",function(){vu($(this).attr("id"))})}function vu(n){var t=!1,r=$("#"+n).val();if(parseDate(r)&&(t=!0),t){switch(n){case"realizationDate":e.RealizationDateCaps=!1}i.$digest()}}function yu(){SeletedProjectId=getParameterByName(window.location.search,"ProblemID");(SeletedProjectName==null||SeletedProjectName==undefined)&&(e.SelectedProjectName=SeletedProjectName)}var e=this,lt,d,rt,o;e.OEProjectVisibleSolution=!1;e.agileVisible=!1;e.projectVisible=!0;e.programVisible=!1;e.isConfidentialVisible=!1;e.dateErrorMsg=InValidDateFormat;var ft=!1,et=!1,v=!1,at=!1,y=!1,g=!1,p=!0,vt=!0;e.isEditable=!1;e.NoAttribute=!1;e.NoImpactSelected=!0;e.isPortfolioOwnerEditable=!1;e.isCapsProjectChecked=!0;e.dateFormatlabel=dateLabel;e.projectDetailsAndFormsPagepath=projectDetailsAndFormsPagepath;e.noLocalAttribute=noLocalAttribute;e.onProjectScopeChange=ii;e.onChangeCarbonImpact=ou;e.capsProjectTooltip=capsProjectTooltip;e.environmentalTootltip=environmentalTootltip;var yt=[],h=[],pt=[],ot=[],a=[],wt=[],bt=[],st=[],ht=[],ct=[],c=[],nt=[],tt=[],kt=[],b={},k={},w;e.isUnitCost=null;e.isUnitCostWW=null;e.qualityType=[];e.dsOEProjectType=[];e.dsGIProjectType=[];e.dsGIPortfolioOwner=[];e.dsGIPrimaryProduct=[];e.dsGIProgram=[];e.dsGIProject=[];e.dsPrimaryKPI=[];var it=[],pi=[],s=[],dt=[],gt=[],ni=null,ti=null;e.dsGIOEProjectType=[];e.dsPermission=[];e.dsProjectScopeData=[];e.dsTopsFunctions=[];e.dsTopsImpactMultiplier=[];e.dsTopsInLineProductStrategy=[];e.dsTopsProducts=[];e.deletedQualityData=[];e.localCurrencyAbbrePlaceholder;e.localCurrencyAbbre;e.SelectedProjectName=SeletedProjectName;e.SelectedProjectID="";e.buildNo=buildNo;e.releaseDate=releaseDate;e.editDeliverablePagepath=editDeliverablePagepath;e.InitkendoGridQuality=fi;e.getDataForTops=si;e.getDataForCaps=oi;e.updateHubSettings=lu;e.businessCase=businessCase;e.projectCharter=projectCharter;e.fundingDeck=fundingDeck;e.projectDashboard=projectDashboard;e.projectDashboardPerformance=projectDashboardPerformance;e.ProjectCloseOutReport=projectCloseOutReport;e.GMSPTProgramDashboard=GMSPTProgramDashboard;e.onEMPortfolioChange=li;e.AddNewRow=wi;lt=0;d=!0;e.SelectedProject={};e.selectedPortfolioOwner={};e.selectedProjectType={};e.tops={};e.local={};e.dsHubSettings=[];rt=[];o="ProjectHubHeaderCtrl";e.openModel=wr;e.initProjectHubHeader=yu;e.saveGIProjectInfoByID=ar;e.InitkGridHubSettings=ai;e.InitkendoGridTopsProjectScope=ei;e.insertReports=cu;e.CreateUpdateTops=hu;e.CreateUpdateCaps=su;e.AddNewQualityRow=lr;e.Importdata=cr;e.UpdateDate=hr;e.importDialogClose=yr;e.bindImportClose=vr;e.getLocalAttributes=fr;e.saveLocalAttribute=sr;e.isConfidentialProjectFunc=br;e.changeQualityRef=gi;e.changeOEProjectType=nr;e.changeAgile=tr;e.changePOBOS=ir;e.changeSiteAssessment=ur;e.GetProjectScopeDialog=di;e.onChangeEnergyCostImpact=bi;e.onChangeWWCostImpact=ki;e.changeGMSGQLTAnnualMustWin=rr;e.reloadGeneralInfo=yi;var l={},ut=!1;n.$on("ProjectHubGetCall",function(n,t){e.SelectedProjectName=t;e.UpdateDate(t)});n.$on("UpdateHubLoad",function(n,t){y=t});n.$on("UpdateGeneralInfo",function(n,t){g=t})}angular.module("SPOTApp").controller("ProjectHubHeaderCtrl",ProjectHubHeaderCtrl);ProjectHubHeaderCtrl.$inject=["$rootScope","$filter","$scope","$http","$q","GETPostService"];