function BusinessCaseCtrl(n,t,i,r,u,f){function br(n){var t=!1;return $.each(n._data,function(){this.dirty==!0&&(t=!0)}),n._destroyed.length>0&&(t=!0),t}function kr(n,t){var r,i,o;try{r=$("#"+n).data("kendoGrid");i=$("#"+t);document.activeElement.blur();br(r.dataSource)?t=="dialogAddMilestoneBCOpt"?confirm(saveMilestoneConfirm)?bi(BusinessCaseOption1):i.data("kendoWindow").open():t=="dialogAddMilestoneBCOpt2"?confirm(saveMilestoneConfirm)?bi(BusinessCaseOption2):i.data("kendoWindow").open():t=="dialogAddMilestoneBCOpt3"?confirm(saveMilestoneConfirm)?bi(BusinessCaseOption3):i.data("kendoWindow").open():confirm(dialogCancelMessage)?(r.dataSource.cancelChanges(),r.dataSource.read(),i.data("kendoWindow").open()):e.preventDefault():i.data("kendoWindow").open()}catch(u){o={method:"CheckBulkEditGridUpdateBC",exceptionMessage:"message:"+u.message+" stack:"+u.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",o)).then(function(){})}}function dr(n){var s,h,a,p,d,w,nt;try{var i="gridBusinessCaseOptTimeline",u="gridBCOptAddMilestones",e="dialogAddMilestoneBCOpt",t=c;n=="Option1"?(i="gridBusinessCaseOptTimeline",u="gridBCOptAddMilestones",e="dialogAddMilestoneBCOpt",t=c):n=="Option2"?(i="gridBusinessCaseOpt2Timeline",u="gridBCOptAddMilestones2",e="dialogAddMilestoneBCOpt2",t=v):n=="Option3"&&(i="gridBusinessCaseOpt3Timeline",u="gridBCOptAddMilestones3",e="dialogAddMilestoneBCOpt3",t=y);var b=!1,k=$("#"+u).data("kendoGrid"),r=k.element.find(".k-detail-row");for(s=0;s<r.length;s++)a=$(r[s]).find(".k-grid").data("kendoGrid"),a!=undefined&&(p=$(r[s]).find(".k-grid").data("kendoGrid").dataSource.data().filter(function(n){return n.IsLinked==!0}).map(function(n){return n}),p.length>0&&(b=!0));if(b==!0&&confirm(setMilestoneConfirmBC)){var k=$("#"+u).data("kendoGrid"),r=k.element.find(".k-detail-row");for(h=0;h<r.length;h++)a=$(r[h]).find(".k-grid").data("kendoGrid"),a!=undefined&&(p=$(r[h]).find(".k-grid").data("kendoGrid").dataSource.data().filter(function(n){return n.IsLinked==!0}).map(function(n){return n}),angular.forEach(p,function(i){var r={},u;r.BusinessScheduleUniqueID=NewGuid();r.MilestoneTemplateID=i.MilestoneTemplateID;r.Milestone=i.Milestone;r.Variance="NA";r.FunctionGroupID=i.FunctionGroupID;r.IncludeInBusinessCase=i.IncludeInReport;r.ProjectID=SeletedProjectId;r.PlannedFinish=null;r.BaselineFinish=null;r.CompletionDate=null;r.MilestoneType=i.MilestoneType;r.MilestoneID=i.MilestoneID;u=t.filter(function(n){return n.MilestoneID==i.MilestoneID});u.length==0&&(t.push(r),n=="Option1"?o.dsBCScheduleOpt1.push(r):n=="Option2"?o.dsBCScheduleOpt2.push(r):n=="Option3"&&o.dsBCScheduleOpt3.push(r))}));!1||(t.length>0&&($("#"+i).data("kendoGrid").dataSource.read(),d=$("#"+i).data("kendoGrid"),angular.forEach(t,function(n){var t=d.dataSource.get(n.BusinessScheduleUniqueID);t!=undefined&&(t.dirty=!0)})),n=="Option1"?c=t:n=="Option2"?v=t:n=="Option3"&&(y=t),$("#"+i).data("kendoGrid").refresh(),w=$("#"+e),w.data("kendoWindow").close())}else w=$("#"+e),w.data("kendoWindow").close()}catch(g){nt={method:"AddMilestoneBCOpt",exceptionMessage:"message:"+g.message+" stack:"+g.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",nt)).then(function(){alert(errormessage)})}}function wi(n){var i="gridBusinessCaseOptTimeline",t="gridBCOptAddMilestones",r="dialogAddMilestoneBCOpt",u;n==BusinessCaseOption1?(i="gridBusinessCaseOptTimeline",t="gridBCOptAddMilestones",r="dialogAddMilestoneBCOpt"):n==BusinessCaseOption2?(i="gridBusinessCaseOpt2Timeline",t="gridBCOptAddMilestones2",r="dialogAddMilestoneBCOpt2"):n==BusinessCaseOption3&&(i="gridBusinessCaseOpt3Timeline",t="gridBCOptAddMilestones3",r="dialogAddMilestoneBCOpt3");u=new kendo.data.DataSource({transport:{read:function(n){n.success(rt)}},sort:[{field:"TemplateOrder",dir:"asc"}]});$("#"+t).kendoGrid({dataSource:u,sortable:!1,selectable:!0,navigatable:!0,height:450,detailInit:n==BusinessCaseOption1?gr:n==BusinessCaseOption2?nu:tu,columns:[{field:"MilestoneSet",title:"Milestone Set(s)",template:"<strong>#: MilestoneSet # <\/strong>",attributes:{"class":"ProgHub1"},headerAttributes:{"class":"wrap-header"}}]})}function gr(n){var r=rt.filter(function(t){return t.MilestoneTemplateID==n.data.MilestoneTemplateID}),i=!0;if(r.length==0&&(i=!1),i){var u={dataSource:{sort:[{field:"SortOrder",dir:"asc"}],transport:{read:function(n){n.success(kt)}},filter:{field:"MilestoneTemplateID",operator:"eq",value:n.data.MilestoneTemplateID}},scrollable:!1,editable:!1,navigatable:!0,columns:[{field:"Milestone",title:"Milestone"},{field:"FunctionalGroupName",title:"Functional Owner"},{field:"Comments",title:"Comment"},{title:"Include in Business Case",headerAttributes:{"class":"wrap-header"},width:"18%",template:function(n){return n.IncludeInReport==!0?'<input type="checkbox" checked class="chkbxmilestonetem" disabled="disabled"  />':'<input type="checkbox" class="chkbxmilestonetem" disabled="disabled" />'}},{field:"IsLinked",title:"Add",headerAttributes:{"class":"wrap-header"},width:"5%",headerTemplate:'<label>Add<\/label><br><input type="checkbox" class="chkheader">',template:function(n){return n.IsLinked==!0?s(n,"IsLinked")+'<input type="checkbox" checked class="chkbxlink" />':s(n,"IsLinked")+'<input type="checkbox" class="chkbxlink" />'}},],dataBound:function(){var n=this;$(".chkbxlink").bind("change",function(n){var e=$(n.target).parent().parent(),r=$(n.target).closest(".k-detail-row").find(".k-grid").data("kendoGrid"),t,u,f,i;r!=undefined&&(t=r.dataItem(e),u=n.target.closest("td"),$(u).prepend("<span class='k-dirty'><\/span>"),t.set("IsLinked",this.checked),this.checked||(f=c.filter(function(n){return n.MilestoneID==t.MilestoneID}),f.length>0&&(i=c.findIndex(n=>n.MilestoneID==t.MilestoneID),c.splice(i,1),t.MilestoneType==null&&(i=o.dsBCScheduleOpt1.findIndex(n=>n.MilestoneID==t.MilestoneID),o.dsBCScheduleOpt1.splice(i,1))),$("#gridBusinessCaseOptTimeline").data("kendoGrid").dataSource.read()))});$(".chkheader").change(function(n){var u=n.target.checked,e=$(n.target).closest(".k-detail-row").find(".k-grid").data("kendoGrid"),i,t,f,r;if(e!=undefined){for(i=$(n.target).closest(".k-detail-row").find(".k-grid").data("kendoGrid").dataSource.view(),t=0;t<i.length;t++)i[t].set("IsLinked",u),u==!1&&(f=c.filter(function(n){return n.MilestoneID==i[t].MilestoneID}),f.length>0&&(r=c.findIndex(n=>n.MilestoneID==i[t].MilestoneID),c.splice(r,1),i[t].MilestoneType==null&&(r=o.dsBCScheduleOpt1.findIndex(n=>n.MilestoneID==i[t].MilestoneID),o.dsBCScheduleOpt1.splice(r,1))));u==!1&&$("#gridBusinessCaseOptTimeline").data("kendoGrid").dataSource.read()}})}},t=$("<div/>").appendTo(n.detailCell).kendoGrid(u).data("kendoGrid");t.tbody.on("keydown",function(n){var r=n.keyCode?n.keyCode:n.which,i;r==13&&(i=$(n.target).closest(".k-combobox").length,i&&(t.editCell(t.current()),$("[data-role='combobox']").data("kendoComboBox").dataSource.read()))})}else $("<div><span>No Milestones are added<\/span><\/div>").appendTo(n.detailCell)}function nu(n){var r=rt.filter(function(t){return t.MilestoneTemplateID==n.data.MilestoneTemplateID}),i=!0;if(r.length==0&&(i=!1),i){var u={dataSource:{sort:[{field:"SortOrder",dir:"asc"}],transport:{read:function(n){n.success(kt)}},filter:{field:"MilestoneTemplateID",operator:"eq",value:n.data.MilestoneTemplateID}},scrollable:!1,editable:!1,navigatable:!0,columns:[{field:"Milestone",title:"Milestone"},{field:"FunctionalGroupName",title:"Functional Owner"},{field:"Comments",title:"Comment"},{title:"Include in Business Case",headerAttributes:{"class":"wrap-header"},width:"8%",template:function(n){return n.IncludeInReport==!0?'<input type="checkbox" checked class="chkbxmilestonetem" disabled="disabled"  />':'<input type="checkbox" class="chkbxmilestonetem" disabled="disabled" />'}},{field:"IsLinked",title:"Add",headerAttributes:{"class":"wrap-header"},width:"5%",headerTemplate:'<label>Add<\/label><br><input type="checkbox" class="chkheader">',template:function(n){return n.IsLinked==!0?s(n,"IsLinked")+'<input type="checkbox" checked class="chkbxlink" />':s(n,"IsLinked")+'<input type="checkbox" class="chkbxlink" />'}},],dataBound:function(){var n=this;$(".chkbxlink").bind("change",function(n){var e=$(n.target).parent().parent(),r=$(n.target).closest(".k-detail-row").find(".k-grid").data("kendoGrid"),t,u,f,i;r!=undefined&&(t=r.dataItem(e),u=n.target.closest("td"),$(u).prepend("<span class='k-dirty'><\/span>"),t.set("IsLinked",this.checked),this.checked||(f=v.filter(function(n){return n.MilestoneID==t.MilestoneID}),f.length>0&&(i=v.findIndex(n=>n.MilestoneID==t.MilestoneID),v.splice(i,1),t.MilestoneType==null&&(i=o.dsBCScheduleOpt2.findIndex(n=>n.MilestoneID==t.MilestoneID),o.dsBCScheduleOpt2.splice(i,1))),$("#gridBusinessCaseOpt2Timeline").data("kendoGrid").dataSource.read()))});$(".chkheader").change(function(n){var u=n.target.checked,e=$(n.target).closest(".k-detail-row").find(".k-grid").data("kendoGrid"),i,t,f,r;if(e!=undefined){for(i=$(n.target).closest(".k-detail-row").find(".k-grid").data("kendoGrid").dataSource.view(),t=0;t<i.length;t++)i[t].set("IsLinked",u),u==!1&&(f=v.filter(function(n){return n.MilestoneID==i[t].MilestoneID}),f.length>0&&(r=v.findIndex(n=>n.MilestoneID==i[t].MilestoneID),v.splice(r,1),i[t].MilestoneType==null&&(r=o.dsBCScheduleOpt2.findIndex(n=>n.MilestoneID==i[t].MilestoneID),o.dsBCScheduleOpt2.splice(r,1))));u==!1&&$("#gridBusinessCaseOpt2Timeline").data("kendoGrid").dataSource.read()}})}},t=$("<div/>").appendTo(n.detailCell).kendoGrid(u).data("kendoGrid");t.tbody.on("keydown",function(n){var r=n.keyCode?n.keyCode:n.which,i;r==13&&(i=$(n.target).closest(".k-combobox").length,i&&(t.editCell(t.current()),$("[data-role='combobox']").data("kendoComboBox").dataSource.read()))})}else $("<div><span>No Milestones are added<\/span><\/div>").appendTo(n.detailCell)}function tu(n){var r=rt.filter(function(t){return t.MilestoneTemplateID==n.data.MilestoneTemplateID}),i=!0;if(r.length==0&&(i=!1),i){var u={dataSource:{sort:[{field:"SortOrder",dir:"asc"}],transport:{read:function(n){n.success(kt)}},filter:{field:"MilestoneTemplateID",operator:"eq",value:n.data.MilestoneTemplateID}},scrollable:!1,editable:!1,navigatable:!0,columns:[{field:"Milestone",title:"Milestone"},{field:"FunctionalGroupName",title:"Functional Owner"},{field:"Comments",title:"Comment"},{title:"Include in Business Case",headerAttributes:{"class":"wrap-header"},width:"8%",template:function(n){return n.IncludeInReport==!0?'<input type="checkbox" checked class="chkbxmilestonetem" disabled="disabled"  />':'<input type="checkbox" class="chkbxmilestonetem" disabled="disabled"  />'}},{field:"IsLinked",title:"Add",headerAttributes:{"class":"wrap-header"},width:"5%",headerTemplate:'<label>Add<\/label><br><input type="checkbox" class="chkheader">',template:function(n){return n.IsLinked==!0?s(n,"IsLinked")+'<input type="checkbox" checked class="chkbxlink" />':s(n,"IsLinked")+'<input type="checkbox" class="chkbxlink" />'}},],dataBound:function(){var n=this;$(".chkbxlink").bind("change",function(n){var e=$(n.target).parent().parent(),r=$(n.target).closest(".k-detail-row").find(".k-grid").data("kendoGrid"),t,u,f,i;r!=undefined&&(t=r.dataItem(e),u=n.target.closest("td"),$(u).prepend("<span class='k-dirty'><\/span>"),t.set("IsLinked",this.checked),this.checked||(f=y.filter(function(n){return n.MilestoneID==t.MilestoneID}),f.length>0&&(i=y.findIndex(n=>n.MilestoneID==t.MilestoneID),y.splice(i,1),t.MilestoneType==null&&(i=o.dsBCScheduleOpt3.findIndex(n=>n.MilestoneID==t.MilestoneID),o.dsBCScheduleOpt3.splice(i,1))),$("#gridBusinessCaseOpt3Timeline").data("kendoGrid").dataSource.read()))});$(".chkheader").change(function(n){var u=n.target.checked,e=$(n.target).closest(".k-detail-row").find(".k-grid").data("kendoGrid"),i,t,f,r;if(e!=undefined){for(i=$(n.target).closest(".k-detail-row").find(".k-grid").data("kendoGrid").dataSource.view(),t=0;t<i.length;t++)i[t].set("IsLinked",u),u==!1&&(f=y.filter(function(n){return n.MilestoneID==i[t].MilestoneID}),f.length>0&&(r=y.findIndex(n=>n.MilestoneID==i[t].MilestoneID),y.splice(r,1),i[t].MilestoneType==null&&(r=o.dsBCScheduleOpt3.findIndex(n=>n.MilestoneID==i[t].MilestoneID),o.dsBCScheduleOpt3.splice(r,1))));u==!1&&$("#gridBusinessCaseOpt3Timeline").data("kendoGrid").dataSource.read()}})}},t=$("<div/>").appendTo(n.detailCell).kendoGrid(u).data("kendoGrid");t.tbody.on("keydown",function(n){var r=n.keyCode?n.keyCode:n.which,i;r==13&&(i=$(n.target).closest(".k-combobox").length,i&&(t.editCell(t.current()),$("[data-role='combobox']").data("kendoComboBox").dataSource.read()))})}else $("<div><span>No Milestones are added<\/span><\/div>").appendTo(n.detailCell)}function bi(n){var h,p,b,s;try{var t="gridBusinessCaseOptTimeline",e="gridBCOptAddMilestones",r="dialogAddMilestoneBCOpt",u=o.deletedMilestoneData;if(ft=c,n==BusinessCaseOption1?(t="gridBusinessCaseOptTimeline",e="gridBCOptAddMilestones",r="dialogAddMilestoneBCOpt",u=o.deletedMilestoneData,ft=c):n==BusinessCaseOption2?(t="gridBusinessCaseOpt2Timeline",e="gridBCOptAddMilestones2",r="dialogAddMilestoneBCOpt2",u=o.deletedMilestoneDataOption2,ft=v):n==BusinessCaseOption3&&(t="gridBusinessCaseOpt3Timeline",e="gridBCOptAddMilestones3",r="dialogAddMilestoneBCOpt3",u=o.deletedMilestoneDataOption3,ft=y),o.milestoneInsertListItems=[],o.milestoneUpdateListItems=[],h=[],p=$("#"+t).data("kendoGrid").tbody.find("input:checked").length,p>milestoneBusinessCount)return alert(milestoneCountMessage),hideLoading(),!1;if($("#"+t).data("kendoGrid")!=undefined){var w=$("#"+t).data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),d=w.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),g=w.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(d,function(n){var t={};t.BusinessScheduleUniqueID=n.BusinessScheduleUniqueID;t.Milestone=n.Milestone;t.PlannedFinish=kendo.toString(n.PlannedFinish,"d");t.FunctionGroupID=n.FunctionGroupID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.ProjectID=n.ProjectID;o.milestoneInsertListItems.push(t)});angular.forEach(g,function(n){var t={};t.BusinessScheduleUniqueID=n.BusinessScheduleUniqueID;t.Milestone=n.Milestone;t.PlannedFinish=kendo.toString(n.PlannedFinish,"d");t.FunctionGroupID=n.FunctionGroupID;t.ProjectID=n.ProjectID;t.link=n.link;ft.length>0&&(t.MilestoneTemplateID=n.MilestoneTemplateID,t.MilestoneID=n.MilestoneID,t.IncludeInBusinessCase=n.IncludeInReport,t.Comments=n.Comments);o.milestoneUpdateListItems.push(t)})}o.insertUpdateDeleteMilestone={insert:o.milestoneInsertListItems,update:o.milestoneUpdateListItems,"delete":u};o.milestoneInsertListItems.length>0||o.milestoneUpdateListItems.length>0||u.length>0?(h.push(o.insertUpdateDeleteMilestone),s={ProjectID:o.SelectedProject.ProjectID,BusinessOptionID:n,objMilestone:JSON.stringify(h),userId:currentUserId},f.postDataWCFAsync("InsertUpdateBussinessCaseSchedule",s).then(function(u){if(u=="Success"){alert("Milestone data updated successfully");ft=[];$.when(f.postDataWCFAsync("getBusinessCaseSchedule",SeletedProjectId)).then(function(r){a=JSON.parse(r.getBusinessCaseScheduleResult);n==BusinessCaseOption1?(o.dsBCScheduleOpt1=a.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1}),c=[]):n==BusinessCaseOption2?(o.dsBCScheduleOpt2=a.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2}),v=[]):n==BusinessCaseOption3&&(o.dsBCScheduleOpt3=a.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3}),y=[]);$("#"+t).data("kendoGrid").dataSource.read();$("#"+e).data("kendoGrid").refresh();i.$digest()});var s=$("#"+r);s.data("kendoWindow").open()}})):(b=$("#"+r),b.data("kendoWindow").open())}catch(k){s={method:"UpdateMilestone",exceptionMessage:"message:"+k.message+" stack:"+k.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",s)).then(function(){})}}function iu(n){trackEvent(n)}function ru(){var n=$("#dialogBCTopsProjectScope");pr();n.data("kendoWindow").open()}function uu(n){var t;if(confirm(ProjectScopeMessage)){if(n.dataItem.LookUpMemberName!=""){t=n.dataItem.LookUpMemberName;o.selectedScopeData=o.dsProjectScopeData.filter(function(n){return n.ProjectScope==t});var r=o.selectedScopeData.filter(function(n){return n.Category=="Duration"}),u=o.selectedScopeData.filter(function(n){return n.Category=="People (FTE Months)"}),f=o.selectedScopeData.filter(function(n){return n.Category=="Total CAPEX"}),e=o.selectedScopeData.filter(function(n){return n.Category=="Total Non Non-FTE OPEX"});o.businessOptionInfoSelector.DurationBaseCase=r[0].BaseCase;o.businessOptionInfoSelector.DurationHighCase=r[0].HighCase;o.businessOptionInfoSelector.PeopleFTEMonthsRequiredBaseCase=u[0].BaseCase;o.businessOptionInfoSelector.PeopleFTEMonthsRequiredHighCase=u[0].HighCase;o.businessOptionInfoSelector.TotalCapexBaseCase=f[0].BaseCase;o.businessOptionInfoSelector.TotalCapexHighCase=f[0].HighCase;o.businessOptionInfoSelector.TotalNonFTEBaseCase=e[0].BaseCase;o.businessOptionInfoSelector.TotalNonFTEHighCase=e[0].HighCase;i.$digest()}}else n.preventDefault(),i.$digest()}function fu(n){var t;if(confirm(ProjectScopeMessage)){if(n.dataItem.LookUpMemberName!=""){t=n.dataItem.LookUpMemberName;o.selectedScopeData=o.dsProjectScopeData.filter(function(n){return n.ProjectScope==t});var r=o.selectedScopeData.filter(function(n){return n.Category=="Duration"}),u=o.selectedScopeData.filter(function(n){return n.Category=="People (FTE Months)"}),f=o.selectedScopeData.filter(function(n){return n.Category=="Total CAPEX"}),e=o.selectedScopeData.filter(function(n){return n.Category=="Total Non Non-FTE OPEX"});o.businessOption2InfoSelector.DurationBaseCase=r[0].BaseCase;o.businessOption2InfoSelector.DurationHighCase=r[0].HighCase;o.businessOption2InfoSelector.PeopleFTEMonthsRequiredBaseCase=u[0].BaseCase;o.businessOption2InfoSelector.PeopleFTEMonthsRequiredHighCase=u[0].HighCase;o.businessOption2InfoSelector.TotalCapexBaseCase=f[0].BaseCase;o.businessOption2InfoSelector.TotalCapexHighCase=f[0].HighCase;o.businessOption2InfoSelector.TotalNonFTEBaseCase=e[0].BaseCase;o.businessOption2InfoSelector.TotalNonFTEHighCase=e[0].HighCase;i.$digest()}}else n.preventDefault(),i.$digest()}function eu(n){var t;if(confirm(ProjectScopeMessage)){if(n.dataItem.LookUpMemberName!=""){t=n.dataItem.LookUpMemberName;o.selectedScopeData=o.dsProjectScopeData.filter(function(n){return n.ProjectScope==t});var r=o.selectedScopeData.filter(function(n){return n.Category=="Duration"}),u=o.selectedScopeData.filter(function(n){return n.Category=="People (FTE Months)"}),f=o.selectedScopeData.filter(function(n){return n.Category=="Total CAPEX"}),e=o.selectedScopeData.filter(function(n){return n.Category=="Total Non Non-FTE OPEX"});o.businessOption3InfoSelector.DurationBaseCase=r[0].BaseCase;o.businessOption3InfoSelector.DurationHighCase=r[0].HighCase;o.businessOption3InfoSelector.PeopleFTEMonthsRequiredBaseCase=u[0].BaseCase;o.businessOption3InfoSelector.PeopleFTEMonthsRequiredHighCase=u[0].HighCase;o.businessOption3InfoSelector.TotalCapexBaseCase=f[0].BaseCase;o.businessOption3InfoSelector.TotalCapexHighCase=f[0].HighCase;o.businessOption3InfoSelector.TotalNonFTEBaseCase=e[0].BaseCase;o.businessOption3InfoSelector.TotalNonFTEHighCase=e[0].HighCase;i.$digest()}}else n.preventDefault(),i.$digest()}function ou(n){var u,t,f,s,i,h,c,r,l;if(confirm(gridClearMessage)){if(n=="Opt1"){for(oi=BusinessCaseOption1,o.selectedBCPeopleRating="",o.selectedBCTechnologyRating="",o.selectedBCBusinessCaseProcess="",o.selectedBCManufacturingProcess="",o.selectedBCEquipmentRating="",o.showCapex="0",o.showOpex="0",$("#functions1").data("kendoComboBox").value(""),$("#impactOpt1").data("kendoComboBox").value(""),$("#InlineProductOpt1").data("kendoComboBox").value(""),o.dsBCScheduleOpt1={},o.dsBCKeyAssumptionOpt1={},o.dsBCRiskIssueOpt1={},o.dsBCKeySuccessOpt1={},o.dsBCBudgetFundingOpt1={},ai={},u=$("#gridOption1Tops").data("kendoGrid"),t=0;t<ii.length;t++)f=u.dataSource.get(ii[t].BusinessKPIUniqueID),f.LookUpValue=topsKPIDefaultValue;$("#gridOption1Tops").data("kendoGrid").refresh();$("#gridBusinessCaseOptTimeline").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptAssumption").data("kendoGrid").dataSource.read();$("#gridBusinessCaseFunding").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptKeySuccessCriteria").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptRisk").data("kendoGrid").dataSource.read();$("#gridCapsWaterWasteOpt1").data("kendoGrid").dataSource.read();o.businessOptionInfoSelector={};o.businessOption2InfoSelector.RecommendedOption==!1&&o.businessOption3InfoSelector.RecommendedOption==!1&&(o.businessOptionInfoSelector.RecommendedOption=!0)}if(n=="Opt2"){for(si=BusinessCaseOption2,o.selectedBCPeopleRatingOption2="",o.selectedBCTechnologyRatingOption2="",o.selectedBCBusinessCaseProcessOption2="",o.selectedBCManufacturingProcessoption2="",o.selectedBCEquipmentRatingOption2="",o.showCapexOpt2="0",o.showOpexOpt2="0",s=$("#gridOption2Tops").data("kendoGrid"),i=0;i<ri.length;i++)h=s.dataSource.get(ri[i].BusinessKPIUniqueID),h.LookUpValue=topsKPIDefaultValue;$("#gridOption2Tops").data("kendoGrid").refresh();o.dsBCScheduleOpt2={};o.dsBCKeyAssumptionOpt2={};o.dsBCRiskIssueOpt2={};o.dsBCKeySuccessOpt2={};o.dsBCBudgetFundingOpt2={};vi={};$("#functions2").data("kendoComboBox").value("");$("#impactOpt2").data("kendoComboBox").value("");$("#InlineProductOpt2").data("kendoComboBox").value("");$("#gridBusinessCaseOpt2Timeline").data("kendoGrid").dataSource.read();$("#gridBusinessCaseFundingOption2").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptKeySuccessCriteriaOption2").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptAssumptionOption2").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptRiskOption2").data("kendoGrid").dataSource.read();$("#gridCapsWaterWasteOpt2").data("kendoGrid").dataSource.read();o.businessOption2InfoSelector={};o.businessOptionInfoSelector.RecommendedOption==!1&&o.businessOption3InfoSelector.RecommendedOption==!1&&(o.businessOption2InfoSelector.RecommendedOption=!0)}if(n=="Opt3"){for(hi=BusinessCaseOption3,o.selectedBCPeopleRatingOption3="",o.selectedBCTechnologyRatingOption3="",o.selectedBCBusinessCaseProcessOption3="",o.selectedBCManufacturingProcessOption3="",o.selectedBCEquipmentRatingOption3="",o.showCapexOpt3="0",o.showOpexOpt3="0",c=$("#gridOption3Tops").data("kendoGrid"),r=0;r<ui.length;r++)l=c.dataSource.get(ui[r].BusinessKPIUniqueID),l.LookUpValue=topsKPIDefaultValue;$("#gridOption3Tops").data("kendoGrid").refresh();o.dsBCScheduleOpt3={};o.dsBCKeyAssumptionOpt3={};o.dsBCRiskIssueOpt3={};o.dsBCKeySuccessOpt3={};o.dsBCBudgetFundingOpt3={};yi={};$("#gridBusinessCaseOpt3Timeline").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptAssumptionOption3").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptRiskOption3").data("kendoGrid").dataSource.read();$("#gridBusinessCaseFundingOption3").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptKeySuccessCriteriaOption3").data("kendoGrid").dataSource.read();$("#gridCapsWaterWasteOpt3").data("kendoGrid").dataSource.read();o.businessOption3InfoSelector={};$("#functions3").data("kendoComboBox").value("");$("#impactOpt3").data("kendoComboBox").value("");$("#InlineProductOpt3").data("kendoComboBox").value("");o.businessOptionInfoSelector.RecommendedOption==!1&&o.businessOption2InfoSelector.RecommendedOption==!1&&(o.businessOption3InfoSelector.RecommendedOption=!0);o.businessOption3InfoSelector.FunctionsRequiredID!=undefined&&(o.businessOption3InfoSelector.FunctionsRequiredID=null)}}else e.preventDefault()}function su(n){var t=$(".recommendCheckbox"),i=t.filter(":checked").length;i==0&&(n=="Opt1"&&(o.businessOptionInfoSelector.RecommendedOption=!0),n=="Opt2"&&(o.businessOption2InfoSelector.RecommendedOption=!0),n=="Opt3"&&(o.businessOption3InfoSelector.RecommendedOption=!0));n=="Opt1"&&(o.businessOption2InfoSelector.RecommendedOption=!1,o.businessOption3InfoSelector.RecommendedOption=!1);n=="Opt2"&&(o.businessOptionInfoSelector.RecommendedOption=!1,o.businessOption3InfoSelector.RecommendedOption=!1);n=="Opt3"&&(o.businessOptionInfoSelector.RecommendedOption=!1,o.businessOption2InfoSelector.RecommendedOption=!1)}function hu(n){if((n=="gridCapsWaterWasteOpt3"||n=="gridCapsWaterWasteOpt1"||n=="gridCapsWaterWasteOpt2")&&$("#"+n).data("kendoGrid").dataSource.data().length>=10){alert(moreThanTenRowsInGrid);return}var t=$("#"+n).data("kendoGrid");t.addRow()}function cu(n,t,i){n=="Yes"?(t=="Opt1"&&(o.businessOptionInfoSelector.CapexRequired=!0),t=="Opt2"&&(o.businessOption2InfoSelector.CapexRequired=!0),t=="Opt3"&&(o.businessOption3InfoSelector.CapexRequired=!0)):confirm(capexClearMessage)?(t=="Opt1"&&(o.businessOptionInfoSelector.CapexRequired=!1,o.businessOptionInfoSelector.TotalCapexBaseCase=null,o.businessOptionInfoSelector.TotalCapexHighCase=null),t=="Opt2"&&(o.businessOption2InfoSelector.CapexRequired=!1,o.businessOption2InfoSelector.TotalCapexBaseCase=null,o.businessOption2InfoSelector.TotalCapexHighCase=null),t=="Opt3"&&(o.businessOption3InfoSelector.CapexRequired=!1,o.businessOption3InfoSelector.TotalCapexBaseCase=null,o.businessOption3InfoSelector.TotalCapexHighCase=null)):i.preventDefault()}function lu(n,t,i){n=="Yes"?t=="Opt1"?o.businessOptionInfoSelector.OpexRequired=!0:t=="Opt2"?o.businessOption2InfoSelector.OpexRequired=!0:t=="Opt3"&&(o.businessOption3InfoSelector.OpexRequired=!0):confirm(opexClearMessage)?(t=="Opt1"&&(o.businessOptionInfoSelector.OpexRequired=!1,o.businessOptionInfoSelector.TotalNonFTEBaseCase=null,o.businessOptionInfoSelector.TotalNonFTEHighCase=null),t=="Opt2"&&(o.businessOption2InfoSelector.OpexRequired=!1,o.businessOption2InfoSelector.TotalNonFTEBaseCase=null,o.businessOption2InfoSelector.TotalNonFTEHighCase=null),t=="Opt3"&&(o.businessOption3InfoSelector.OpexRequired=!1,o.businessOption3InfoSelector.TotalNonFTEBaseCase=null,o.businessOption3InfoSelector.TotalNonFTEHighCase=null)):i.preventDefault()}function au(){try{o.isEditable&&($("#gridBusinessCaseOptTimeline").data("kendoGrid").addRow(),$("#gridBusinessCaseOptAssumption").data("kendoGrid").addRow(),$("#gridBusinessCaseOptRisk").data("kendoGrid").addRow(),$("#gridBusinessCaseFunding").data("kendoGrid").addRow(),$("#gridBusinessCaseOptKeySuccessCriteria").data("kendoGrid").addRow(),$("#gridBusinessCaseOpt2Timeline").data("kendoGrid").addRow(),$("#gridBusinessCaseFundingOption2").data("kendoGrid").addRow(),$("#gridBusinessCaseOptKeySuccessCriteriaOption2").data("kendoGrid").addRow(),$("#gridBusinessCaseOptAssumptionOption2").data("kendoGrid").addRow(),$("#gridBusinessCaseOptRiskOption2").data("kendoGrid").addRow(),$("#gridBusinessCaseOpt3Timeline").data("kendoGrid").addRow(),$("#gridBusinessCaseOptAssumptionOption3").data("kendoGrid").addRow(),$("#gridBusinessCaseOptRiskOption3").data("kendoGrid").addRow(),$("#gridBusinessCaseFundingOption3").data("kendoGrid").addRow(),$("#gridBusinessCaseOptKeySuccessCriteriaOption3").data("kendoGrid").addRow())}catch(n){hideLoading();var t={method:"gridAddDefaultRows",exceptionMessage:"message:"+n.message+" stack:"+n.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",t)).then(function(){alert(errormessage)})}}function vu(n){var t=$("#gridBusinessCaseOptTimeline").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),i=$("#gridBusinessCaseOptRisk").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),r=$("#gridBusinessCaseOptAssumption").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),u=$("#gridBusinessCaseFunding").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),f=$("#gridBusinessCaseOptKeySuccessCriteria").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),e=$("#gridOption1Tops").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),s=$("#gridBusinessCaseOpt2Timeline").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),h=$("#gridBusinessCaseOptRiskOption2").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),c=$("#gridBusinessCaseOptAssumptionOption2").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),l=$("#gridBusinessCaseFundingOption2").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),a=$("#gridBusinessCaseOptKeySuccessCriteriaOption2").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),v=$("#gridOption2Tops").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),y=$("#gridBusinessCaseOpt3Timeline").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),p=$("#gridBusinessCaseOptRiskOption3").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),w=$("#gridBusinessCaseOptAssumptionOption3").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),b=$("#gridBusinessCaseFundingOption3").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),k=$("#gridBusinessCaseOptKeySuccessCriteriaOption3").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),d=$("#gridOption3Tops").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n});yr();(angular.equals(wt,o.SelectedProject)==!1||angular.equals(at,o.businessOptionInfoSelector)==!1||angular.equals(vt,o.businessOption2InfoSelector)==!1||angular.equals(yt,o.businessOption3InfoSelector)==!1||i.length>0||t.length>0||f.length>0||u.length>0||r.length>0||s.length>0||h.length>0||c.length>0||l.length>0||a.length>0||y.length>0||p.length>0||w.length>0||b.length>0||k.length>0||e.length>0||v.length>0||d.length>0)&&(confirm(dialogCloseMessage)||n.preventDefault())}function yu(n){$("#"+n).data("kendoWindow").close()}function pu(){var n,t;trackEvent("Business case dialog opened");h("BC_approvedDate");bindChangeComboBox("ddl_BC_PrimaryProduct");bindChangeComboBox("ddl_GI_PortfolioOwner");h("executionStart");h("executionEnd");h("spendDate");h("assetDate");h("realizationDate1");h("executionStartOpt2");h("executionEndOpt2");h("spendDateOpt2");h("assetDateOpt2");h("realizationDate2");h("executionStartOpt3");h("executionEndOpt3");h("spendDateOpt3");h("assetDateOpt3");h("realizationDate3");displayLoading();n=$("#businessCaseTabstrip").data("kendoTabStrip");n.select(0);hr==!1&&($("#dialogBusinessCase").data("kendoWindow").bind("close",function(n){vu(n)}),hr=!0);ku();t=$("#dialogBusinessCase");t.data("kendoWindow").open();ei==0&&(vr("ddlSponsor"),vr("ddlbusinessCaseAuthor"))}function wu(n){var t;if(n=="Opt1"){if(o.businessOptionInfoSelector.NoCarbonImpact==!0)for(t=0;t<w.length;t++)w[t].EMUnit=null,w[t].EMBasisOfEstimate=null;else dt.length!=0&&angular.copy(dt,w);$("#gridCapsOpt1").data("kendoGrid").dataSource.read()}if(n=="Opt2"){if(o.businessOption2InfoSelector.NoCarbonImpact==!0)for(t=0;t<b.length;t++)b[t].EMUnit=null,b[t].EMBasisOfEstimate=null;else gt.length!=0&&angular.copy(gt,b);$("#gridCapsOpt2").data("kendoGrid").dataSource.read()}if(n=="Opt3"){if(o.businessOption3InfoSelector.NoCarbonImpact==!0)for(t=0;t<k.length;t++)k[t].EMUnit=null,k[t].EMBasisOfEstimate=null;else ni.length!=0&&angular.copy(ni,k);$("#gridCapsOpt3").data("kendoGrid").dataSource.read()}}function bu(n){n=="Opt1"&&(o.isUnitCostWW=o.businessOptionInfoSelector.EnergyWaterImpactCostPerYear!=null&&o.businessOptionInfoSelector.EnergyWaterImpactCostPerYear!=""||o.businessOptionInfoSelector.EnergyWasteImpactCostPerYear!=null&&o.businessOptionInfoSelector.EnergyWasteImpactCostPerYear!=""?!1:null);n=="Opt1"&&(o.isUnitCostWW=o.businessOptionInfoSelector.EnergyWaterImpactCostPerYear!=null&&o.businessOptionInfoSelector.EnergyWaterImpactCostPerYear!=""||o.businessOptionInfoSelector.EnergyWasteImpactCostPerYear!=null&&o.businessOptionInfoSelector.EnergyWasteImpactCostPerYear!=""?!1:null);i.$digest()}function vr(n){$("#"+n).kendoComboBox({suggest:!1,minLength:3,filtering:function(n){n.preventDefault()},dataSource:[],filter:"contains",dataTextField:"UserDisplayName",dataValueField:"UserADId",placeholder:peoplepickerPlaceholder,headerTemplate:'<div class="dropdown-header k-widget k-header"><span>Photo<\/span><span>Contact info<\/span><\/div>',valueTemplate:'<span class="selected-value" style="background-image: url(\'#: data.UserImageUrl #\')"><\/span><span>#: data.UserDisplayName #<\/span>',template:'<span class="k-state-default" style="background-image: url(\'#: data.UserImageUrl #\')"><\/span><span class="k-state-default"><h3>#: data.UserDisplayName #<\/h3># if (data.UserEmailAddress != null) {#<p>#: data.UserEmailAddress #<\/p># }if (data.UserDepartment != null) {#<p><span>#: data.UserDepartment #<\/span># }if (data.UserCountry != null) {# <span> #: data.UserCountry #<\/span><\/p># } #<\/span>'});$("#"+n).data("kendoComboBox").input.on("keydown",function(n){f.searchPeople(n,n.currentTarget.name.replace("_input",""))})}function ku(){o.isEMPortfolio=!1;o.businessOptionInfoSelector={};o.businessOption2InfoSelector={};o.businessOption3InfoSelector={};o.deletedMilestoneData=[];o.deletedRiskData=[];o.deletedKeySuccessData=[];o.deletedAssumptionData=[];o.deletedFundingData=[];o.deletedMilestoneDataOption2=[];o.deletedFundingDataOption2=[];o.deletedRiskDataOption2=[];o.deletedKeySuccessDataOption2=[];o.deletedAssumptionDataOption2=[];o.deletedMilestoneDataOption3=[];o.deletedFundingDataOption3=[];o.deletedRiskDataOption3=[];o.deletedKeySuccessDataOption3=[];o.deletedAssumptionDataOption3=[];try{o.optionsCostImpact={format:"n0",decimals:0,restrictDecimals:!0};o.options={format:"n1",decimals:1,min:0,restrictDecimals:!0};o.optionsCurrency={format:"n0",decimals:0,min:0,restrictDecimals:!0};o.isOption2=!0;o.isOption3=!0;oi="";si="";hi="";pi=!1;o.executionStartOpt1DateError=!1;o.executionEndOpt1DateError=!1;o.ProjectSpendStartOpt1DateError=!1;o.AssetInServiceOpt1DateError=!1;o.executionStartOpt2DateError=!1;o.executionEndOpt2DateError=!1;o.ProjectSpendStartOpt2DateError=!1;o.AssetInServiceOpt2DateError=!1;o.executionStartOpt3DateError=!1;o.executionEndOpt3DateError=!1;o.ProjectSpendStartOpt3DateError=!1;o.AssetInServiceOpt3DateError=!1;o.bcApprovedDateError=!1;o.BCRealizationDate1=!1;o.BCRealizationDate2=!1;o.BCRealizationDate3=!1;o.SelectedProject={};o.selectedPrimaryProduct="";o.isPortfolioOwnerEditableBC=canPortfolioOwnerEdit;SeletedProjectId=getParameterByName(window.location.search,"ProblemID");o.SelectedProjectName=SeletedProjectName;var n={ProjectID:SeletedProjectId,DataType:"BusinessCaseTemplateDetails"},r={ProjectID:SeletedProjectId,DataType:"Template"},u=product+","+portfolioOwner+","+CapitalProjectClassification+","+funtionalGroup+","+feasibilityPeople+","+feasibilityTechnology+","+feasibilityBusinessProcess+","+feasibilityManufacturingProcess+","+feasibilityEquipment+","+businessCaseFundingType+","+riskIssueProbability+","+riskIssueType+","+riskIssueImpact+","+topsFunctionRequired+","+topsImpactMultiplier+","+topsInLineProductStrategy+","+productMaster+","+topsKPI+","+executionScope+","+projectScope+","+emissionPortfolio;$.when(f.postDataWCFAsync("getLookupData",u),f.getDataWCFAsync("getBusinessCaseInfoByProjectID/"+SeletedProjectId),f.getDataWCFAsync("getUserPermissionByProjectUserId/"+currentUserId+"/"+SeletedProjectId),f.getDataWCFAsync("getBusinessCaseOptionByProjectID/"+SeletedProjectId),f.postDataWCFAsync("getBusinessCaseBudgetFunding",SeletedProjectId),f.postDataWCFAsync("getBusinessCaseKeyAssumption",SeletedProjectId),f.postDataWCFAsync("getBusinessCaseRiskIssue",SeletedProjectId),f.postDataWCFAsync("getGetBusinessCaseKeySuccess",SeletedProjectId),f.postDataWCFAsync("getBusinessCaseSchedule",SeletedProjectId),f.postDataWCFAsync("getBusinessCaseTOPSKPI",SeletedProjectId),f.postDataWCFAsync("getAdditionalAuthorByProjectId",SeletedProjectId),f.postDataWCFAsync("getTopsProjectScope",SeletedProjectId),f.postDataWCFAsync("getBusinessCaseCapsDetails",SeletedProjectId),f.postDataWCFAsync("getMilestoneSetProjectHub",r),f.postDataWCFAsync("getMilestoneSetProjectHub",n),f.postDataWCFAsync("getBusinessCaseCAPSWaterWasteByProjectID",SeletedProjectId),f.postDataWCFAsync("getCAPSWaterWaste")).then(function(n,r,u,e,s,h,c,v,y,ft,pt,ti,ii,ri,ui,oi,si){var kr,fr,ki,lr,nr,gi,di,tr,ir,dr,rr,tu,wr,br,iu,ru,lu,vu,yu,pu,wu,bu,ku,du,gu,df,gf,ne,te,ie,ee,oe,er,sr,hr,se,cr,hi,pi,he,ce,le,ae,ve,ye,pe,we,be,ke,de,ge,no,to,io,ur,ro,uo,fo,oo;try{kr=JSON.parse(r.getBusinessCaseInfoByProjectIDResult);o.dsProjectScopeData=JSON.parse(ti.getTopsProjectScopeResult);o.SelectedProject=kr[0];o.localCurrencyAbbrePlaceholder=o.SelectedProject.LocalCurrencyAbbreviation;o.dsPermission=JSON.parse(u.getUserPermissionByProjectUserIdResult);o.dsPermission[0].canEdit==!0&&(o.isEditable=!0);rt=JSON.parse(ri);kt=JSON.parse(ui);fr=JSON.parse(oi.getBusinessCaseCAPSWaterWasteByProjectIDResult);ut=JSON.parse(si.getCAPSWaterWasteResult);bt=Array.from(new Set(ut.map(n=>n.WWStream)));ci=Array.from(new Set(ut.map(n=>n.WWType)));li=Array.from(new Set(ut.map(n=>n.Category)));ai=fr.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1});vi=fr.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2});yi=fr.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3});it=JSON.parse(ii.getBusinessCaseCapsDetailsResult);o.SelectedProject.LocalCurrencyAbbreviation!=null&&(o.localCurrencyAbbre="("+o.SelectedProject.LocalCurrencyAbbreviation+")");o.SelectedProject.SponsorId!=null&&o.SelectedProject.SponsorId!=""?(ki={},lr=[],ki.UserADId=o.SelectedProject.SponsorId,ki.UserDisplayName=o.SelectedProject.SponsorName,ki.UserImageUrl=o.SelectedProject.SponsorImageUrl,ki.UserEmailAddress=o.SelectedProject.SponsorEmailAddress,ki.UserDepartment=o.SelectedProject.SponsorDepartment,ki.UserCountry=o.SelectedProject.SponsorCountry,lr.push(ki),nr=$("#ddlSponsor").data("kendoComboBox"),nr.value(o.SelectedProject.SponsorId),nr.setDataSource(lr),nr.enable(o.isEditable),nr.refresh()):(tr=[],gi=$("#ddlSponsor").data("kendoComboBox"),gi.setDataSource(tr),gi.value(""),gi.text(""),gi.enable(o.isEditable),gi.refresh());o.SelectedProject.BusinessCaseAuthorID!=null&&o.SelectedProject.BusinessCaseAuthorID!=""?(di={},tr=[],di.UserADId=o.SelectedProject.BusinessCaseAuthorID,di.UserDisplayName=o.SelectedProject.BusinessCaseAuthorName,di.UserImageUrl=o.SelectedProject.BusinessCaseAuthorImageUrl,di.UserEmailAddress=o.SelectedProject.BusinessCaseAuthorEmailAddress,di.UserDepartment=o.SelectedProject.BusinessCaseAuthorDepartment,di.UserCountry=o.SelectedProject.BusinessCaseAuthorCountry,tr.push(di),ir=$("#ddlbusinessCaseAuthor").data("kendoComboBox"),ir.value(o.SelectedProject.BusinessCaseAuthorID),ir.setDataSource(tr),ir.enable(o.isEditable),ir.refresh()):(dr=[],rr=$("#ddlbusinessCaseAuthor").data("kendoComboBox"),rr.setDataSource(dr),rr.value(""),rr.enable(o.isEditable),rr.refresh());var bi=JSON.parse(e.getBusinessCaseOptionByProjectIDResult),gr=bi.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2}).length,nu=bi.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3}).length,ar=bi.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1})[0]!=undefined?bi.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1}):bi.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1}),vr=bi.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2})[0]!=undefined?bi.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2}):bi.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2}),yr=bi.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3})[0]!=undefined?bi.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3}):bi.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3});ar.length>0&&(o.businessOptionInfoSelector=ar[0]);vr.length>0&&(o.businessOption2InfoSelector=vr[0]);yr.length>0&&(o.businessOption3InfoSelector=yr[0]);tu={BusinessCaseProcess:null,BusinessCaseProcessID:null,CapexRequired:!1,Equipment:null,EquipmentRatingID:null,FunctionsRequiredID:null,ImpactMultiplierID:null,InLineProductID:null,ManufacturingProcess:null,ManufacturingProcessID:null,OpexRequired:!1,People:null,PeopleRatingID:null,RecommendedOption:!0,Technology:null,TechnologyRatingID:null};wr={BusinessCaseProcess:null,BusinessCaseProcessID:null,CapexRequired:!1,Equipment:null,EquipmentRatingID:null,FunctionsRequiredID:null,ImpactMultiplierID:null,InLineProductID:null,ManufacturingProcess:null,ManufacturingProcessID:null,OpexRequired:!1,People:null,PeopleRatingID:null,Technology:null,TechnologyRatingID:null};wt={};angular.copy(o.SelectedProject,wt);ar.length>0?(at={},angular.copy(o.businessOptionInfoSelector,at)):at=tu;vr.length>0?(vt={},angular.copy(o.businessOption2InfoSelector,vt)):vt=wr;yr.length>0?(yt={},angular.copy(o.businessOption3InfoSelector,yt)):yt=wr;gr==0&&nu==0&&(o.businessOptionInfoSelector.RecommendedOption=!0);(gr!=0||nu!=0)&&o.businessOption2InfoSelector.RecommendedOption==!1&&o.businessOption3InfoSelector.RecommendedOption==!1&&(o.businessOptionInfoSelector.RecommendedOption=!0);o.OEProjectVisibleSolution=o.SelectedProject.IsOEProject;o.SelectedProject.IsOEProject&&(br=$("#ddl_GI_OEProjectType").data("kendoComboBox"),br.value(o.SelectedProject.OEProjectType),br.refresh());o.dsBCPrimaryProduct=JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==product});o.SelectedProject.PrimaryProductID!=""&&(iu=o.dsBCPrimaryProduct.filter(function(n){return n.LookUpMemberID==o.SelectedProject.PrimaryProductID}),o.selectedPrimaryProduct=iu[0]);o.dsBCPortfolioOwner=JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==portfolioOwner});o.SelectedProject.PortfolioOwnerID!=""&&(ru=o.dsBCPortfolioOwner.filter(function(n){return n.LookUpMemberID==o.SelectedProject.PortfolioOwnerID}),o.selectedPortfolioOwner=ru[0]);var ou=[],su=[];o.SelectedProject.OtherImpactedProducts!=null&&o.SelectedProject.OtherImpactedProducts!="undefined"&&(ou=o.SelectedProject.OtherImpactedProducts.split(","));o.SelectedProject.ExecutionScopeID!=null&&o.SelectedProject.ExecutionScopeID!="undefined"&&(su=o.SelectedProject.ExecutionScopeID.split(","));o.ImpactedProductOptions={placeholder:"Select products...",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:o.dsBCPrimaryProduct,filter:"contains"};o.ImpactedProductIds=ou;o.dsBCExectionScope=JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==executionScope});o.ExecutionScopeOptions={placeholder:"Select products...",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:o.dsBCExectionScope,filter:"contains"};o.ExecutionScopeIds=su;o.dsBCFunctionalOwner=JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==funtionalGroup});var hu=[],cu=[],lu=$("#ddl_GI_AdditionalAuthorsContributor").data("kendoMultiSelect");if(o.dsAdditionalAuthList=[],o.SelectedProject.AdditionalAuthorsContributorsID!=null&&o.SelectedProject.AdditionalAuthorsContributorsID!=""&&(o.dsAdditionalAuthList=JSON.parse(pt.getAdditionalAuthorByProjectIdResult),cu=o.SelectedProject.AdditionalAuthorsContributorsID.split(","),angular.forEach(cu,function(n){hu.push(n)})),f.searchPeopleMultiselect("ddl_GI_AdditionalAuthorsContributor",hu,o.dsAdditionalAuthList),lu=$("#ddl_GI_AdditionalAuthorsContributor").data("kendoMultiSelect"),lu.readonly(!o.isEditable),o.dsFeasibilityPeople=t("orderBy")(JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==feasibilityPeople}),"LookUpMemberOrder"),o.businessOptionInfoSelector.PeopleRatingID!=""&&(vu=o.dsFeasibilityPeople.filter(function(n){return n.LookUpMemberID==o.businessOptionInfoSelector.PeopleRatingID}),o.selectedBCPeopleRating=o.businessOptionInfoSelector.PeopleRatingID!=null?vu[0]:""),o.dsEmissionPortfolio=JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==emissionPortfolio}),o.businessOption2InfoSelector.PeopleRatingID!=""&&(yu=o.dsFeasibilityPeople.filter(function(n){return n.LookUpMemberID==o.businessOption2InfoSelector.PeopleRatingID}),o.selectedBCPeopleRatingOption2=o.businessOption2InfoSelector.PeopleRatingID!=null?yu[0]:""),o.businessOption3InfoSelector.PeopleRatingID!=""&&(pu=o.dsFeasibilityPeople.filter(function(n){return n.LookUpMemberID==o.businessOption3InfoSelector.PeopleRatingID}),o.selectedBCPeopleRatingOption3=o.businessOption3InfoSelector.PeopleRatingID!=null?pu[0]:""),o.dsFeasibilityTechnology=t("orderBy")(JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==feasibilityTechnology}),"LookUpMemberOrder"),o.businessOptionInfoSelector.TechnologyRatingID!=""&&(wu=o.dsFeasibilityTechnology.filter(function(n){return n.LookUpMemberID==o.businessOptionInfoSelector.TechnologyRatingID}),o.selectedBCTechnologyRating=o.businessOptionInfoSelector.TechnologyRatingID!=null?wu[0]:""),o.businessOption2InfoSelector.TechnologyRatingID!=""&&(bu=o.dsFeasibilityTechnology.filter(function(n){return n.LookUpMemberID==o.businessOption2InfoSelector.TechnologyRatingID}),o.selectedBCTechnologyRatingOption2=o.businessOption2InfoSelector.TechnologyRatingID!=null?bu[0]:""),o.businessOption3InfoSelector.TechnologyRatingID!=""&&(ku=o.dsFeasibilityTechnology.filter(function(n){return n.LookUpMemberID==o.businessOption3InfoSelector.TechnologyRatingID}),o.selectedBCTechnologyRatingOption3=o.businessOption3InfoSelector.TechnologyRatingID!=null?ku[0]:""),o.dsFeasibilityBusiness=t("orderBy")(JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==feasibilityBusinessProcess}),"LookUpMemberOrder"),o.businessOptionInfoSelector.BusinessCaseProcessID!=""&&(du=o.dsFeasibilityBusiness.filter(function(n){return n.LookUpMemberID==o.businessOptionInfoSelector.BusinessCaseProcessID}),o.selectedBCBusinessCaseProcess=o.businessOptionInfoSelector.BusinessCaseProcessID!=null?du[0]:""),o.businessOption2InfoSelector.BusinessCaseProcessID!=""&&(gu=o.dsFeasibilityBusiness.filter(function(n){return n.LookUpMemberID==o.businessOption2InfoSelector.BusinessCaseProcessID}),o.selectedBCBusinessCaseProcessOption2=o.businessOption2InfoSelector.BusinessCaseProcessID!=null?gu[0]:""),o.businessOption3InfoSelector.BusinessCaseProcessID!=""&&(df=o.dsFeasibilityBusiness.filter(function(n){return n.LookUpMemberID==o.businessOption3InfoSelector.BusinessCaseProcessID}),o.selectedBCBusinessCaseProcessOption3=o.businessOption3InfoSelector.BusinessCaseProcessID!=null?df[0]:""),o.dsFeasibilityManufacturing=t("orderBy")(JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==feasibilityManufacturingProcess}),"LookUpMemberOrder"),o.businessOptionInfoSelector.ManufacturingProcessID!=""&&(gf=o.dsFeasibilityManufacturing.filter(function(n){return n.LookUpMemberID==o.businessOptionInfoSelector.ManufacturingProcessID}),o.selectedBCManufacturingProcess=o.businessOptionInfoSelector.ManufacturingProcessID!=null?gf[0]:""),o.businessOption2InfoSelector.ManufacturingProcessID!=""&&(ne=o.dsFeasibilityManufacturing.filter(function(n){return n.LookUpMemberID==o.businessOption2InfoSelector.ManufacturingProcessID}),o.selectedBCManufacturingProcessoption2=o.businessOption2InfoSelector.ManufacturingProcessID!=null?ne[0]:""),o.businessOption3InfoSelector.ManufacturingProcessID!=""&&(te=o.dsFeasibilityManufacturing.filter(function(n){return n.LookUpMemberID==o.businessOption3InfoSelector.ManufacturingProcessID}),o.selectedBCManufacturingProcessOption3=o.businessOption3InfoSelector.ManufacturingProcessID!=null?te[0]:""),o.dsFeasibilityEquipment=t("orderBy")(JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==feasibilityEquipment}),"LookUpMemberOrder"),o.businessOptionInfoSelector.EquipmentRatingID!=""&&(ie=o.dsFeasibilityEquipment.filter(function(n){return n.LookUpMemberID==o.businessOptionInfoSelector.EquipmentRatingID}),o.selectedBCEquipmentRating=o.businessOptionInfoSelector.EquipmentRatingID!=null?ie[0]:""),o.businessOption2InfoSelector.EquipmentRatingID!=""&&(ee=o.dsFeasibilityEquipment.filter(function(n){return n.LookUpMemberID==o.businessOption2InfoSelector.EquipmentRatingID!=null?o.businessOption2InfoSelector.EquipmentRatingID:""}),o.selectedBCEquipmentRatingOption2=ee[0]),o.businessOption3InfoSelector.EquipmentRatingID!=""&&(oe=o.dsFeasibilityEquipment.filter(function(n){return n.LookUpMemberID==o.businessOption3InfoSelector.EquipmentRatingID}),o.selectedBCEquipmentRatingOption3=o.businessOption3InfoSelector.EquipmentRatingID!=null?oe[0]:""),w=it.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1}),angular.copy(w,dt),o.isEMPortfolio=o.SelectedProject.EmissionPortfolioID!=null?!0:!1,er=[],er=o.dsEmissionPortfolio.filter(function(n){return n.LookUpMemberID==o.SelectedProject.EmissionPortfolioID}),o.SelectedCapsEmissionPortfolio1=er.length>0?er[0]:"",b=it.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2}),angular.copy(b,gt),sr=[],sr=o.dsEmissionPortfolio.filter(function(n){return n.LookUpMemberID==o.SelectedProject.EmissionPortfolioID}),o.SelectedCapsEmissionPortfolio2=sr.length>0?sr[0]:"",k=it.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3}),angular.copy(k,ni),hr=[],hr=o.dsEmissionPortfolio.filter(function(n){return n.LookUpMemberID==o.SelectedProject.EmissionPortfolioID}),o.SelectedCapsEmissionPortfolio3=hr.length>0?hr[0]:"",o.formattedCalculatedEmissionsImpact1=kendo.toString(o.businessOptionInfoSelector.CalculatedEmissionsImpact,"n1"),o.formattedCalculatedEmissionsImpact2=kendo.toString(o.businessOption2InfoSelector.CalculatedEmissionsImpact,"n1"),o.formattedCalculatedEmissionsImpact3=kendo.toString(o.businessOption3InfoSelector.CalculatedEmissionsImpact,"n1"),ei==0){for(p=[],hi=0;hi<o.dsBCFunctionalOwner.length;hi++)pi={text:o.dsBCFunctionalOwner[hi].LookUpMemberName,value:o.dsBCFunctionalOwner[hi].LookUpMemberID},p.push(pi);for(o.dsFundingType=t("orderBy")(JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==businessCaseFundingType}),"LookUpMemberOrder"),et=[],hi=0;hi<o.dsFundingType.length;hi++)pi={text:o.dsFundingType[hi].LookUpMemberName,value:o.dsFundingType[hi].LookUpMemberID},et.push(pi);for(o.dsLikelihood=t("orderBy")(JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==riskIssueProbability}),"LookUpMemberOrder"),lt=[],lt=[{value:!0,text:"Yes"},{value:!1,text:"No"}],st=[],hi=0;hi<o.dsLikelihood.length;hi++)pi={text:o.dsLikelihood[hi].LookUpMemberName,value:o.dsLikelihood[hi].LookUpMemberID},st.push(pi);for(o.dsFundingSource=t("orderBy")(JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==portfolioOwner}),"LookUpMemberOrder"),ht=[],hi=0;hi<o.dsFundingSource.length;hi++)pi={text:o.dsFundingSource[hi].LookUpMemberName,value:o.dsFundingSource[hi].LookUpMemberID},ht.push(pi);for(o.dsRiskIssueImpact=t("orderBy")(JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==riskIssueImpact}),"LookUpMemberOrder"),ot=[],hi=0;hi<o.dsRiskIssueImpact.length;hi++)pi={text:o.dsRiskIssueImpact[hi].LookUpMemberName,value:o.dsRiskIssueImpact[hi].LookUpMemberID},ot.push(pi);for(o.riskIssueType=JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName===riskIssueType}),ct=[],hi=0;hi<o.riskIssueType.length;hi++)se={text:o.riskIssueType[hi].LookUpMemberName,value:o.riskIssueType[hi].LookUpMemberID},ct.push(se)}for(o.businessOptionInfoSelector.OpexRequired==!0?(o.showOpex="1",o.businessOptionInfoSelector.OpexRequired=!0):(o.showOpex="0",o.businessOptionInfoSelector.OpexRequired=!1),o.businessOptionInfoSelector.CapexRequired==!0?(o.showCapex="1",o.businessOptionInfoSelector.CapexRequired=!0):(o.showCapex="0",o.businessOptionInfoSelector.CapexRequired=!1),o.businessOption2InfoSelector.OpexRequired==!0?(o.showOpexOpt2="1",o.businessOption2InfoSelector.OpexRequired=!0):(o.showOpexOpt2="0",o.businessOption2InfoSelector.OpexRequired=!1),o.businessOption2InfoSelector.CapexRequired==!0?(o.showCapexOpt2="1",o.businessOption2InfoSelector.CapexRequired=!0):(o.showCapexOpt2="0",o.businessOption2InfoSelector.CapexRequired=!1),o.businessOption3InfoSelector.OpexRequired==!0?(o.showOpexOpt3="1",o.businessOption3InfoSelector.OpexRequired=!0):(o.showOpexOpt3="0",o.businessOption3InfoSelector.OpexRequired=!1),o.businessOption3InfoSelector.CapexRequired==!0?(o.showCapexOpt3="1",o.businessOption3InfoSelector.CapexRequired=!0):(o.showCapexOpt3="0",o.businessOption3InfoSelector.CapexRequired=!1),d=JSON.parse(s.getBusinessCaseBudgetFundingResult),g=JSON.parse(h.getBusinessCaseKeyAssumptionResult),nt=JSON.parse(c.getBusinessCaseRiskIssueResult),tt=JSON.parse(v.getGetBusinessCaseKeySuccessResult),a=JSON.parse(y.getBusinessCaseScheduleResult),o.dsBCScheduleOpt1=a.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1}),o.dsBCScheduleOpt2=a.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2}),o.dsBCScheduleOpt3=a.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3}),o.dsBCKeySuccessOpt1=tt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1}),o.dsBCKeySuccessOpt2=tt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2}),o.dsBCKeySuccessOpt3=tt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3}),o.dsBCRiskIssueOpt1=nt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1}),o.dsBCRiskIssueOpt2=nt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2}),o.dsBCRiskIssueOpt3=nt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3}),o.dsBCKeyAssumptionOpt1=g.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1}),o.dsBCKeyAssumptionOpt2=g.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2}),o.dsBCKeyAssumptionOpt3=g.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3}),o.dsBCBudgetFundingOpt1=d.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1}),o.dsBCBudgetFundingOpt2=d.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2}),o.dsBCBudgetFundingOpt3=d.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3}),o.dsProjectScope=t("orderBy")(JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==projectScope}),"LookUpMemberOrder"),o.dsTopsFunctions=JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==topsFunctionRequired}),o.dsTopsImpactMultiplier=JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==topsImpactMultiplier}),o.dsTopsInLineProductStrategy=JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==topsInLineProductStrategy}),o.dsTopsProducts=JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==productMaster}),cr=JSON.parse(n.getLookupDataResult).filter(function(n){return n.LookUpName==topsKPI}),hi=0;hi<cr.length;hi++)pi={text:cr[hi].LookUpMemberName,value:cr[hi].LookUpMemberID},fi.push(pi);o.businessOptionInfoSelector.ProjectScope!=null&&(he=o.dsProjectScope.filter(function(n){return n.LookUpMemberID==o.businessOptionInfoSelector.ProjectScope}));o.businessOptionInfoSelector.ProjectScope=o.businessOptionInfoSelector.ProjectScope!=null&&o.businessOptionInfoSelector.ProjectScope!=""?he[0]:null;o.businessOptionInfoSelector.FunctionsRequiredID!=null&&(ce=o.dsTopsFunctions.filter(function(n){return n.LookUpMemberID==o.businessOptionInfoSelector.FunctionsRequiredID}));o.businessOptionInfoSelector.FunctionsRequiredID=o.businessOptionInfoSelector.FunctionsRequiredID!=null&&o.businessOptionInfoSelector.FunctionsRequiredID!=""?ce[0]:null;o.businessOptionInfoSelector.InLineProductID!=null&&(le=o.dsTopsInLineProductStrategy.filter(function(n){return n.LookUpMemberID==o.businessOptionInfoSelector.InLineProductID}));o.businessOptionInfoSelector.InLineProductID=o.businessOptionInfoSelector.InLineProductID!=null&&o.businessOptionInfoSelector.InLineProductID!=""?le[0]:null;o.businessOptionInfoSelector.ImpactMultiplierID!=null&&(ae=o.dsTopsImpactMultiplier.filter(function(n){return n.LookUpMemberID==o.businessOptionInfoSelector.ImpactMultiplierID}));o.businessOptionInfoSelector.ImpactMultiplierID=o.businessOptionInfoSelector.ImpactMultiplierID!=null&&o.businessOptionInfoSelector.ImpactMultiplierID!=""?ae[0]:null;o.businessOption2InfoSelector.ProjectScope!=null&&(ve=o.dsProjectScope.filter(function(n){return n.LookUpMemberID==o.businessOption2InfoSelector.ProjectScope}));o.businessOption2InfoSelector.ProjectScope=o.businessOption2InfoSelector.ProjectScope!=null&&o.businessOption2InfoSelector.ProjectScope!=""?ve[0]:null;o.businessOption2InfoSelector.FunctionsRequiredID!=null&&(ye=o.dsTopsFunctions.filter(function(n){return n.LookUpMemberID==o.businessOption2InfoSelector.FunctionsRequiredID}));o.businessOption2InfoSelector.FunctionsRequiredID=o.businessOption2InfoSelector.FunctionsRequiredID!=null&&o.businessOption2InfoSelector.FunctionsRequiredID!=""?ye[0]:null;o.businessOption2InfoSelector.InLineProductID!=null&&(pe=o.dsTopsInLineProductStrategy.filter(function(n){return n.LookUpMemberID==o.businessOption2InfoSelector.InLineProductID}));o.businessOption2InfoSelector.InLineProductID=o.businessOption2InfoSelector.InLineProductID!=null&&o.businessOption2InfoSelector.InLineProductID!=""?pe[0]:null;o.businessOption2InfoSelector.ImpactMultiplierID!=null&&(we=o.dsTopsImpactMultiplier.filter(function(n){return n.LookUpMemberID==o.businessOption2InfoSelector.ImpactMultiplierID}));o.businessOption2InfoSelector.ImpactMultiplierID=o.businessOption2InfoSelector.ImpactMultiplierID!=null&&o.businessOption2InfoSelector.ImpactMultiplierID!=""?we[0]:null;o.businessOption3InfoSelector.ProjectScope!=null&&(be=o.dsProjectScope.filter(function(n){return n.LookUpMemberID==o.businessOption3InfoSelector.ProjectScope}));o.businessOption3InfoSelector.ProjectScope=o.businessOption3InfoSelector.ProjectScope!=null&&o.businessOption3InfoSelector.ProjectScope!=""?be[0]:null;o.businessOption3InfoSelector.FunctionsRequiredID!=null&&(ke=o.dsTopsFunctions.filter(function(n){return n.LookUpMemberID==o.businessOption3InfoSelector.FunctionsRequiredID}));o.businessOption3InfoSelector.FunctionsRequiredID=o.businessOption3InfoSelector.FunctionsRequiredID!=null&&o.businessOption3InfoSelector.FunctionsRequiredID!=""?ke[0]:null;o.businessOption3InfoSelector.InLineProductID!=null&&(de=o.dsTopsInLineProductStrategy.filter(function(n){return n.LookUpMemberID==o.businessOption3InfoSelector.InLineProductID}));o.businessOption3InfoSelector.InLineProductID=o.businessOption3InfoSelector.InLineProductID!=null&&o.businessOption3InfoSelector.InLineProductID!=""?de[0]:null;o.businessOption3InfoSelector.ImpactMultiplierID!=null&&(ge=o.dsTopsImpactMultiplier.filter(function(n){return n.LookUpMemberID==o.businessOption3InfoSelector.ImpactMultiplierID}));o.businessOption3InfoSelector.ImpactMultiplierID=o.businessOption3InfoSelector.ImpactMultiplierID!=null&&o.businessOption3InfoSelector.ImpactMultiplierID!=""?ge[0]:null;ei==0?(no=$("#ddl_ProjectScopeBC1").data("kendoDropDownList"),no.bind("select",uu),to=$("#ddl_ProjectScopeBC2").data("kendoDropDownList"),to.bind("select",fu),io=$("#ddl_ProjectScopeBC3").data("kendoDropDownList"),io.bind("select",eu),re(),ue(),fe(),pr(),of(),vf(),wf(),cf(),nf(),wi(BusinessCaseOption1),uf(),sf(),bf(),lf(),yf(),tf(),wi(BusinessCaseOption2),ff(),hf(),pf(),kf(),af(),rf(),wi(BusinessCaseOption3),ef()):($("#gridBusinessCaseOptTimeline").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseOptAssumption").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseFunding").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseOptKeySuccessCriteria").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseOptRisk").data("kendoGrid").dataSource.read(),$("#gridCapsOpt1").data("kendoGrid").dataSource.read(),$("#gridCapsWaterWasteOpt1").data("kendoGrid").dataSource.read(),ur=new kendo.data.DataSource({data:rt}),ro=$("#gridBCOptAddMilestones").data("kendoGrid"),ur.read(),ro.setDataSource(ur),$("#gridBusinessCaseOpt2Timeline").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseFundingOption2").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseOptKeySuccessCriteriaOption2").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseOptAssumptionOption2").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseOptRiskOption2").data("kendoGrid").dataSource.read(),$("#gridCapsOpt2").data("kendoGrid").dataSource.read(),$("#gridCapsWaterWasteOpt2").data("kendoGrid").dataSource.read(),uo=$("#gridBCOptAddMilestones2").data("kendoGrid"),uo.setDataSource(ur),$("#gridBusinessCaseOpt3Timeline").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseOptAssumptionOption3").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseOptRiskOption3").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseFundingOption3").data("kendoGrid").dataSource.read(),$("#gridBusinessCaseOptKeySuccessCriteriaOption3").data("kendoGrid").dataSource.read(),$("#gridCapsOpt3").data("kendoGrid").dataSource.read(),$("#gridCapsWaterWasteOpt3").data("kendoGrid").dataSource.read(),fo=$("#gridBCOptAddMilestones3").data("kendoGrid"),fo.setDataSource(ur));or();bindChangeComboBox("peopleRating");bindChangeComboBox("technologyRating");bindChangeComboBox("businessProcessRating");bindChangeComboBox("manufacturingRating");bindChangeComboBox("equipmentRating");bindChangeComboBox("peopleRating2");bindChangeComboBox("technologyRating2");bindChangeComboBox("businessProcessRating2");bindChangeComboBox("manufacturingRating2");bindChangeComboBox("equipmentRating2");bindChangeComboBox("peopleRating3");bindChangeComboBox("technologyRating3");bindChangeComboBox("businessProcessRating3");bindChangeComboBox("manufacturingRating3");bindChangeComboBox("equipmentRating3");bindChangeComboBox("functions1");bindChangeComboBox("functions2");bindChangeComboBox("functions3");bindChangeComboBox("InlineProductOpt1");bindChangeComboBox("impactOpt1");bindChangeComboBox("InlineProductOpt2");bindChangeComboBox("impactOpt2");bindChangeComboBox("InlineProductOpt3");bindChangeComboBox("impactOpt3");au();ei++;i.$digest();hideLoading()}catch(eo){hideLoading();oo={method:"prepareDataForBusinessCase",exceptionMessage:"message:"+eo.message+" stack:"+eo.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",oo)).then(function(){alert(errormessage)})}})}catch(e){hideLoading()}}function ki(n,t){$('<input name="'+t.field+'"/>').appendTo(n).kendoDropDownList({autoBind:!1,dataTextField:"text",dataValueField:"value",valuePrimitive:!0,dataSource:ct})}function di(n,t){$('<input name="'+t.field+'"/>').appendTo(n).kendoDropDownList({autoBind:!1,dataTextField:"text",dataValueField:"value",valuePrimitive:!0,dataSource:ot})}function gi(n,t){$('<input name="'+t.field+'"/>').appendTo(n).kendoDropDownList({autoBind:!1,dataTextField:"text",dataValueField:"value",valuePrimitive:!0,dataSource:st})}function pt(n,t){$('<input name="'+t.field+'"/>').appendTo(n).kendoDropDownList({autoBind:!1,dataTextField:"text",dataValueField:"value",valuePrimitive:!0,dataSource:p})}function nr(n,t){$('<input name="'+t.field+'"/>').appendTo(n).kendoDropDownList({autoBind:!1,dataTextField:"text",dataValueField:"value",valuePrimitive:!0,dataSource:et})}function tr(n,t){$('<input name="'+t.field+'"/>').appendTo(n).kendoDropDownList({autoBind:!1,dataTextField:"text",dataValueField:"value",valuePrimitive:!0,dataSource:lt})}function ir(n,t){$('<input name="'+t.field+'"/>').appendTo(n).kendoDropDownList({autoBind:!1,dataTextField:"text",dataValueField:"value",valuePrimitive:!0,dataSource:ht})}function du(){var h;try{var t="",c="",i="",a="",r,u;o.ExecutionScopeIds!=null&&(u=o.ExecutionScopeIds.join(","));o.ImpactedProductIds!=null&&(r=o.ImpactedProductIds.join(","));$("#ddlSponsor").data("kendoComboBox")!=null&&$("#ddlSponsor").data("kendoComboBox").selectedIndex!=-1&&(t=$("#ddlSponsor").data("kendoComboBox").value(),c=$("#ddlSponsor").data("kendoComboBox").text());$("#ddlbusinessCaseAuthor").data("kendoComboBox")!=null&&$("#ddlbusinessCaseAuthor").data("kendoComboBox").selectedIndex!=-1&&(i=$("#ddlbusinessCaseAuthor").data("kendoComboBox").value(),a=$("#ddlbusinessCaseAuthor").data("kendoComboBox").text());var n="",v=$("#ddl_GI_AdditionalAuthorsContributor").data("kendoMultiSelect"),e=v.value();return e!=null&&e.length>0?(angular.forEach(e,function(t){n=n+","+t}),n=n.substring(1,n.length)):n=null,o.busninessCaseSelectorData={ProblemUniqueID:o.SelectedProject.ProjectID,ProblemTitle:o.SelectedProject.ProjectName!=null?o.SelectedProject.ProjectName:null,PrimaryProductID:o.selectedPrimaryProduct!=null?o.selectedPrimaryProduct.LookUpMemberID:null,OtherImpactedProducts:r!=null?r:null,ExecutionScopeID:u!=null?u:null,ProjectDescription:o.SelectedProject.ProjectDescription!=null?o.SelectedProject.ProjectDescription:null,PortfolioOwnerID:o.selectedPortfolioOwner!=null?o.selectedPortfolioOwner.LookUpMemberID:null,SponserID:t!=""?t:null,BusinessCaseAuthorID:i!=""?i:null,AdditionalAuthorsContributorsID:n,ImpactOfDoingNothing:o.SelectedProject.ImpactOfDoingNothing!=null?o.SelectedProject.ImpactOfDoingNothing:null,StrategicRationale:o.SelectedProject.StrategicRationale!=null?o.SelectedProject.StrategicRationale:null,ApprovedDate:o.SelectedProject.ApprovedDate!=null&&o.SelectedProject.ApprovedDate!=""?o.SelectedProject.ApprovedDate:null},o.busninessCaseSelectorData}catch(s){hideLoading();h={method:"getBusinessCaseGeneralInfoData",exceptionMessage:"message:"+s.message+" stack:"+s.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",h)).then(function(){alert(errormessage)})}}function h(n){$("#"+n).on("change",function(){gu($(this).attr("id"))})}function gu(n){var t=!1,r=$("#"+n).val();if(parseDate(r)&&(t=!0),t){switch(n){case"executionStart":o.executionStartOpt1DateError=!1;break;case"executionEnd":o.executionEndOpt1DateError=!1;break;case"spendDate":o.ProjectSpendStartOpt1DateError=!1;break;case"assetDate":o.AssetInServiceOpt1DateError=!1;break;case"executionStartOpt2":o.executionStartOpt2DateError=!1;break;case"executionEndOpt2":o.executionEndOpt2DateError=!1;break;case"spendDateOpt2":o.ProjectSpendStartOpt2DateError=!1;break;case"assetDateOpt2":o.AssetInServiceOpt2DateError=!1;break;case"executionStartOpt3":o.executionStartOpt3DateError=!1;break;case"executionEndOpt3":o.executionEndOpt3DateError=!1;break;case"spendDateOpt3":o.ProjectSpendStartOpt3DateError=!1;break;case"assetDateOpt3":o.AssetInServiceOpt3DateError=!1;break;case"BC_approvedDate":o.bcApprovedDateError=!1;break;case"realizationDate1":o.BCRealizationDate1=!1;break;case"realizationDate2":o.BCRealizationDate2=!1;break;case"realizationDate3":o.BCRealizationDate2=!1}i.$digest()}}function nf(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(w)}},schema:{model:{id:"EmissionSourceID",fields:{EMSourceID:{hidden:!0},EMSourceName:{type:"string",editable:!1},EMUnit:{type:"number",validation:{maxlength:10},editable:o.isEditable},UnitOfMeasure:{type:"string",editable:!1},EMBasisOfEstimate:{type:"string",editable:o.isEditable},EMFactorImpact:{hidden:!0}}}}});$("#gridCapsOpt1").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:o.isEditable,edit:function(){o.businessOptionInfoSelector.NoCarbonImpact==!0&&$("#gridCapsOpt1").data("kendoGrid").closeCell()},columns:[{field:"EMSourceName",title:"Emission Source",headerAttributes:{"class":"wrap-header"},width:"8%"},{field:"EMUnit",title:"Units",editor:sr,width:"5%",format:"{0:n0}",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"},headerTemplate:'<div>Units<span title="Input gross change in emissions type here in the unit provided using whole numbers. Positive values for increase, negative values for decrease" class="k-icon k-i-question"><\/span><\/div>'},{field:"UnitOfMeasure",title:"UoM",width:"2%"},{field:"EMBasisOfEstimate",title:"Basis of Estimate",width:"15%"}]})}function tf(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(b)}},schema:{model:{id:"EmissionSourceID",fields:{EMSourceID:{hidden:!0},EMSourceName:{type:"string",editable:!1},EMUnit:{type:"number",validation:{maxlength:10},editable:o.isEditable},UnitOfMeasure:{type:"string",editable:!1},EMBasisOfEstimate:{type:"string",editable:o.isEditable},EMFactorImpact:{hidden:!0}}}}});$("#gridCapsOpt2").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:o.isEditable,edit:function(){o.businessOption2InfoSelector.NoCarbonImpact==!0&&$("#gridCapsOpt2").data("kendoGrid").closeCell()},columns:[{field:"EMSourceName",title:"Emission Source",headerAttributes:{"class":"wrap-header"},width:"8%"},{field:"EMUnit",title:"Units",editor:sr,width:"5%",format:"{0:n0}",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"},headerTemplate:'<div>Units<span title="Input gross change in emissions type here in the unit provided using whole numbers. Positive values for increase, negative values for decrease" class="k-icon k-i-question"><\/span><\/div>'},{field:"UnitOfMeasure",title:"UoM",width:"2%"},{field:"EMBasisOfEstimate",title:"Basis of Estimate",width:"15%"}]})}function rf(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(k)}},schema:{model:{id:"EmissionSourceID",fields:{EMSourceID:{hidden:!0},EMSourceName:{type:"string",editable:!1},EMUnit:{type:"number",validation:{maxlength:10},editable:o.isEditable},UnitOfMeasure:{type:"string",editable:!1},EMBasisOfEstimate:{type:"string",editable:o.isEditable},EMFactorImpact:{hidden:!0}}}}});$("#gridCapsOpt3").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:o.isEditable,edit:function(){o.businessOption3InfoSelector.NoCarbonImpact==!0&&$("#gridCapsOpt3").data("kendoGrid").closeCell()},columns:[{field:"EMSourceName",title:"Emission Source",headerAttributes:{"class":"wrap-header"},width:"8%"},{field:"EMUnit",title:"Units",editor:sr,width:"5%",format:"{0:n0}",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"},headerTemplate:'<div>Units<span title="Input gross change in emissions type here in the unit provided using whole numbers. Positive values for increase, negative values for decrease" class="k-icon k-i-question"><\/span><\/div>'},{field:"UnitOfMeasure",title:"UoM",width:"2%"},{field:"EMBasisOfEstimate",title:"Basis of Estimate",width:"15%"}]})}function uf(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(ai)}},sort:[{field:"WWStream",dir:"asc"},{field:"WWType",dir:"asc"},{field:"Category",dir:"asc"}],schema:{model:{id:"EMDataWWID",fields:{EMDataWWID:{hidden:!0},WWStream:{type:"string",editable:o.isEditable},EMWWUnit:{type:"number",validation:{maxlength:10},editable:o.isEditable},StandardUoM:{type:"string",editable:!1},UnitCost:{type:"number",editable:o.isEditable},WWType:{type:"string",editable:o.isEditable},Category:{type:"string",editable:o.isEditable},EMBasisOfEstimate:{type:"string",editable:o.isEditable}}}}});$("#gridCapsWaterWasteOpt1").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:{createAt:"bottom"},columns:[{field:"WWStream",title:"Water/Waste",headerAttributes:{"class":"wrap-header"},width:"15%",editor:rr,values:bt},{field:"WWType",title:"Type",headerAttributes:{"class":"wrap-header"},width:"15%",editor:ur,values:ci},{field:"Category",title:"Category",headerAttributes:{"class":"wrap-header"},width:"15%",editor:fr,values:li},{field:"EMWWUnit",title:"Units",editor:editNumber,width:"10%",format:"{0:n0}",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"},headerTemplate:'<div>Units<span title="Input gross change in emissions type here in the unit provided using whole numbers. Positive values for increase, negative values for decrease" class="k-icon k-i-question"><\/span><\/div>'},{field:"StandardUoM",title:"UoM",width:"10%"},{field:"EMBasisOfEstimate",title:"Basis of Estimate",width:"20%"},{hidden:!o.isEditable,width:"5%",command:[{name:" ",iconClass:"k-icon k-i-close",click:function(n){var r,t,u,o;try{confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t.EMDataWWID!="undefined"&&t.EMDataWWID!=""&&cr.push({EMDataWWID:t.EMDataWWID}),u=$("#gridCapsWaterWasteOpt1").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}catch(e){hideLoading();o={method:"InitKendoGridCapsWaterWasteOpt1",exceptionMessage:"message:"+e.message+" stack:"+e.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",o)).then(function(){alert(errormessage)})}}}]}]})}function ff(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(vi)}},sort:[{field:"WWStream",dir:"asc"},{field:"WWType",dir:"asc"},{field:"Category",dir:"asc"}],schema:{model:{id:"EMDataWWID",fields:{EMDataWWID:{hidden:!0},WWStream:{type:"string",editable:o.isEditable},EMWWUnit:{type:"number",validation:{maxlength:10},editable:o.isEditable},StandardUoM:{type:"string",editable:!1},UnitCost:{type:"number",editable:o.isEditable},WWType:{type:"string",editable:o.isEditable},Category:{type:"string",editable:o.isEditable},EMBasisOfEstimate:{type:"string",editable:o.isEditable}}}}});$("#gridCapsWaterWasteOpt2").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:{createAt:"bottom"},columns:[{field:"WWStream",title:"Water/Waste",headerAttributes:{"class":"wrap-header"},width:"15%",editor:rr,values:bt},{field:"WWType",title:"Type",headerAttributes:{"class":"wrap-header"},width:"15%",editor:ur,values:ci},{field:"Category",title:"Category",headerAttributes:{"class":"wrap-header"},width:"15%",editor:fr,values:li},{field:"EMWWUnit",title:"Units",editor:editNumber,width:"10%",format:"{0:n0}",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"},headerTemplate:'<div>Units<span title="Input gross change in emissions type here in the unit provided using whole numbers. Positive values for increase, negative values for decrease" class="k-icon k-i-question"><\/span><\/div>'},{field:"StandardUoM",title:"UoM",width:"10%"},{field:"EMBasisOfEstimate",title:"Basis of Estimate",width:"20%"},{hidden:!o.isEditable,width:"5%",command:[{name:" ",iconClass:"k-icon k-i-close",click:function(n){var r,t,u,o;try{confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t.EMDataWWID!="undefined"&&t.EMDataWWID!=""&&lr.push({EMDataWWID:t.EMDataWWID}),u=$("#gridCapsWaterWasteOpt2").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}catch(e){hideLoading();o={method:"InitKendoGridCapsWaterWasteOpt2",exceptionMessage:"message:"+e.message+" stack:"+e.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",o)).then(function(){alert(errormessage)})}}}]}]})}function ef(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(yi)}},sort:[{field:"WWStream",dir:"asc"},{field:"WWType",dir:"asc"},{field:"Category",dir:"asc"}],schema:{model:{id:"EMDataWWID",fields:{EMDataWWID:{hidden:!0},WWStream:{type:"string",editable:o.isEditable},EMWWUnit:{type:"number",validation:{maxlength:10},editable:o.isEditable},StandardUoM:{type:"string",editable:!1},UnitCost:{type:"number",editable:o.isEditable},WWType:{type:"string",editable:o.isEditable},Category:{type:"string",editable:o.isEditable},EMBasisOfEstimate:{type:"string",editable:o.isEditable}}}}});$("#gridCapsWaterWasteOpt3").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:{createAt:"bottom"},columns:[{field:"WWStream",title:"Water/Waste",headerAttributes:{"class":"wrap-header"},width:"15%",editor:rr,values:bt},{field:"WWType",title:"Type",headerAttributes:{"class":"wrap-header"},width:"15%",editor:ur,values:ci},{field:"Category",title:"Category",headerAttributes:{"class":"wrap-header"},width:"15%",editor:fr,values:li},{field:"EMWWUnit",title:"Units",editor:editNumber,width:"10%",format:"{0:n0}",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"},headerTemplate:'<div>Units<span title="Input gross change in emissions type here in the unit provided using whole numbers. Positive values for increase, negative values for decrease" class="k-icon k-i-question"><\/span><\/div>'},{field:"StandardUoM",title:"UoM",width:"10%"},{field:"EMBasisOfEstimate",title:"Basis of Estimate",width:"20%"},{hidden:!o.isEditable,width:"5%",command:[{name:" ",iconClass:"k-icon k-i-close",click:function(n){var r,t,u,o;try{confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t.EMDataWWID!="undefined"&&t.EMDataWWID!=""&&ar.push({EMDataWWID:t.EMDataWWID}),u=$("#gridCapsWaterWasteOpt3").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}catch(e){hideLoading();o={method:"InitKendoGridCapsWaterWasteOpt3",exceptionMessage:"message:"+e.message+" stack:"+e.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",o)).then(function(){alert(errormessage)})}}}]}]})}function rr(n,t){$('<input id="'+t.field+t.model.EMDataWWID+'" name="'+t.field+'"/>').appendTo(n).kendoComboBox({autoBind:!1,filter:"contains",valuePrimitive:!0,dataSource:bt,change:function(n){var i=n.sender.element.closest(".k-grid").data("kendoGrid"),r=n.sender.element.closest("tr"),t=i.dataItem(r),u=ut.filter(function(n){return n.WWStream==t.WWStream});t.Category="";t.WWType="";t.StandardUoM=u[0].StandardUoM;t.dirty=!0;i.refresh()}})}function ur(n,t){var i=t.model.WWStream,r=ut.filter(function(n){return n.WWStream==i}),u=Array.from(new Set(r.map(n=>n.WWType)));$('<input  id="'+t.field+t.model.EMDataWWID+'"name="'+t.field+'"/>').appendTo(n).kendoComboBox({autoBind:!1,filter:"contains",valuePrimitive:!0,dataSource:u,change:function(n){var t=n.sender.element.closest(".k-grid").data("kendoGrid"),r=n.sender.element.closest("tr"),i=t.dataItem(r);i.Category="";i.dirty=!0;t.refresh()}})}function fr(n,t){var i=t.model.WWStream,r=t.model.WWType,u=ut.filter(function(n){return n.WWStream==i&&n.WWType==r});$('<input  id="'+t.field+t.model.EMDataWWID+'" name="'+t.field+'"/>').appendTo(n).kendoComboBox({autoBind:!1,dataTextField:"Category",dataValueField:"WWSourceMasterUniqueID",template:"#:Category#",filter:"contains",valuePrimitive:!0,dataSource:u,change:function(n){var i=n.sender.element.closest(".k-grid").data("kendoGrid"),r=n.sender.element.closest("tr"),t=i.dataItem(r);t.WWSourceMasterUniqueID=n.sender.value();t.Category=n.sender.text()}})}function of(){var n=gf(),t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCScheduleOpt1)}},sort:[{field:"PlannedFinish",dir:"asc"}],batch:!0,schema:{model:{id:"BusinessScheduleUniqueID",fields:{BusinessScheduleUniqueID:{editable:!1,nullable:!0},Milestone:{type:"string",editable:o.isEditable},PlannedFinish:{type:"date",defaultValue:null,editable:o.isEditable},FunctionGroupID:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}});$("#gridBusinessCaseOptTimeline").kendoGrid({dataSource:t,columns:n,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".milestonechkbxOpt1").bind("change",function(n){var t=$("#gridBusinessCaseOptTimeline").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}})}function sf(){var n=[{field:"Milestone",title:"Milestone"},{field:"PlannedFinish",title:"Planned Finish (mm/dd/yyyy)",template:"#= PlannedFinish ==null ? '' : kendo.toString(kendo.parseDate(new Date(PlannedFinish), 'MM/dd/yyyy'), 'MM/dd/yyyy') #",headerAttributes:{"class":"wrap-header"},format:"{0:MM/dd/yyyy}"},{field:"FunctionGroupID",title:"Functional Owner",values:p,headerAttributes:{"class":"wrap-header"},editor:pt},{field:"BusinessScheduleUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 10)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input disabled="disabled" checked type="checkbox" class="milestonechkbxOpt2" />':s(n,"IncludeInCharter")+'<input disabled="disabled" type="checkbox" class="milestonechkbxOpt2" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input type="checkbox" checked class="milestonechkbxOpt2" />':s(n,"IncludeInCharter")+'<input type="checkbox" class="milestonechkbxOpt2" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessScheduleUniqueID!=undefined&&t.BusinessScheduleUniqueID!=""&&o.deletedMilestoneDataOption2.push({BusinessScheduleUniqueID:t.BusinessScheduleUniqueID}),u=$("#gridBusinessCaseOpt2Timeline").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}],t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCScheduleOpt2)}},batch:!0,sort:[{field:"PlannedFinish",dir:"asc"}],schema:{model:{id:"BusinessScheduleUniqueID",fields:{BusinessScheduleUniqueID:{editable:!1,nullable:!0},Milestone:{type:"string",editable:o.isEditable},PlannedFinish:{type:"date",defaultValue:null,editable:o.isEditable},FunctionGroupID:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}});$("#gridBusinessCaseOpt2Timeline").kendoGrid({dataSource:t,columns:n,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".milestonechkbxOpt2").bind("change",function(n){var t=$("#gridBusinessCaseOpt2Timeline").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}})}function hf(){var n=[{field:"Milestone",title:"Milestone"},{field:"PlannedFinish",title:"Planned Finish (mm/dd/yyyy)",template:"#= PlannedFinish ==null ? '' : kendo.toString(kendo.parseDate(new Date(PlannedFinish), 'MM/dd/yyyy'), 'MM/dd/yyyy') #",headerAttributes:{"class":"wrap-header"},format:"{0:MM/dd/yyyy}"},{field:"FunctionGroupID",title:"Functional Owner",values:p,headerAttributes:{"class":"wrap-header"},editor:pt},{field:"BusinessScheduleUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 10)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input disabled="disabled" checked type="checkbox" class="milestonechkbxOpt3" />':s(n,"IncludeInCharter")+'<input disabled="disabled" type="checkbox" class="milestonechkbxOpt3" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input type="checkbox" checked class="milestonechkbxOpt3" />':s(n,"IncludeInCharter")+'<input type="checkbox" class="milestonechkbxOpt3" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessScheduleUniqueID!=undefined&&t.BusinessScheduleUniqueID!=""&&o.deletedMilestoneDataOption3.push({BusinessScheduleUniqueID:t.BusinessScheduleUniqueID}),u=$("#gridBusinessCaseOpt3Timeline").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}],t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCScheduleOpt3)}},batch:!0,sort:[{field:"PlannedFinish",dir:"asc"}],schema:{model:{id:"BusinessScheduleUniqueID",fields:{BusinessScheduleUniqueID:{editable:!1,nullable:!0},Milestone:{type:"string",editable:o.isEditable},PlannedFinish:{type:"date",defaultValue:null,editable:o.isEditable},FunctionGroupID:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}});$("#gridBusinessCaseOpt3Timeline").kendoGrid({dataSource:t,columns:n,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".milestonechkbxOpt3").bind("change",function(n){var t=$("#gridBusinessCaseOpt3Timeline").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}})}function cf(){var n=[{field:"Metric",title:"Metric"},{field:"CurrentState",title:"Baseline"},{field:"TargetPerformance",title:"Target Performance"},{field:"BusinessKeySuccessUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 3)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input disabled="disabled" checked type="checkbox" class="successchkbxOpt1" />':s(n,"IncludeInCharter")+'<input disabled="disabled" type="checkbox" class="successchkbxOpt1" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input type="checkbox" checked class="successchkbxOpt1" />':s(n,"IncludeInCharter")+'<input type="checkbox" class="successchkbxOpt1" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessKeySuccessUniqueID!=undefined&&t.BusinessKeySuccessUniqueID!=""&&o.deletedKeySuccessData.push({BusinessKeySuccessUniqueID:t.BusinessKeySuccessUniqueID}),u=$("#gridBusinessCaseOptKeySuccessCriteria").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}],t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCKeySuccessOpt1)}},batch:!0,schema:{model:{id:"BusinessKeySuccessUniqueID",fields:{BusinessKeySuccessUniqueID:{editable:!1,nullable:!0},Metric:{type:"string",editable:o.isEditable},CurrentState:{type:"string",editable:o.isEditable},TargetPerformance:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}});$("#gridBusinessCaseOptKeySuccessCriteria").kendoGrid({dataSource:t,columns:n,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".successchkbxOpt1").bind("change",function(n){var t=$("#gridBusinessCaseOptKeySuccessCriteria").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}})}function lf(){var n=[{field:"Metric",title:"Metric"},{field:"CurrentState",title:"Baseline"},{field:"TargetPerformance",title:"Target Performance"},{field:"BusinessKeySuccessUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 3)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input disabled="disabled" checked type="checkbox" class="successchkbxOpt2" />':s(n,"IncludeInCharter")+'<input disabled="disabled" type="checkbox" class="successchkbxOpt2" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input type="checkbox" checked class="successchkbxOpt2" />':s(n,"IncludeInCharter")+'<input type="checkbox" class="successchkbxOpt2" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessKeySuccessUniqueID!=undefined&&t.BusinessKeySuccessUniqueID!=""&&o.deletedKeySuccessDataOption2.push({BusinessKeySuccessUniqueID:t.BusinessKeySuccessUniqueID}),u=$("#gridBusinessCaseOptKeySuccessCriteriaOption2").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}],t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCKeySuccessOpt2)}},batch:!0,schema:{model:{id:"BusinessKeySuccessUniqueID",fields:{BusinessKeySuccessUniqueID:{editable:!1,nullable:!0},Metric:{type:"string",editable:o.isEditable},CurrentState:{type:"string",editable:o.isEditable},TargetPerformance:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}});$("#gridBusinessCaseOptKeySuccessCriteriaOption2").kendoGrid({dataSource:t,columns:n,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".successchkbxOpt2").bind("change",function(n){var t=$("#gridBusinessCaseOptKeySuccessCriteriaOption2").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}})}function af(){var n=[{field:"Metric",title:"Metric"},{field:"CurrentState",title:"Baseline"},{field:"TargetPerformance",title:"Target Performance"},{field:"BusinessKeySuccessUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 3)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input disabled="disabled" checked type="checkbox" class="successchkbxOpt3" />':s(n,"IncludeInCharter")+'<input disabled="disabled" type="checkbox" class="successchkbxOpt3" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input type="checkbox" checked class="successchkbxOpt3" />':s(n,"IncludeInCharter")+'<input type="checkbox" class="successchkbxOpt3" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessKeySuccessUniqueID!=undefined&&t.BusinessKeySuccessUniqueID!=""&&o.deletedKeySuccessDataOption3.push({BusinessKeySuccessUniqueID:t.BusinessKeySuccessUniqueID}),u=$("#gridBusinessCaseOptKeySuccessCriteriaOption3").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}],t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCKeySuccessOpt3)}},batch:!0,schema:{model:{id:"BusinessKeySuccessUniqueID",fields:{BusinessKeySuccessUniqueID:{editable:!1,nullable:!0},Metric:{type:"string",editable:o.isEditable},CurrentState:{type:"string",editable:o.isEditable},TargetPerformance:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}});$("#gridBusinessCaseOptKeySuccessCriteriaOption3").kendoGrid({dataSource:t,columns:n,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".successchkbxOpt3").bind("change",function(n){var t=$("#gridBusinessCaseOptKeySuccessCriteriaOption3").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}})}function vf(){var r=[{field:"KeyAssumption",title:"Key Assumption"},{field:"AssumptionRationale",title:"Why Is This Assumption Valid?"},{field:"BusinessKeyAssumptionUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 4)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input disabled="disabled" checked type="checkbox" class="keyAssumptionchkbxOpt1" />':s(n,"IncludeInCharter")+'<input disabled="disabled" type="checkbox" class="keyAssumptionchkbxOpt1" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input type="checkbox" checked class="keyAssumptionchkbxOpt1" />':s(n,"IncludeInCharter")+'<input type="checkbox" class="keyAssumptionchkbxOpt1" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessKeyAssumptionUniqueID!=undefined&&t.BusinessKeyAssumptionUniqueID!=""&&o.deletedAssumptionData.push({BusinessKeyAssumptionUniqueID:t.BusinessKeyAssumptionUniqueID}),u=$("#gridBusinessCaseOptAssumption").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}],u=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCKeyAssumptionOpt1)}},batch:!0,schema:{model:{id:"BusinessKeyAssumptionUniqueID",fields:{BusinessKeyAssumptionUniqueID:{editable:!1,nullable:!0},KeyAssumption:{type:"string",editable:o.isEditable},AssumptionRationale:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}}),n,t;$("#gridBusinessCaseOptAssumption").kendoGrid({dataSource:u,columns:r,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".keyAssumptionchkbxOpt1").bind("change",function(n){var t=$("#gridBusinessCaseOptAssumption").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}});n=[{field:"IfHappens",title:"If This Happens",width:"20%"},{field:"ProbabilityID",title:"Probability",editor:gi,values:st,width:"10%"},{field:"RiskIssueResult",title:"This Is The Result",headerAttributes:{"class":"wrap-header"},width:"20%"},{field:"ImpactID",title:"Impact",values:ot,width:"10%",editor:di},{field:"Mitigation",title:"Details / Mitigation",headerAttributes:{"class":"wrap-header"},width:"10%"},{field:"FunctionGroupID",title:"Owner",values:p,width:"10%",editor:pt},{field:"RiskIssueTypeID",title:"Type",width:"10%",values:ct,editor:ki},{field:"BusinessRiskIssueUniqueID",title:"id",hidden:!0},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessRiskIssueUniqueID!=undefined&&t.BusinessRiskIssueUniqueID!=""&&o.deletedRiskData.push({BusinessRiskIssueUniqueID:t.BusinessRiskIssueUniqueID}),u=$("#gridBusinessCaseOptRisk").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}];t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCRiskIssueOpt1)}},batch:!0,schema:{model:{id:"BusinessRiskIssueUniqueID",fields:{BusinessRiskIssueUniqueID:{editable:!1,hidden:!0},IfHappens:{type:"string",editable:o.isEditable},ProbabilityID:{type:"string",editable:o.isEditable},RiskIssueResult:{type:"string",editable:o.isEditable},ImpactID:{type:"string",editable:o.isEditable},Mitigation:{type:"string",editable:o.isEditable},RiskIssueTypeID:{editable:o.isEditable},FunctionGroupID:{type:"string",editable:o.isEditable}}}}});$("#gridBusinessCaseOptRisk").kendoGrid({dataSource:t,selectable:!0,navigatable:!0,editable:{createAt:"bottom"},columns:n})}function yf(){var r=[{field:"KeyAssumption",title:"Key Assumption"},{field:"AssumptionRationale",title:"Why Is This Assumption Valid?"},{field:"BusinessKeyAssumptionUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 4)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input disabled="disabled" checked type="checkbox" class="keyAssumptionchkbxOpt2" />':s(n,"IncludeInCharter")+'<input disabled="disabled" type="checkbox" class="keyAssumptionchkbxOpt2" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input type="checkbox" checked class="keyAssumptionchkbxOpt2" />':s(n,"IncludeInCharter")+'<input type="checkbox" class="keyAssumptionchkbxOpt2" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessKeyAssumptionUniqueID!=undefined&&t.BusinessKeyAssumptionUniqueID!=""&&o.deletedAssumptionDataOption2.push({BusinessKeyAssumptionUniqueID:t.BusinessKeyAssumptionUniqueID}),u=$("#gridBusinessCaseOptAssumptionOption2").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}],u=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCKeyAssumptionOpt2)}},batch:!0,pageSize:20,schema:{model:{id:"BusinessKeyAssumptionUniqueID",fields:{BusinessKeyAssumptionUniqueID:{editable:!1,nullable:!0},KeyAssumption:{type:"string",editable:o.isEditable},AssumptionRationale:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}}),n,t;$("#gridBusinessCaseOptAssumptionOption2").kendoGrid({dataSource:u,columns:r,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".keyAssumptionchkbxOpt2").bind("change",function(n){var t=$("#gridBusinessCaseOptAssumptionOption2").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}});n=[{field:"IfHappens",title:"If This Happens",width:"20%"},{field:"ProbabilityID",title:"Probability",editor:gi,values:st,width:"10%"},{field:"RiskIssueResult",title:"This Is The Result",headerAttributes:{"class":"wrap-header"},width:"20%"},{field:"ImpactID",title:"Impact",values:ot,width:"10%",editor:di},{field:"Mitigation",title:"Details / Mitigation",headerAttributes:{"class":"wrap-header"},width:"10%"},{field:"FunctionGroupID",title:"Owner",values:p,width:"10%",editor:pt},{field:"RiskIssueTypeID",title:"Type",width:"10%",values:ct,editor:ki},{field:"BusinessRiskIssueUniqueID",title:"id",hidden:!0},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessRiskIssueUniqueID!=undefined&&t.BusinessRiskIssueUniqueID!=""&&o.deletedRiskDataOption2.push({BusinessRiskIssueUniqueID:t.BusinessRiskIssueUniqueID}),u=$("#gridBusinessCaseOptRiskOption2").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}];t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCRiskIssueOpt2)}},batch:!0,schema:{model:{id:"BusinessRiskIssueUniqueID",fields:{BusinessRiskIssueUniqueID:{editable:!1,hidden:!0},IfHappens:{type:"string",editable:o.isEditable},ProbabilityID:{type:"string",editable:o.isEditable},RiskIssueResult:{type:"string",editable:o.isEditable},ImpactID:{type:"string",editable:o.isEditable},Mitigation:{type:"string",editable:o.isEditable},RiskIssueTypeID:{editable:o.isEditable},FunctionGroupID:{type:"string",editable:o.isEditable}}}}});$("#gridBusinessCaseOptRiskOption2").kendoGrid({dataSource:t,selectable:!0,navigatable:!0,editable:{createAt:"bottom"},columns:n})}function pf(){var r=[{field:"KeyAssumption",title:"Key Assumption"},{field:"AssumptionRationale",title:"Why Is This Assumption Valid?"},{field:"BusinessKeyAssumptionUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 4)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input disabled="disabled" checked type="checkbox" class="keyAssumptionchkbxOpt3" />':s(n,"IncludeInCharter")+'<input disabled="disabled" type="checkbox" class="keyAssumptionchkbxOpt3" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input type="checkbox" checked class="keyAssumptionchkbxOpt3" />':s(n,"IncludeInCharter")+'<input type="checkbox" class="keyAssumptionchkbxOpt3" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessKeyAssumptionUniqueID!=undefined&&t.BusinessKeyAssumptionUniqueID!=""&&o.deletedAssumptionDataOption3.push({BusinessKeyAssumptionUniqueID:t.BusinessKeyAssumptionUniqueID}),u=$("#gridBusinessCaseOptAssumptionOption3").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}],u=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCKeyAssumptionOpt3)}},batch:!0,schema:{model:{id:"BusinessKeyAssumptionUniqueID",fields:{BusinessKeyAssumptionUniqueID:{editable:!1,nullable:!0},KeyAssumption:{type:"string",editable:o.isEditable},AssumptionRationale:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}}),n,t;$("#gridBusinessCaseOptAssumptionOption3").kendoGrid({dataSource:u,columns:r,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".keyAssumptionchkbxOpt3").bind("change",function(n){var t=$("#gridBusinessCaseOptAssumptionOption3").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}});n=[{field:"IfHappens",title:"If This Happens",width:"20%"},{field:"ProbabilityID",title:"Probability",editor:gi,values:st,width:"10%"},{field:"RiskIssueResult",title:"This Is The Result",headerAttributes:{"class":"wrap-header"},width:"20%"},{field:"ImpactID",title:"Impact",values:ot,width:"10%",editor:di},{field:"Mitigation",title:"Details / Mitigation",headerAttributes:{"class":"wrap-header"},width:"10%"},{field:"FunctionGroupID",title:"Owner",values:p,width:"10%",editor:pt},{field:"RiskIssueTypeID",title:"Type",width:"10%",values:ct,editor:ki},{field:"BusinessRiskIssueUniqueID",title:"id",hidden:!0},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessRiskIssueUniqueID!=undefined&&t.BusinessRiskIssueUniqueID!=""&&o.deletedRiskDataOption3.push({BusinessRiskIssueUniqueID:t.BusinessRiskIssueUniqueID}),u=$("#gridBusinessCaseOptRiskOption3").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}];t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCRiskIssueOpt3)}},batch:!0,schema:{model:{id:"BusinessRiskIssueUniqueID",fields:{BusinessRiskIssueUniqueID:{editable:!1,hidden:!0},IfHappens:{type:"string",editable:o.isEditable},ProbabilityID:{type:"string",editable:o.isEditable},RiskIssueResult:{type:"string",editable:o.isEditable},ImpactID:{type:"string",editable:o.isEditable},Mitigation:{type:"string",editable:o.isEditable},RiskIssueTypeID:{editable:o.isEditable},FunctionGroupID:{type:"string",editable:o.isEditable}}}}});$("#gridBusinessCaseOptRiskOption3").kendoGrid({dataSource:t,selectable:!0,navigatable:!0,editable:{createAt:"bottom"},columns:n})}function wf(){var n=df(),t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCBudgetFundingOpt1)}},batch:!0,schema:{model:{id:"BusinessFundingUniqueID",fields:{BusinessFundingUniqueID:{editable:!1,nullable:!0},FundingTypeID:{type:"string",editable:o.isEditable},FundingSourceID:{type:"string",editable:o.isEditable},FundingIntheplan:{type:"boolean",editable:o.isEditable},FundingAmount:{type:"number",validation:{min:0,maxlength:12},editable:o.isEditable},FundingNotes:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}});$("#gridBusinessCaseFunding").kendoGrid({dataSource:t,columns:n,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".funcdingchkbxOpt1").bind("change",function(n){var t=$("#gridBusinessCaseFunding").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}})}function bf(){var n=[{field:"FundingTypeID",title:"Funding Type",values:et,headerAttributes:{"class":"wrap-header"},editor:nr},{field:"FundingSourceID",title:"Funding Source",values:ht,headerAttributes:{"class":"wrap-header"},editor:ir},{field:"FundingIntheplan",title:"In the Plan",values:lt,headerAttributes:{"class":"wrap-header"},editor:tr},{field:"FundingAmount",title:"Amount "+o.localCurrencyAbbre,width:"15%",format:"{0:n0}",decimals:0,min:0,restrictDecimals:!0,attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"}},{field:"FundingNotes",title:"Notes"},{field:"BusinessFundingUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 2)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input disabled="disabled" checked type="checkbox" class="funcdingchkbxOpt2" />':s(n,"IncludeInCharter")+'<input disabled="disabled" type="checkbox" class="funcdingchkbxOpt2" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input type="checkbox" checked class="funcdingchkbxOpt2" />':s(n,"IncludeInCharter")+'<input type="checkbox" class="funcdingchkbxOpt2" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var t,r,u;confirm(gridDeleteMessage)?(n.preventDefault(),t=$(n.target).closest("tr"),r=this.dataItem(t),r.BusinessFundingUniqueID!=undefined&&o.deletedFundingDataOption2.push({BusinessFundingUniqueID:r.BusinessFundingUniqueID}),u=$("#gridBusinessCaseFundingOption2").data("kendoGrid"),u.removeRow(t),i.$digest()):n.preventDefault()}}]}],t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCBudgetFundingOpt2)}},batch:!0,schema:{model:{id:"BusinessFundingUniqueID",fields:{BusinessFundingUniqueID:{editable:!1,nullable:!0},FundingTypeID:{type:"string",editable:o.isEditable},FundingSourceID:{type:"string",editable:o.isEditable},FundingIntheplan:{type:"boolean",editable:o.isEditable},FundingAmount:{type:"number",validation:{min:0,maxlength:12},editable:o.isEditable},FundingNotes:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}});$("#gridBusinessCaseFundingOption2").kendoGrid({dataSource:t,columns:n,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".funcdingchkbxOpt2").bind("change",function(n){var t=$("#gridBusinessCaseFundingOption2").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}})}function kf(){var n=[{field:"FundingTypeID",title:"Funding Type",values:et,headerAttributes:{"class":"wrap-header"},editor:nr},{field:"FundingSourceID",title:"Funding Source",values:ht,headerAttributes:{"class":"wrap-header"},editor:ir},{field:"FundingIntheplan",title:"In the Plan",values:lt,headerAttributes:{"class":"wrap-header"},editor:tr},{field:"FundingAmount",title:"Amount "+o.localCurrencyAbbre,format:"{0:n0}",decimals:0,min:0,restrictDecimals:!0,attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"}},{field:"FundingNotes",title:"Notes"},{field:"BusinessFundingUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 2)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input disabled="disabled" checked type="checkbox" class="funcdingchkbxOpt3" />':s(n,"IncludeInCharter")+'<input disabled="disabled" type="checkbox" class="funcdingchkbxOpt3" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input type="checkbox" checked class="funcdingchkbxOpt3" />':s(n,"IncludeInCharter")+'<input type="checkbox" class="funcdingchkbxOpt3" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var t,r,u;confirm(gridDeleteMessage)?(n.preventDefault(),t=$(n.target).closest("tr"),r=this.dataItem(t),r.BusinessFundingUniqueID!=undefined&&o.deletedFundingDataOption3.push({BusinessFundingUniqueID:r.BusinessFundingUniqueID}),u=$("#gridBusinessCaseFundingOption3").data("kendoGrid"),u.removeRow(t),i.$digest()):n.preventDefault()}}]}],t=new kendo.data.DataSource({transport:{read:function(n){n.success(o.dsBCBudgetFundingOpt3)}},batch:!0,schema:{model:{id:"BusinessFundingUniqueID",fields:{BusinessFundingUniqueID:{editable:!1,nullable:!0},FundingTypeID:{type:"string",editable:o.isEditable},FundingSourceID:{type:"string",editable:o.isEditable},FundingIntheplan:{type:"boolean",editable:o.isEditable},FundingAmount:{type:"number",validation:{min:0,maxlength:12},editable:o.isEditable},FundingNotes:{type:"string",editable:o.isEditable},IncludeInBusinessCase:{type:"boolean",editable:o.isEditable}}}}});$("#gridBusinessCaseFundingOption3").kendoGrid({dataSource:t,columns:n,navigatable:!0,editable:{createAt:"bottom"},dataBound:function(){$(".funcdingchkbxOpt3").bind("change",function(n){var t=$("#gridBusinessCaseFundingOption3").data("kendoGrid"),i=t.dataItem($(n.target).closest("tr")),r=n.target.closest("td");$(r).prepend("<span class='k-dirty'><\/span>");i.set("IncludeInBusinessCase",this.checked)})}})}function df(){return[{field:"FundingTypeID",title:"Funding Type",values:et,headerAttributes:{"class":"wrap-header"},editor:nr},{field:"FundingSourceID",title:"Funding Source",values:ht,headerAttributes:{"class":"wrap-header"},editor:ir},{field:"FundingIntheplan",title:"In the Plan",values:lt,headerAttributes:{"class":"wrap-header"},editor:tr},{field:"FundingAmount",title:"Amount "+o.localCurrencyAbbre,format:"{0:n0}",decimals:0,min:0,restrictDecimals:!0,attributes:{"class":"txt-float-R"},headerAttributes:{"class":"wrap-header align-right"}},{field:"FundingNotes",title:"Notes"},{field:"BusinessFundingUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 2)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInBusinessCase")+'<input disabled="disabled" checked type="checkbox" class="funcdingchkbxOpt1" />':s(n,"IncludeInBusinessCase")+'<input disabled="disabled" type="checkbox" class="funcdingchkbxOpt1" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInBusinessCase")+'<input type="checkbox" checked class="funcdingchkbxOpt1" />':s(n,"IncludeInBusinessCase")+'<input type="checkbox" class="funcdingchkbxOpt1" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var t,r,u;confirm(gridDeleteMessage)?(n.preventDefault(),t=$(n.target).closest("tr"),r=this.dataItem(t),r.BusinessFundingUniqueID!=undefined&&o.deletedFundingData.push({BusinessFundingUniqueID:r.BusinessFundingUniqueID}),u=$("#gridBusinessCaseFunding").data("kendoGrid"),u.removeRow(t),i.$digest()):n.preventDefault()}}]}]}function gf(){return[{field:"Milestone",title:"Milestone"},{field:"PlannedFinish",title:"Planned Finish (mm/dd/yyyy)",template:"#= PlannedFinish ==null ? '' : kendo.toString(kendo.parseDate(new Date(PlannedFinish), 'MM/dd/yyyy'), 'MM/dd/yyyy') #",headerAttributes:{"class":"wrap-header"},format:"{0:MM/dd/yyyy}"},{field:"FunctionGroupID",title:"Functional Owner",values:p,headerAttributes:{"class":"wrap-header"},editor:pt},{field:"BusinessScheduleUniqueID",title:"id",hidden:!0},{title:"Include in Business Case (Max 10)",headerAttributes:{"class":"wrap-header"},template:function(n){return o.isEditable==!1?n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input disabled="disabled" checked type="checkbox" class="milestonechkbxOpt1" />':s(n,"IncludeInCharter")+'<input disabled="disabled" type="checkbox" class="milestonechkbxOpt1" />':n.IncludeInBusinessCase==!0?s(n,"IncludeInCharter")+'<input type="checkbox" checked class="milestonechkbxOpt1" />':s(n,"IncludeInCharter")+'<input type="checkbox" class="milestonechkbxOpt1" />'}},{hidden:!o.isEditable,command:[{name:" ",iconClass:"k-icon k-i-close",width:"5%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.BusinessScheduleUniqueID!=undefined&&t.BusinessScheduleUniqueID!=""&&o.deletedMilestoneData.push({BusinessScheduleUniqueID:t.BusinessScheduleUniqueID}),u=$("#gridBusinessCaseOptTimeline").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}]}function ne(){return o.businessOptionInfoSelector.DurationBaseCase!=null&&o.businessOptionInfoSelector.DurationHighCase!=null&&o.businessOptionInfoSelector.DurationBaseCase!=""&&o.businessOptionInfoSelector.DurationHighCase!=""&&parseFloat(o.businessOptionInfoSelector.DurationBaseCase)>parseFloat(o.businessOptionInfoSelector.DurationHighCase)?!1:o.businessOptionInfoSelector.PeopleFTEMonthsRequiredBaseCase!=null&&o.businessOptionInfoSelector.PeopleFTEMonthsRequiredHighCase!=null&&o.businessOptionInfoSelector.PeopleFTEMonthsRequiredBaseCase!=""&&o.businessOptionInfoSelector.PeopleFTEMonthsRequiredHighCase!=""&&o.businessOptionInfoSelector.PeopleFTEMonthsRequiredBaseCase>o.businessOptionInfoSelector.PeopleFTEMonthsRequiredHighCase||o.businessOptionInfoSelector.TotalCapexBaseCase!=null&&o.businessOptionInfoSelector.TotalCapexHighCase!=null&&o.businessOptionInfoSelector.TotalCapexBaseCase!=""&&o.businessOptionInfoSelector.TotalCapexHighCase!=""&&o.businessOptionInfoSelector.TotalCapexBaseCase>o.businessOptionInfoSelector.TotalCapexHighCase||o.businessOptionInfoSelector.TotalNonFTEBaseCase!=null&&o.businessOptionInfoSelector.TotalNonFTEHighCase!=null&&o.businessOptionInfoSelector.TotalNonFTEBaseCase!=""&&o.businessOptionInfoSelector.TotalNonFTEHighCase!=""&&o.businessOptionInfoSelector.TotalNonFTEBaseCase>o.businessOptionInfoSelector.TotalNonFTEHighCase||o.businessOptionInfoSelector.NPVBaseCase!=null&&o.businessOptionInfoSelector.NPVHighCase!=null&&o.businessOptionInfoSelector.NPVBaseCase!=""&&o.businessOptionInfoSelector.NPVHighCase!=""&&parseFloat(o.businessOptionInfoSelector.NPVBaseCase)>parseFloat(o.businessOptionInfoSelector.NPVHighCase)||o.businessOption2InfoSelector.DurationBaseCase!=null&&o.businessOption2InfoSelector.DurationHighCase!=null&&o.businessOption2InfoSelector.DurationBaseCase!=""&&o.businessOption2InfoSelector.DurationHighCase!=""&&parseFloat(o.businessOption2InfoSelector.DurationBaseCase)>parseFloat(o.businessOption2InfoSelector.DurationHighCase)||o.businessOption2InfoSelector.PeopleFTEMonthsRequiredBaseCase!=null&&o.businessOption2InfoSelector.PeopleFTEMonthsRequiredHighCase!=null&&o.businessOption2InfoSelector.PeopleFTEMonthsRequiredBaseCase!=""&&o.businessOption2InfoSelector.PeopleFTEMonthsRequiredHighCase!=""&&o.businessOption2InfoSelector.PeopleFTEMonthsRequiredBaseCase>o.businessOption2InfoSelector.PeopleFTEMonthsRequiredHighCase||o.businessOptionInfoSelector.TotalCapexBaseCase!=null&&o.businessOption2InfoSelector.TotalCapexHighCase!=null&&o.businessOption2InfoSelector.TotalCapexBaseCase!=""&&o.businessOption2InfoSelector.TotalCapexHighCase!=""&&o.businessOption2InfoSelector.TotalCapexBaseCase>o.businessOption2InfoSelector.TotalCapexHighCase||o.businessOption2InfoSelector.TotalNonFTEBaseCase!=null&&o.businessOption2InfoSelector.TotalNonFTEHighCase!=null&&o.businessOption2InfoSelector.TotalNonFTEBaseCase!=""&&o.businessOption2InfoSelector.TotalNonFTEHighCase!=""&&o.businessOption2InfoSelector.TotalNonFTEBaseCase>o.businessOption2InfoSelector.TotalNonFTEHighCase||o.businessOption2InfoSelector.NPVBaseCase!=null&&o.businessOption2InfoSelector.NPVHighCase!=null&&o.businessOption2InfoSelector.NPVBaseCase!=""&&o.businessOption2InfoSelector.NPVHighCase!=""&&o.businessOption2InfoSelector.NPVBaseCase>o.businessOption2InfoSelector.NPVHighCase||o.businessOption3InfoSelector.DurationBaseCase!=null&&o.businessOption3InfoSelector.DurationHighCase!=null&&o.businessOption3InfoSelector.DurationBaseCase!=""&&o.businessOption3InfoSelector.DurationHighCase!=""&&o.businessOption3InfoSelector.DurationBaseCase>o.businessOption3InfoSelector.DurationHighCase||o.businessOption3InfoSelector.PeopleFTEMonthsRequiredBaseCase!=null&&o.businessOption3InfoSelector.PeopleFTEMonthsRequiredHighCase!=null&&o.businessOption3InfoSelector.PeopleFTEMonthsRequiredBaseCase!=""&&o.businessOption3InfoSelector.PeopleFTEMonthsRequiredHighCase!=""&&o.businessOption3InfoSelector.PeopleFTEMonthsRequiredBaseCase>o.businessOption3InfoSelector.PeopleFTEMonthsRequiredHighCase||o.businessOption3InfoSelector.TotalCapexBaseCase!=null&&o.businessOption3InfoSelector.TotalCapexHighCase!=null&&o.businessOption3InfoSelector.TotalCapexBaseCase!=""&&o.businessOption3InfoSelector.TotalCapexHighCase!=""&&o.businessOption3InfoSelector.TotalCapexBaseCase>o.businessOption3InfoSelector.TotalCapexHighCase||o.businessOption3InfoSelector.TotalNonFTEBaseCase!=null&&o.businessOption3InfoSelector.TotalNonFTEHighCase!=null&&o.businessOption3InfoSelector.TotalNonFTEBaseCase!=""&&o.businessOption3InfoSelector.TotalNonFTEHighCase!=""&&o.businessOption3InfoSelector.TotalNonFTEBaseCase>o.businessOption3InfoSelector.TotalNonFTEHighCase||o.businessOption3InfoSelector.NPVBaseCase!=null&&o.businessOption3InfoSelector.NPVHighCase!=null&&o.businessOption3InfoSelector.NPVBaseCase!=""&&o.businessOption3InfoSelector.NPVHighCase!=""&&o.businessOption3InfoSelector.NPVBaseCase>o.businessOption3InfoSelector.NPVHighCase?!1:void 0}function te(){var l=$("#gridBusinessCaseOptTimeline").data("kendoGrid").tbody.find("input:checked").length,n,t,i,r,u,f,e,o,s,h,c;return l>milestoneBusinessCount?(alert(timelineCountMessageOpt1),hideLoading(),!1):(n=$("#gridBusinessCaseOpt2Timeline").data("kendoGrid").tbody.find("input:checked").length,n>milestoneBusinessCount)?(alert(timelineCountMessageOpt2),hideLoading(),!1):(t=$("#gridBusinessCaseOpt3Timeline").data("kendoGrid").tbody.find("input:checked").length,t>milestoneBusinessCount)?(alert(timelineCountMessageOpt3),hideLoading(),!1):(i=$("#gridBusinessCaseOptKeySuccessCriteria").data("kendoGrid").tbody.find("input:checked").length,i>keySuccessBusinessCount)?(alert(keySuccessCountMessageOpt1),hideLoading(),!1):(r=$("#gridBusinessCaseOptKeySuccessCriteriaOption2").data("kendoGrid").tbody.find("input:checked").length,r>keySuccessBusinessCount)?(alert(keySuccessCountMessageOpt2),hideLoading(),!1):(u=$("#gridBusinessCaseOptKeySuccessCriteriaOption3").data("kendoGrid").tbody.find("input:checked").length,u>keySuccessBusinessCount)?(alert(keySuccessCountMessageOpt3),hideLoading(),!1):(f=$("#gridBusinessCaseFunding").data("kendoGrid").tbody.find("input:checked").length,f>fundingBusinessCount)?(alert(FundingCountMessageOpt1),hideLoading(),!1):(e=$("#gridBusinessCaseFundingOption2").data("kendoGrid").tbody.find("input:checked").length,e>fundingBusinessCount)?(alert(FundingCountMessageOpt2),hideLoading(),!1):(o=$("#gridBusinessCaseFundingOption3").data("kendoGrid").tbody.find("input:checked").length,o>fundingBusinessCount)?(alert(FundingCountMessageOpt3),hideLoading(),!1):(s=$("#gridBusinessCaseOptAssumption").data("kendoGrid").tbody.find("input:checked").length,s>keyAssumptionBusinessCount)?(alert(keyAssumptionCountMessageOpt1),hideLoading(),!1):(h=$("#gridBusinessCaseOptAssumptionOption2").data("kendoGrid").tbody.find("input:checked").length,h>keyAssumptionBusinessCount)?(alert(keyAssumptionCountMessageOpt2),hideLoading(),!1):(c=$("#gridBusinessCaseOptAssumptionOption3").data("kendoGrid").tbody.find("input:checked").length,c>keyAssumptionBusinessCount?(alert(keyAssumptionCountMessageOpt3),hideLoading(),!1):void 0)}function ie(){var d,fr,g,br,nt,iu,yf,e,s,h,a,p,w;displayLoading();var tt=[],it=[],rt=[],ut=[],ft=[],et=[],ot=[];o.milestoneInsertListItems=[];o.milestoneUpdateListItems=[];o.riskInsertListItems=[];o.riskUpdateListItems=[];o.keySuccessInsertListItems=[];o.keySuccessUpdateListItems=[];o.assumptionInsertListItems=[];o.assumptionUpdateListItems=[];o.fundindInsertListItems=[];o.fundindUpdateListItems=[];var st=[],ht=[],ct=[],lt=[],at=[],vt=[],yt=[],pt=[];o.milestoneInsertListItemsOpt2=[];o.milestoneUpdateListItemsOpt2=[];o.riskInsertListItemsOpt2=[];o.riskUpdateListItemsOpt2=[];o.keySuccessInsertListItemsOpt2=[];o.keySuccessUpdateListItemsOpt2=[];o.assumptionInsertListItemsOpt2=[];o.assumptionUpdateListItemsOpt2=[];o.fundindInsertListItemsOpt2=[];o.fundindUpdateListItemsOpt2=[];var wt=[],bt=[],kt=[],dt=[],gt=[],ni=[],ti=[];o.milestoneInsertListItemsOpt3=[];o.milestoneUpdateListItemsOpt3=[];o.riskInsertListItemsOpt3=[];o.riskUpdateListItemsOpt3=[];o.keySuccessInsertListItemsOpt3=[];o.keySuccessUpdateListItemsOpt3=[];o.assumptionInsertListItemsOpt3=[];o.assumptionUpdateListItemsOpt3=[];o.fundindInsertListItemsOpt3=[];o.fundindUpdateListItemsOpt3=[];o.capsGridOpt1=[];o.capsGridOpt2=[];o.capsGridOpt3=[];var t=!0,ii=o.businessOptionInfoSelector.ExecutionStartDate!=null&&o.businessOptionInfoSelector.ExecutionStartDate!=""?$("#executionStart").val():null,ri=o.businessOptionInfoSelector.ExecutionEndDate!=null&&o.businessOptionInfoSelector.ExecutionEndDate!=""?$("#executionEnd").val():null,ui=o.businessOptionInfoSelector.AssetInService!=null&&o.businessOptionInfoSelector.AssetInService!=""?$("#assetDate").val():null,fi=o.businessOptionInfoSelector.ProjectSpendStart!=null&&o.businessOptionInfoSelector.ProjectSpendStart!=""?$("#spendDate").val():null,ei=o.businessOptionInfoSelector.EmissionsImpactRealizationDate!=null&&o.businessOptionInfoSelector.EmissionsImpactRealizationDate!=""?$("#realizationDate1").val():null;ii!=null&&(parseDate(ii)?o.executionStartOpt1DateError=!1:(t=!1,o.executionStartOpt1DateError=!0));ri!=null&&(parseDate(ri)?o.executionEndOpt1DateError=!1:(t=!1,o.executionEndOpt1DateError=!0));ui!=null&&(parseDate(ui)?o.AssetInServiceOpt1DateError=!1:(t=!1,o.AssetInServiceOpt1DateError=!0));fi!=null&&(parseDate(fi)?o.ProjectSpendStartOpt1DateError=!1:(t=!1,o.ProjectSpendStartOpt1DateError=!0));ei!=null&&(parseDate(ei)?o.BCRealizationDate1=!1:(t=!1,o.BCRealizationDate1=!0));var ci=o.businessOption2InfoSelector.ExecutionStartDate!=null&&o.businessOption2InfoSelector.ExecutionStartDate!=""?$("#executionStartOpt2").val():null,li=o.businessOption2InfoSelector.ExecutionEndDate!=null&&o.businessOption2InfoSelector.ExecutionEndDate!=""?$("#executionEndOpt2").val():null,ai=o.businessOption2InfoSelector.AssetInService!=null&&o.businessOption2InfoSelector.AssetInService!=""?$("#assetDateOpt2").val():null,vi=o.businessOption2InfoSelector.ProjectSpendStart!=null&&o.businessOption2InfoSelector.ProjectSpendStart!=""?$("#spendDateOpt2").val():null,yi=o.businessOption2InfoSelector.EmissionsImpactRealizationDate!=null&&o.businessOption2InfoSelector.EmissionsImpactRealizationDate!=""?$("#realizationDate2").val():null;ci!=null&&(parseDate(ci)?o.executionStartOpt2DateError=!1:(t=!1,o.executionStartOpt2DateError=!0));li!=null&&(parseDate(li)?o.executionEndOpt2DateError=!1:(t=!1,o.executionEndOpt2DateError=!0));ai!=null&&(parseDate(ai)?o.AssetInServiceOpt2DateError=!1:(t=!1,o.AssetInServiceOpt2DateError=!0));vi!=null&&(parseDate(vi)?o.ProjectSpendStartOpt2DateError=!1:(t=!1,o.ProjectSpendStartOpt2DateError=!0));yi!=null&&(parseDate(yi)?o.BCRealizationDate2=!1:(t=!1,o.BCRealizationDate2=!0));var wi=o.businessOption3InfoSelector.ExecutionStartDate!=null&&o.businessOption3InfoSelector.ExecutionStartDate!=""?$("#executionStartOpt3").val():null,bi=o.businessOption3InfoSelector.ExecutionEndDate!=null&&o.businessOption3InfoSelector.ExecutionEndDate!=""?$("#executionEndOpt3").val():null,ki=o.businessOption3InfoSelector.AssetInService!=null&&o.businessOption3InfoSelector.AssetInService!=""?$("#assetDateOpt3").val():null,di=o.businessOption3InfoSelector.ProjectSpendStart!=null&&o.businessOption3InfoSelector.ProjectSpendStart!=""?$("#spendDateOpt3").val():null,gi=o.businessOption3InfoSelector.EmissionsImpactRealizationDate!=null&&o.businessOption3InfoSelector.EmissionsImpactRealizationDate!=""?$("#realizationDate3").val():null,nr=o.SelectedProject.ApprovedDate!=null&&o.SelectedProject.ApprovedDate!=""?$("#BC_approvedDate").val():null;if(wi!=null&&(parseDate(wi)?o.executionStartOpt3DateError=!1:(t=!1,o.executionStartOpt3DateError=!0)),bi!=null&&(parseDate(bi)?o.executionEndOpt3DateError=!1:(t=!1,o.executionEndOpt3DateError=!0)),ki!=null&&(parseDate(ki)?o.AssetInServiceOpt3DateError=!1:(t=!1,o.AssetInServiceOpt3DateError=!0)),di!=null&&(parseDate(di)?o.ProjectSpendStartOpt3DateError=!1:(t=!1,o.ProjectSpendStartOpt3DateError=!0)),gi!=null&&(parseDate(gi)?o.BCRealizationDate3=!1:(t=!1,o.BCRealizationDate3=!0)),nr!=null&&(parseDate(nr)?o.bcApprovedDateError=!1:(t=!1,o.bcApprovedDateError=!0)),ne()==!1&&(alert(errorBaseCaseHighCase),t=!1),te()==!1&&(t=!1),$("#gridCapsWaterWasteOpt1").data("kendoGrid")!=undefined){var r=[],u=[],i=$("#gridCapsWaterWasteOpt1").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),b=i.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),k=i.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(b,function(n){if((n.WWStream==null||n.WWType==null||n.Category==null||n.WWStream==""||n.WWType==""||n.Category=="")&&t==!0){t=!1;alert(waterWasteErrorMsg);return}var i={};i.EMDataWWID=n.EMDataWWID;i.WWSourceMasterUniqueID=n.WWSourceMasterUniqueID;i.WWStream=n.WWStream;i.WWType=n.WWType;i.Category=n.Category;i.EMWWUnit=n.EMWWUnit;i.StandardUoM=n.StandardUoM;i.UnitCost=n.UnitCost;i.EMBasisOfEstimate=n.EMBasisOfEstimate;r.push(i)});angular.forEach(k,function(n){var i={};if((n.WWStream==null||n.WWType==null||n.Category==null||n.WWStream==""||n.WWType==""||n.Category=="")&&t==!0){t=!1;alert(waterWasteErrorMsg);return}t!=!1&&(i.EMDataWWID=n.EMDataWWID,i.WWSourceMasterUniqueID=n.WWSourceMasterUniqueID,i.WWStream=n.WWStream,i.WWType=n.WWType,i.Category=n.Category,i.EMWWUnit=n.EMWWUnit,i.StandardUoM=n.StandardUoM,i.UnitCost=n.UnitCost,i.EMBasisOfEstimate=n.EMBasisOfEstimate,u.push(i))});o.insertUpdateDeleteWaterWasteOpt1={insert:r,update:u,"delete":cr}}if($("#gridCapsWaterWasteOpt2").data("kendoGrid")!=undefined){var r=[],u=[],i=$("#gridCapsWaterWasteOpt2").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),b=i.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),k=i.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(b,function(n){var i={};if((n.WWStream==null||n.WWType==null||n.Category==null||n.WWStream==""||n.WWType==""||n.Category=="")&&t==!0){t=!1;alert(waterWasteErrorMsg);return}i.EMDataWWID=n.EMDataWWID;i.WWSourceMasterUniqueID=n.WWSourceMasterUniqueID;i.WWStream=n.WWStream;i.WWType=n.WWType;i.Category=n.Category;i.EMWWUnit=n.EMWWUnit;i.StandardUoM=n.StandardUoM;i.UnitCost=n.UnitCost;i.EMBasisOfEstimate=n.EMBasisOfEstimate;r.push(i)});angular.forEach(k,function(n){var i={};if((n.WWStream==null||n.WWType==null||n.Category==null||n.WWStream==""||n.WWType==""||n.Category=="")&&t==!0){t=!1;alert(waterWasteErrorMsg);return}i.EMDataWWID=n.EMDataWWID;i.WWSourceMasterUniqueID=n.WWSourceMasterUniqueID;i.WWStream=n.WWStream;i.WWType=n.WWType;i.Category=n.Category;i.EMWWUnit=n.EMWWUnit;i.StandardUoM=n.StandardUoM;i.UnitCost=n.UnitCost;i.EMBasisOfEstimate=n.EMBasisOfEstimate;u.push(i)});o.insertUpdateDeleteWaterWasteOpt2={insert:r,update:u,"delete":lr}}if($("#gridCapsWaterWasteOpt3").data("kendoGrid")!=undefined){var r=[],u=[],i=$("#gridCapsWaterWasteOpt3").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),b=i.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),k=i.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(b,function(n){var i={};if((n.WWStream==null||n.WWType==null||n.Category==null||n.WWStream==""||n.WWType==""||n.Category=="")&&t==!0){t=!1;alert(waterWasteErrorMsg);return}i.EMDataWWID=n.EMDataWWID;i.WWSourceMasterUniqueID=n.WWSourceMasterUniqueID;i.WWStream=n.WWStream;i.WWType=n.WWType;i.Category=n.Category;i.EMWWUnit=n.EMWWUnit;i.StandardUoM=n.StandardUoM;i.UnitCost=n.UnitCost;i.EMBasisOfEstimate=n.EMBasisOfEstimate;r.push(i)});angular.forEach(k,function(n){var i={};if((n.WWStream==null||n.WWType==null||n.Category==null||n.WWStream==""||n.WWType==""||n.Category=="")&&t==!0){t=!1;alert(waterWasteErrorMsg);return}i.EMDataWWID=n.EMDataWWID;i.WWSourceMasterUniqueID=n.WWSourceMasterUniqueID;i.WWStream=n.WWStream;i.WWType=n.WWType;i.Category=n.Category;i.EMWWUnit=n.EMWWUnit;i.StandardUoM=n.StandardUoM;i.UnitCost=n.UnitCost;i.EMBasisOfEstimate=n.EMBasisOfEstimate;u.push(i)});o.insertUpdateDeleteWaterWasteOpt3={insert:r,update:u,"delete":ar}}if(!t){hideLoading();return}if($("#gridBusinessCaseOptTimeline").data("kendoGrid")!=undefined){var i=$("#gridBusinessCaseOptTimeline").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),ru=i.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),uu=i.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(ru,function(n){var t={};t.BusinessScheduleUniqueID=n.BusinessScheduleUniqueID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.Milestone=n.Milestone;t.PlannedFinish=kendo.toString(n.PlannedFinish,"d");t.FunctionGroupID=n.FunctionGroupID;o.milestoneInsertListItems.push(t)});angular.forEach(uu,function(n){var t={};t.BusinessScheduleUniqueID=n.BusinessScheduleUniqueID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.Milestone=n.Milestone;t.PlannedFinish=kendo.toString(n.PlannedFinish,"d");t.FunctionGroupID=n.FunctionGroupID;c.length>0&&(t.MilestoneTemplateID=n.MilestoneTemplateID,t.MilestoneID=n.MilestoneID,t.IncludeInBusinessCase=n.IncludeInBusinessCase,t.Comments=n.Comments);o.milestoneUpdateListItems.push(t)});o.insertUpdateDeleteMilestone={insert:o.milestoneInsertListItems,update:o.milestoneUpdateListItems,"delete":o.deletedMilestoneData}}if($("#gridBusinessCaseOptRisk").data("kendoGrid")!=undefined){var tr=$("#gridBusinessCaseOptRisk").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),fu=tr.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),eu=tr.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(fu,function(n){var t={};t.BusinessRiskIssueUniqueID=n.BusinessRiskIssueUniqueID;t.IfHappens=n.IfHappens;t.RiskIssueResult=n.RiskIssueResult;t.Mitigation=n.Mitigation;t.RiskIssueTypeID=n.RiskIssueTypeID;t.ProbabilityID=n.ProbabilityID;t.ImpactID=n.ImpactID;t.FunctionGroupID=n.FunctionGroupID;o.riskInsertListItems.push(t)});angular.forEach(eu,function(n){var t={};t.BusinessRiskIssueUniqueID=n.BusinessRiskIssueUniqueID;t.IfHappens=n.IfHappens;t.RiskIssueResult=n.RiskIssueResult;t.Mitigation=n.Mitigation;t.RiskIssueTypeID=n.RiskIssueTypeID;t.ProbabilityID=n.ProbabilityID;t.ImpactID=n.ImpactID;t.FunctionGroupID=n.FunctionGroupID;o.riskUpdateListItems.push(t)});o.insertUpdateDeleteRisk={insert:o.riskInsertListItems,update:o.riskUpdateListItems,"delete":o.deletedRiskData}}if($("#gridBusinessCaseOptAssumption").data("kendoGrid")!=undefined){var ir=$("#gridBusinessCaseOptAssumption").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),ou=ir.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),su=ir.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(ou,function(n){var t={};t.BusinessKeyAssumptionUniqueID="";t.KeyAssumption=n.KeyAssumption;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.AssumptionRationale=n.AssumptionRationale;o.assumptionInsertListItems.push(t)});angular.forEach(su,function(n){var t={};t.BusinessKeyAssumptionUniqueID=n.BusinessKeyAssumptionUniqueID;t.KeyAssumption=n.KeyAssumption;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.AssumptionRationale=n.AssumptionRationale;o.assumptionUpdateListItems.push(t)});o.insertUpdateDeleteAssumption={insert:o.assumptionInsertListItems,update:o.assumptionUpdateListItems,"delete":o.deletedAssumptionData}}if($("#gridBusinessCaseFunding").data("kendoGrid")!=undefined){var rr=$("#gridBusinessCaseFunding").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),hu=rr.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),cu=rr.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(hu,function(n){var t={};t.BusinessFundingUniqueID=n.BusinessFundingUniqueID;t.FundingTypeID=n.FundingTypeID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.FundingSourceID=n.FundingSourceID;t.FundingIntheplan=n.FundingIntheplan;t.FundingAmount=n.FundingAmount;t.FundingNotes=n.FundingNotes;o.fundindInsertListItems.push(t)});angular.forEach(cu,function(n){var t={};t.BusinessFundingUniqueID=n.BusinessFundingUniqueID;t.FundingTypeID=n.FundingTypeID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.FundingSourceID=n.FundingSourceID;t.FundingIntheplan=n.FundingIntheplan;t.FundingAmount=n.FundingAmount;t.FundingNotes=n.FundingNotes;o.fundindUpdateListItems.push(t)});o.insertUpdateDeleteFunding={insert:o.fundindInsertListItems,update:o.fundindUpdateListItems,"delete":o.deletedFundingData}}if($("#gridBusinessCaseOptKeySuccessCriteria").data("kendoGrid")!=undefined){var ur=$("#gridBusinessCaseOptKeySuccessCriteria").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),lu=ur.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),au=ur.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(lu,function(n){var t={};t.BusinessKeySuccessUniqueID=n.BusinessKeySuccessUniqueID;t.Metric=n.Metric;t.CurrentState=n.CurrentState;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.TargetPerformance=n.TargetPerformance;o.keySuccessInsertListItems.push(t)});angular.forEach(au,function(n){var t={};t.BusinessKeySuccessUniqueID=n.BusinessKeySuccessUniqueID;t.Metric=n.Metric;t.CurrentState=n.CurrentState;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.TargetPerformance=n.TargetPerformance;o.keySuccessUpdateListItems.push(t)});o.insertUpdateDeleteKeySuccess={insert:o.keySuccessInsertListItems,update:o.keySuccessUpdateListItems,"delete":o.deletedKeySuccessData}}if($("#gridCapsOpt1").data("kendoGrid")!=undefined&&(d={},fr=$("#gridCapsOpt1").data("kendoGrid").dataSource.data().map(function(n){return n}),angular.forEach(fr,function(n){d={EMSourceID:n.EMSourceID,EMSourceName:n.EMSourceName,EMUnit:n.EMUnit,UnitOfMeasure:n.UnitOfMeasure,EMBasisOfEstimate:n.EMBasisOfEstimate,EMFactorImpact:n.EMFactorImpact};o.capsGridOpt1.push(d)})),$("#gridBusinessCaseOpt2Timeline").data("kendoGrid")!=undefined){var sr=$("#gridBusinessCaseOpt2Timeline").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),vu=sr.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),yu=sr.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(vu,function(n){var t={};t.BusinessScheduleUniqueID=n.BusinessScheduleUniqueID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.Milestone=n.Milestone;t.PlannedFinish=kendo.toString(n.PlannedFinish,"d");t.FunctionGroupID=n.FunctionGroupID;o.milestoneInsertListItemsOpt2.push(t)});angular.forEach(yu,function(n){var t={};t.BusinessScheduleUniqueID=n.BusinessScheduleUniqueID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.Milestone=n.Milestone;t.PlannedFinish=kendo.toString(n.PlannedFinish,"d");t.FunctionGroupID=n.FunctionGroupID;v.length>0&&(t.MilestoneTemplateID=n.MilestoneTemplateID,t.MilestoneID=n.MilestoneID,t.IncludeInBusinessCase=n.IncludeInBusinessCase,t.Comments=n.Comments);o.milestoneUpdateListItemsOpt2.push(t)});o.insertUpdateDeleteMilestoneOpt2={insert:o.milestoneInsertListItemsOpt2,update:o.milestoneUpdateListItemsOpt2,"delete":o.deletedMilestoneDataOption2}}if($("#gridBusinessCaseOptRiskOption2").data("kendoGrid")!=undefined){var hr=$("#gridBusinessCaseOptRiskOption2").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),pu=hr.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),wu=hr.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(pu,function(n){var t={};t.BusinessRiskIssueUniqueID=n.BusinessRiskIssueUniqueID;t.IfHappens=n.IfHappens;t.RiskIssueResult=n.RiskIssueResult;t.Mitigation=n.Mitigation;t.RiskIssueTypeID=n.RiskIssueTypeID;t.ProbabilityID=n.ProbabilityID;t.ImpactID=n.ImpactID;t.FunctionGroupID=n.FunctionGroupID;o.riskInsertListItemsOpt2.push(t)});angular.forEach(wu,function(n){var t={};t.BusinessRiskIssueUniqueID=n.BusinessRiskIssueUniqueID;t.IfHappens=n.IfHappens;t.RiskIssueResult=n.RiskIssueResult;t.Mitigation=n.Mitigation;t.RiskIssueTypeID=n.RiskIssueTypeID;t.ProbabilityID=n.ProbabilityID;t.ImpactID=n.ImpactID;t.FunctionGroupID=n.FunctionGroupID;o.riskUpdateListItemsOpt2.push(t)});o.insertUpdateDeleteRiskOpt2={insert:o.riskInsertListItemsOpt2,update:o.riskUpdateListItemsOpt2,"delete":o.deletedRiskDataOption2}}if($("#gridBusinessCaseOptAssumptionOption2").data("kendoGrid")!=undefined){var vr=$("#gridBusinessCaseOptAssumptionOption2").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),bu=vr.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),ku=vr.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(bu,function(n){var t={};t.BusinessKeyAssumptionUniqueID="";t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.KeyAssumption=n.KeyAssumption;t.AssumptionRationale=n.AssumptionRationale;o.assumptionInsertListItemsOpt2.push(t)});angular.forEach(ku,function(n){var t={};t.BusinessKeyAssumptionUniqueID=n.BusinessKeyAssumptionUniqueID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.KeyAssumption=n.KeyAssumption;t.AssumptionRationale=n.AssumptionRationale;o.assumptionUpdateListItemsOpt2.push(t)});o.insertUpdateDeleteAssumptionOpt2={insert:o.assumptionInsertListItemsOpt2,update:o.assumptionUpdateListItemsOpt2,"delete":o.deletedAssumptionDataOption2}}if($("#gridBusinessCaseFundingOption2").data("kendoGrid")!=undefined){var yr=$("#gridBusinessCaseFundingOption2").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),gu=yr.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),nf=yr.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(gu,function(n){var t={};t.BusinessFundingUniqueID=n.BusinessFundingUniqueID;t.FundingTypeID=n.FundingTypeID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.FundingSourceID=n.FundingSourceID;t.FundingIntheplan=n.FundingIntheplan;t.FundingAmount=n.FundingAmount;t.FundingNotes=n.FundingNotes;o.fundindInsertListItemsOpt2.push(t)});angular.forEach(nf,function(n){var t={};t.BusinessFundingUniqueID=n.BusinessFundingUniqueID;t.FundingTypeID=n.FundingTypeID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.FundingSourceID=n.FundingSourceID;t.FundingIntheplan=n.FundingIntheplan;t.FundingAmount=n.FundingAmount;t.FundingNotes=n.FundingNotes;o.fundindUpdateListItemsOpt2.push(t)});o.insertUpdateDeleteFundingOpt2={insert:o.fundindInsertListItemsOpt2,update:o.fundindUpdateListItemsOpt2,"delete":o.deletedFundingDataOption2}}if($("#gridBusinessCaseOptKeySuccessCriteriaOption2").data("kendoGrid")!=undefined){var pr=$("#gridBusinessCaseOptKeySuccessCriteriaOption2").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),tf=pr.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),rf=pr.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(tf,function(n){var t={};t.BusinessKeySuccessUniqueID=n.BusinessKeySuccessUniqueID;t.Metric=n.Metric;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.CurrentState=n.CurrentState;t.TargetPerformance=n.TargetPerformance;o.keySuccessInsertListItemsOpt2.push(t)});angular.forEach(rf,function(n){var t={};t.BusinessKeySuccessUniqueID=n.BusinessKeySuccessUniqueID;t.Metric=n.Metric;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.CurrentState=n.CurrentState;t.TargetPerformance=n.TargetPerformance;o.keySuccessUpdateListItemsOpt2.push(t)});o.insertUpdateDeleteKeySuccessOpt2={insert:o.keySuccessInsertListItemsOpt2,update:o.keySuccessUpdateListItemsOpt2,"delete":o.deletedKeySuccessDataOption2}}if($("#gridCapsOpt2").data("kendoGrid")!=undefined&&(g={},br=$("#gridCapsOpt2").data("kendoGrid").dataSource.data().map(function(n){return n}),angular.forEach(br,function(n){g={EMSourceID:n.EMSourceID,EMSourceName:n.EMSourceName,EMUnit:n.EMUnit,UnitOfMeasure:n.UnitOfMeasure,EMBasisOfEstimate:n.EMBasisOfEstimate,EMFactorImpact:n.EMFactorImpact};o.capsGridOpt2.push(g)})),$("#gridBusinessCaseOpt3Timeline").data("kendoGrid")!=undefined){var kr=$("#gridBusinessCaseOpt3Timeline").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),uf=kr.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),ff=kr.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(uf,function(n){var t={};t.BusinessScheduleUniqueID=n.BusinessScheduleUniqueID;t.Milestone=n.Milestone;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.PlannedFinish=kendo.toString(n.PlannedFinish,"d");t.FunctionGroupID=n.FunctionGroupID;o.milestoneInsertListItemsOpt3.push(t)});angular.forEach(ff,function(n){var t={};t.BusinessScheduleUniqueID=n.BusinessScheduleUniqueID;t.Milestone=n.Milestone;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.PlannedFinish=kendo.toString(n.PlannedFinish,"d");t.FunctionGroupID=n.FunctionGroupID;y.length>0&&(t.MilestoneTemplateID=n.MilestoneTemplateID,t.MilestoneID=n.MilestoneID,t.IncludeInBusinessCase=n.IncludeInBusinessCase,t.Comments=n.Comments);o.milestoneUpdateListItemsOpt3.push(t)});o.insertUpdateDeleteMilestoneOpt3={insert:o.milestoneInsertListItemsOpt3,update:o.milestoneUpdateListItemsOpt3,"delete":o.deletedMilestoneDataOption3}}if($("#gridBusinessCaseOptRiskOption3").data("kendoGrid")!=undefined){var dr=$("#gridBusinessCaseOptRiskOption3").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),ef=dr.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),of=dr.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(ef,function(n){var t={};t.BusinessRiskIssueUniqueID=n.BusinessRiskIssueUniqueID;t.IfHappens=n.IfHappens;t.RiskIssueResult=n.RiskIssueResult;t.Mitigation=n.Mitigation;t.RiskIssueTypeID=n.RiskIssueTypeID;t.ProbabilityID=n.ProbabilityID;t.ImpactID=n.ImpactID;t.FunctionGroupID=n.FunctionGroupID;o.riskInsertListItemsOpt3.push(t)});angular.forEach(of,function(n){var t={};t.BusinessRiskIssueUniqueID=n.BusinessRiskIssueUniqueID;t.IfHappens=n.IfHappens;t.RiskIssueResult=n.RiskIssueResult;t.Mitigation=n.Mitigation;t.RiskIssueTypeID=n.RiskIssueTypeID;t.ProbabilityID=n.ProbabilityID;t.ImpactID=n.ImpactID;t.FunctionGroupID=n.FunctionGroupID;o.riskUpdateListItemsOpt3.push(t)});o.insertUpdateDeleteRiskOpt3={insert:o.riskInsertListItemsOpt3,update:o.riskUpdateListItemsOpt3,"delete":o.deletedRiskDataOption3}}if($("#gridBusinessCaseOptAssumptionOption3").data("kendoGrid")!=undefined){var gr=$("#gridBusinessCaseOptAssumptionOption3").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),sf=gr.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),hf=gr.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(sf,function(n){var t={};t.BusinessKeyAssumptionUniqueID="";t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.KeyAssumption=n.KeyAssumption;t.AssumptionRationale=n.AssumptionRationale;o.assumptionInsertListItemsOpt3.push(t)});angular.forEach(hf,function(n){var t={};t.BusinessKeyAssumptionUniqueID=n.BusinessKeyAssumptionUniqueID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.KeyAssumption=n.KeyAssumption;t.AssumptionRationale=n.AssumptionRationale;o.assumptionUpdateListItemsOpt3.push(t)});o.insertUpdateDeleteAssumptionOpt3={insert:o.assumptionInsertListItemsOpt3,update:o.assumptionUpdateListItemsOpt3,"delete":o.deletedAssumptionDataOption3}}if($("#gridBusinessCaseFundingOption3").data("kendoGrid")!=undefined){var nu=$("#gridBusinessCaseFundingOption3").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),cf=nu.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),lf=nu.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(cf,function(n){var t={};t.BusinessFundingUniqueID=n.BusinessFundingUniqueID;t.FundingTypeID=n.FundingTypeID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.FundingSourceID=n.FundingSourceID;t.FundingIntheplan=n.FundingIntheplan;t.FundingAmount=n.FundingAmount;t.FundingNotes=n.FundingNotes;o.fundindInsertListItemsOpt3.push(t)});angular.forEach(lf,function(n){var t={};t.BusinessFundingUniqueID=n.BusinessFundingUniqueID;t.FundingTypeID=n.FundingTypeID;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.FundingSourceID=n.FundingSourceID;t.FundingIntheplan=n.FundingIntheplan;t.FundingAmount=n.FundingAmount;t.FundingNotes=n.FundingNotes;o.fundindUpdateListItemsOpt3.push(t)});o.insertUpdateDeleteFundingOpt3={insert:o.fundindInsertListItemsOpt3,update:o.fundindUpdateListItemsOpt3,"delete":o.deletedFundingDataOption3}}if($("#gridBusinessCaseOptKeySuccessCriteriaOption3").data("kendoGrid")!=undefined){var tu=$("#gridBusinessCaseOptKeySuccessCriteriaOption3").data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n}),af=tu.filter(function(n){return n.id==""||n.id==null}).map(function(n){return n}),vf=tu.filter(function(n){return n.id!=""&&n.id!=null}).map(function(n){return n});angular.forEach(af,function(n){var t={};t.BusinessKeySuccessUniqueID=n.BusinessKeySuccessUniqueID;t.Metric=n.Metric;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.CurrentState=n.CurrentState;t.TargetPerformance=n.TargetPerformance;o.keySuccessInsertListItemsOpt3.push(t)});angular.forEach(vf,function(n){var t={};t.BusinessKeySuccessUniqueID=n.BusinessKeySuccessUniqueID;t.Metric=n.Metric;t.IncludeInBusinessCase=n.IncludeInBusinessCase;t.CurrentState=n.CurrentState;t.TargetPerformance=n.TargetPerformance;o.keySuccessUpdateListItemsOpt3.push(t)});o.insertUpdateDeleteKeySuccessOpt3={insert:o.keySuccessInsertListItemsOpt3,update:o.keySuccessUpdateListItemsOpt3,"delete":o.deletedKeySuccessDataOption3}}$("#gridCapsOpt3").data("kendoGrid")!=undefined&&(nt={},iu=$("#gridCapsOpt3").data("kendoGrid").dataSource.data().map(function(n){return n}),angular.forEach(iu,function(n){nt={EMSourceID:n.EMSourceID,EMSourceName:n.EMSourceName,EMUnit:n.EMUnit,UnitOfMeasure:n.UnitOfMeasure,EMBasisOfEstimate:n.EMBasisOfEstimate,EMFactorImpact:n.EMFactorImpact};o.capsGridOpt3.push(nt)}));yf=[];o.showCapex!=null&&(e=(o.businessOptionInfoSelector.TotalCapexBaseCase!=null||o.businessOptionInfoSelector.TotalCapexHighCase!=null)&&(o.businessOptionInfoSelector.TotalCapexBaseCase!==""||o.businessOptionInfoSelector.TotalCapexHighCase!=="")?!0:!1);o.showCapexOpt2!=null&&(s=(o.businessOption2InfoSelector.TotalCapexBaseCase!=null||o.businessOption2InfoSelector.TotalCapexHighCase!=null)&&(o.businessOption2InfoSelector.TotalCapexBaseCase!==""||o.businessOption2InfoSelector.TotalCapexHighCase!=="")?!0:!1);o.showCapexOpt3!=null&&(h=(o.businessOption3InfoSelector.TotalCapexBaseCase!=null||o.businessOption3InfoSelector.TotalCapexHighCase!=null)&&(o.businessOption3InfoSelector.TotalCapexBaseCase!==""||o.businessOption3InfoSelector.TotalCapexHighCase!=="")?!0:!1);o.showOpex!=null&&(a=(o.businessOptionInfoSelector.TotalNonFTEBaseCase!=null||o.businessOptionInfoSelector.TotalNonFTEHighCase!=null)&&(o.businessOptionInfoSelector.TotalNonFTEBaseCase!==""||o.businessOptionInfoSelector.TotalNonFTEHighCase!=="")?!0:!1);o.showOpexOpt2!=null&&(p=(o.businessOption2InfoSelector.TotalNonFTEBaseCase!=null||o.businessOption2InfoSelector.TotalNonFTEHighCase!=null)&&(o.businessOption2InfoSelector.TotalNonFTEBaseCase!==""||o.businessOption2InfoSelector.TotalNonFTEHighCase!=="")?!0:!1);o.showOpexOpt3!=null&&(w=(o.businessOption3InfoSelector.TotalNonFTEBaseCase!=null||o.businessOption3InfoSelector.TotalNonFTEHighCase!=null)&&(o.businessOption3InfoSelector.TotalNonFTEBaseCase!==""||o.businessOption3InfoSelector.TotalNonFTEHighCase!=="")?!0:!1);o.businessOptionInfoSelectedData={BusinessCaseOptionUniqueID:o.businessOptionInfoSelector!=null?o.businessOptionInfoSelector.BusinessCaseOptionUniqueID!=null?o.businessOptionInfoSelector.BusinessCaseOptionUniqueID:null:null,ProjectID:o.businessOptionInfoSelector.ProjectID,OptionTitle:o.businessOptionInfoSelector.OptionTitle,RecommendedOption:o.businessOptionInfoSelector.RecommendedOption==undefined?!1:o.businessOptionInfoSelector.RecommendedOption,ProposalStatement:o.businessOptionInfoSelector.ProposalStatement!=null?o.businessOptionInfoSelector.ProposalStatement:null,DetailedDescription:o.businessOptionInfoSelector.DetailedDescription!=null?o.businessOptionInfoSelector.DetailedDescription:null,RationaleWhyBestOption:o.businessOptionInfoSelector.RationaleWhyBestOption!=null?o.businessOptionInfoSelector.RationaleWhyBestOption:null,TradeoffsConsiderations:o.businessOptionInfoSelector.TradeoffsConsiderations!=null?o.businessOptionInfoSelector.TradeoffsConsiderations:null,PeopleRatingID:o.selectedBCPeopleRating!=null?o.selectedBCPeopleRating.LookUpMemberID:null,TechnologyRatingID:o.selectedBCTechnologyRating!=null?o.selectedBCTechnologyRating.LookUpMemberID:null,BusinessCaseProcessID:o.selectedBCBusinessCaseProcess!=null?o.selectedBCBusinessCaseProcess.LookUpMemberID:null,ManufacturingProcessID:o.selectedBCManufacturingProcess!=null?o.selectedBCManufacturingProcess.LookUpMemberID:null,EquipmentRatingID:o.selectedBCEquipmentRating!=null?o.selectedBCEquipmentRating.LookUpMemberID:null,PeopleJustification:o.businessOptionInfoSelector.PeopleJustification!=null?o.businessOptionInfoSelector.PeopleJustification:null,TechnologyJustification:o.businessOptionInfoSelector.TechnologyJustification!=null?o.businessOptionInfoSelector.TechnologyJustification:null,BusinessProcessJustification:o.businessOptionInfoSelector.BusinessProcessJustification!=null?o.businessOptionInfoSelector.BusinessProcessJustification:null,ManufacturingProcessJustification:o.businessOptionInfoSelector.ManufacturingProcessJustification!=null?o.businessOptionInfoSelector.ManufacturingProcessJustification:null,EquipementJustification:o.businessOptionInfoSelector.EquipementJustification!=null?o.businessOptionInfoSelector.EquipementJustification:null,ExecutionStartDate:o.businessOptionInfoSelector.ExecutionStartDate!=null&&o.businessOptionInfoSelector.ExecutionStartDate!=""?o.businessOptionInfoSelector.ExecutionStartDate:null,ExecutionEndDate:o.businessOptionInfoSelector.ExecutionEndDate!=null&&o.businessOptionInfoSelector.ExecutionEndDate!=null?o.businessOptionInfoSelector.ExecutionEndDate:null,CapexRequired:o.showCapex!=null?e:null,TotalCapexBaseCase:e==!1?null:o.businessOptionInfoSelector.TotalCapexBaseCase!=null&&o.businessOptionInfoSelector.TotalCapexBaseCase!==""?o.businessOptionInfoSelector.TotalCapexBaseCase:null,TotalCapexHighCase:e==!1?null:o.businessOptionInfoSelector.TotalCapexHighCase!=null&&o.businessOptionInfoSelector.TotalCapexHighCase!==""?o.businessOptionInfoSelector.TotalCapexHighCase:null,ProjectSpendStart:o.businessOptionInfoSelector.ProjectSpendStart!=null&&o.businessOptionInfoSelector.ProjectSpendStart!=""?o.businessOptionInfoSelector.ProjectSpendStart:null,IsProjectSpentNA:o.businessOptionInfoSelector.IsProjectSpentNA!=null?o.businessOptionInfoSelector.IsProjectSpentNA:!1,AssetInService:o.businessOptionInfoSelector.AssetInService!=null&&o.businessOptionInfoSelector.AssetInService!=""?o.businessOptionInfoSelector.AssetInService:null,AssetInServiceNA:o.businessOptionInfoSelector.AssetInServiceNA!=null?o.businessOptionInfoSelector.AssetInServiceNA:!1,OpexRequired:o.showOpex!=null?a:null,StrategicAlignment:o.businessOptionInfoSelector.StrategicAlignment!=null?o.businessOptionInfoSelector.StrategicAlignment:null,StrategicAlignmentJustification:o.businessOptionInfoSelector.StrategicAlignmentJustification!=null?o.businessOptionInfoSelector.StrategicAlignmentJustification:null,NPVBaseCase:o.businessOptionInfoSelector.NPVBaseCase!=null?o.businessOptionInfoSelector.NPVBaseCase:null,NPVHighCase:o.businessOptionInfoSelector.NPVHighCase!=null?o.businessOptionInfoSelector.NPVHighCase:null,NPVRationale:o.businessOptionInfoSelector.NPVRationale!=null?o.businessOptionInfoSelector.NPVRationale:null,DurationBaseCase:o.businessOptionInfoSelector.DurationBaseCase!=null&&o.businessOptionInfoSelector.DurationBaseCase!==""?o.businessOptionInfoSelector.DurationBaseCase:null,DurationHighCase:o.businessOptionInfoSelector.DurationHighCase!=null&&o.businessOptionInfoSelector.DurationHighCase!==""?o.businessOptionInfoSelector.DurationHighCase:null,DurationBasisofEstimate:o.businessOptionInfoSelector.DurationBasisofEstimate!=null?o.businessOptionInfoSelector.DurationBasisofEstimate:null,PeopleFTEMonthsRequiredBaseCase:o.businessOptionInfoSelector.PeopleFTEMonthsRequiredBaseCase!=null&&o.businessOptionInfoSelector.PeopleFTEMonthsRequiredBaseCase!==""?o.businessOptionInfoSelector.PeopleFTEMonthsRequiredBaseCase:null,PeopleFTEMonthsRequiredHighCase:o.businessOptionInfoSelector.PeopleFTEMonthsRequiredHighCase!=null&&o.businessOptionInfoSelector.PeopleFTEMonthsRequiredHighCase!==""?o.businessOptionInfoSelector.PeopleFTEMonthsRequiredHighCase:null,PeopleFTEMonthsRequiredBasisofEstimate:o.businessOptionInfoSelector.PeopleFTEMonthsRequiredBasisofEstimate!=null?o.businessOptionInfoSelector.PeopleFTEMonthsRequiredBasisofEstimate:null,TotalCapExBasisofEstimate:o.businessOptionInfoSelector.TotalCapExBasisofEstimate!=null?o.businessOptionInfoSelector.TotalCapExBasisofEstimate:null,TotalNonFTEBaseCase:a==!1?null:o.businessOptionInfoSelector.TotalNonFTEBaseCase!=null&&o.businessOptionInfoSelector.TotalNonFTEBaseCase!==""?o.businessOptionInfoSelector.TotalNonFTEBaseCase:null,TotalNonFTEHighCase:a==!1?null:o.businessOptionInfoSelector.TotalNonFTEHighCase!=null&&o.businessOptionInfoSelector.TotalNonFTEHighCase!==""?o.businessOptionInfoSelector.TotalNonFTEHighCase:null,TotalNonFTEBasisofEstimate:o.businessOptionInfoSelector.TotalNonFTEBasisofEstimate!=null?o.businessOptionInfoSelector.TotalNonFTEBasisofEstimate:null,InLineProductID:o.businessOptionInfoSelector.InLineProductID!=null?o.businessOptionInfoSelector.InLineProductID.LookUpMemberID==undefined?o.businessOptionInfoSelector.InLineProductID:o.businessOptionInfoSelector.InLineProductID.LookUpMemberID:null,InLineProductRationale:o.businessOptionInfoSelector.InLineProductRationale!=null?o.businessOptionInfoSelector.InLineProductRationale:null,ImpactMultiplierID:o.businessOptionInfoSelector.ImpactMultiplierID!=null?o.businessOptionInfoSelector.ImpactMultiplierID.LookUpMemberID==undefined?o.businessOptionInfoSelector.ImpactMultiplierID:o.businessOptionInfoSelector.ImpactMultiplierID.LookUpMemberID:null,ImpactMultiplierRationale:o.businessOptionInfoSelector.ImpactMultiplierRationale!=null?o.businessOptionInfoSelector.ImpactMultiplierRationale:null,FunctionsRequiredID:o.businessOptionInfoSelector.FunctionsRequiredID!=null?o.businessOptionInfoSelector.FunctionsRequiredID.LookUpMemberID==undefined?o.businessOptionInfoSelector.FunctionsRequiredID:o.businessOptionInfoSelector.FunctionsRequiredID.LookUpMemberID:null,CurrentYearPlannedSpend:o.businessOptionInfoSelector.CurrentYearPlannedSpend!=null&&o.businessOptionInfoSelector.CurrentYearPlannedSpend!=""?o.businessOptionInfoSelector.CurrentYearPlannedSpend:null,ProjectScope:o.businessOptionInfoSelector.ProjectScope!=null?o.businessOptionInfoSelector.ProjectScope.LookUpMemberID==undefined?o.businessOptionInfoSelector.ProjectScope:o.businessOptionInfoSelector.ProjectScope.LookUpMemberID:null,CalculatedEmissionsImpact:o.formattedCalculatedEmissionsImpact1!=null&&o.formattedCalculatedEmissionsImpact1!==""?o.formattedCalculatedEmissionsImpact1:null,EmissionsImpactRealizationDate:o.businessOptionInfoSelector.EmissionsImpactRealizationDate!=null&&o.businessOptionInfoSelector.EmissionsImpactRealizationDate!==""?o.businessOptionInfoSelector.EmissionsImpactRealizationDate:null,NoCarbonImpact:o.businessOptionInfoSelector.NoCarbonImpact!=null&&o.businessOptionInfoSelector.NoCarbonImpact!==""?o.businessOptionInfoSelector.NoCarbonImpact:null};o.businessOption2InfoSelectedData={BusinessCaseOptionUniqueID:o.businessOption2InfoSelector!=null?o.businessOption2InfoSelector.BusinessCaseOptionUniqueID!=null?o.businessOption2InfoSelector.BusinessCaseOptionUniqueID:null:null,ProjectID:o.businessOption2InfoSelector.ProjectID,OptionTitle:o.businessOption2InfoSelector.OptionTitle,RecommendedOption:o.businessOption2InfoSelector.RecommendedOption==undefined?!1:o.businessOption2InfoSelector.RecommendedOption,ProposalStatement:o.businessOption2InfoSelector.ProposalStatement!=null?o.businessOption2InfoSelector.ProposalStatement:null,DetailedDescription:o.businessOption2InfoSelector.DetailedDescription!=null?o.businessOption2InfoSelector.DetailedDescription:null,RationaleWhyBestOption:o.businessOption2InfoSelector.RationaleWhyBestOption!=null?o.businessOption2InfoSelector.RationaleWhyBestOption:null,TradeoffsConsiderations:o.businessOption2InfoSelector.TradeoffsConsiderations!=null?o.businessOption2InfoSelector.TradeoffsConsiderations:null,PeopleRatingID:o.selectedBCPeopleRatingOption2!=null?o.selectedBCPeopleRatingOption2.LookUpMemberID:null,TechnologyRatingID:o.selectedBCTechnologyRatingOption2!=null?o.selectedBCTechnologyRatingOption2.LookUpMemberID:null,BusinessCaseProcessID:o.selectedBCBusinessCaseProcessOption2!=null?o.selectedBCBusinessCaseProcessOption2.LookUpMemberID:null,ManufacturingProcessID:o.selectedBCManufacturingProcessoption2!=null?o.selectedBCManufacturingProcessoption2.LookUpMemberID:null,EquipmentRatingID:o.selectedBCEquipmentRatingOption2!=null?o.selectedBCEquipmentRatingOption2.LookUpMemberID:null,PeopleJustification:o.businessOption2InfoSelector.PeopleJustification!=null?o.businessOption2InfoSelector.PeopleJustification:null,TechnologyJustification:o.businessOption2InfoSelector.TechnologyJustification!=null?o.businessOption2InfoSelector.TechnologyJustification:null,BusinessProcessJustification:o.businessOption2InfoSelector.BusinessProcessJustification!=null?o.businessOption2InfoSelector.BusinessProcessJustification:null,ManufacturingProcessJustification:o.businessOption2InfoSelector.ManufacturingProcessJustification!=null?o.businessOption2InfoSelector.ManufacturingProcessJustification:null,EquipementJustification:o.businessOption2InfoSelector.EquipementJustification!=null?o.businessOption2InfoSelector.EquipementJustification:null,ExecutionStartDate:o.businessOption2InfoSelector.ExecutionStartDate!=null&&o.businessOption2InfoSelector.ExecutionStartDate!=""?o.businessOption2InfoSelector.ExecutionStartDate:null,ExecutionEndDate:o.businessOption2InfoSelector.ExecutionEndDate!=null&&o.businessOption2InfoSelector.ExecutionEndDate!=""?o.businessOption2InfoSelector.ExecutionEndDate:null,CapexRequired:o.showCapexOpt2!=null?s:null,TotalCapexBaseCase:s==!1?null:o.businessOption2InfoSelector.TotalCapexBaseCase!=null&&o.businessOption2InfoSelector.TotalCapexBaseCase!==""?o.businessOption2InfoSelector.TotalCapexBaseCase:null,TotalCapexHighCase:s==!1?null:o.businessOption2InfoSelector.TotalCapexHighCase!=null&&o.businessOption2InfoSelector.TotalCapexHighCase!==""?o.businessOption2InfoSelector.TotalCapexHighCase:null,ProjectSpendStart:o.businessOption2InfoSelector.ProjectSpendStart!=null&&o.businessOption2InfoSelector.ProjectSpendStart!=""?o.businessOption2InfoSelector.ProjectSpendStart:null,IsProjectSpentNA:o.businessOption2InfoSelector.IsProjectSpentNA!=null?o.businessOption2InfoSelector.IsProjectSpentNA:!1,AssetInService:o.businessOption2InfoSelector.AssetInService!=null&&o.businessOption2InfoSelector.AssetInService!=""?o.businessOption2InfoSelector.AssetInService:null,AssetInServiceNA:o.businessOption2InfoSelector.AssetInServiceNA!=null?o.businessOption2InfoSelector.AssetInServiceNA:!1,OpexRequired:o.showOpexOpt2!=null?p:null,StrategicAlignment:o.businessOption2InfoSelector.StrategicAlignment!=null?o.businessOption2InfoSelector.StrategicAlignment:null,StrategicAlignmentJustification:o.businessOption2InfoSelector.StrategicAlignmentJustification!=null?o.businessOption2InfoSelector.StrategicAlignmentJustification:null,NPVBaseCase:o.businessOption2InfoSelector.NPVBaseCase!=null?o.businessOption2InfoSelector.NPVBaseCase:null,NPVHighCase:o.businessOption2InfoSelector.NPVHighCase!=null?o.businessOption2InfoSelector.NPVHighCase:null,NPVRationale:o.businessOption2InfoSelector.NPVRationale!=null?o.businessOption2InfoSelector.NPVRationale:null,DurationBaseCase:o.businessOption2InfoSelector.DurationBaseCase!=null&&o.businessOption2InfoSelector.DurationBaseCase!==""?o.businessOption2InfoSelector.DurationBaseCase:null,DurationHighCase:o.businessOption2InfoSelector.DurationHighCase!=null&&o.businessOption2InfoSelector.DurationHighCase!==""?o.businessOption2InfoSelector.DurationHighCase:null,DurationBasisofEstimate:o.businessOption2InfoSelector.DurationBasisofEstimate!=null?o.businessOption2InfoSelector.DurationBasisofEstimate:null,PeopleFTEMonthsRequiredBaseCase:o.businessOption2InfoSelector.PeopleFTEMonthsRequiredBaseCase!=null&&o.businessOption2InfoSelector.PeopleFTEMonthsRequiredBaseCase!==""?o.businessOption2InfoSelector.PeopleFTEMonthsRequiredBaseCase:null,PeopleFTEMonthsRequiredHighCase:o.businessOption2InfoSelector.PeopleFTEMonthsRequiredHighCase!=null&&o.businessOption2InfoSelector.PeopleFTEMonthsRequiredHighCase!==""?o.businessOption2InfoSelector.PeopleFTEMonthsRequiredHighCase:null,PeopleFTEMonthsRequiredBasisofEstimate:o.businessOption2InfoSelector.PeopleFTEMonthsRequiredBasisofEstimate!=null?o.businessOption2InfoSelector.PeopleFTEMonthsRequiredBasisofEstimate:null,TotalCapExBasisofEstimate:o.businessOption2InfoSelector.TotalCapExBasisofEstimate!=null?o.businessOption2InfoSelector.TotalCapExBasisofEstimate:null,TotalNonFTEBaseCase:p==!1?null:o.businessOption2InfoSelector.TotalNonFTEBaseCase!=null&&o.businessOption2InfoSelector.TotalNonFTEBaseCase!==""?o.businessOption2InfoSelector.TotalNonFTEBaseCase:null,TotalNonFTEHighCase:p==!1?null:o.businessOption2InfoSelector.TotalNonFTEHighCase!=null&&o.businessOption2InfoSelector.TotalNonFTEHighCase!==""?o.businessOption2InfoSelector.TotalNonFTEHighCase:null,TotalNonFTEBasisofEstimate:o.businessOption2InfoSelector.TotalNonFTEBasisofEstimate!=null?o.businessOption2InfoSelector.TotalNonFTEBasisofEstimate:null,InLineProductID:o.businessOption2InfoSelector.InLineProductID!=null?o.businessOption2InfoSelector.InLineProductID.LookUpMemberID==undefined?o.businessOption2InfoSelector.InLineProductID:o.businessOption2InfoSelector.InLineProductID.LookUpMemberID:null,InLineProductRationale:o.businessOption2InfoSelector.InLineProductRationale!=null?o.businessOption2InfoSelector.InLineProductRationale:null,ImpactMultiplierID:o.businessOption2InfoSelector.ImpactMultiplierID!=null?o.businessOption2InfoSelector.ImpactMultiplierID.LookUpMemberID==undefined?o.businessOption2InfoSelector.ImpactMultiplierID:o.businessOption2InfoSelector.ImpactMultiplierID.LookUpMemberID:null,ImpactMultiplierRationale:o.businessOption2InfoSelector.ImpactMultiplierRationale!=null?o.businessOption2InfoSelector.ImpactMultiplierRationale:null,FunctionsRequiredID:o.businessOption2InfoSelector.FunctionsRequiredID!=null?o.businessOption2InfoSelector.FunctionsRequiredID.LookUpMemberID==undefined?o.businessOption2InfoSelector.FunctionsRequiredID:o.businessOption2InfoSelector.FunctionsRequiredID.LookUpMemberID:null,CurrentYearPlannedSpend:o.businessOption2InfoSelector.CurrentYearPlannedSpend!=null&&o.businessOption2InfoSelector.CurrentYearPlannedSpend!=""?o.businessOption2InfoSelector.CurrentYearPlannedSpend:null,ProjectScope:o.businessOption2InfoSelector.ProjectScope!=null?o.businessOption2InfoSelector.ProjectScope.LookUpMemberID==undefined?o.businessOption2InfoSelector.ProjectScope:o.businessOption2InfoSelector.ProjectScope.LookUpMemberID:null,CalculatedEmissionsImpact:o.formattedCalculatedEmissionsImpact2!=null&&o.formattedCalculatedEmissionsImpact2!==""?o.formattedCalculatedEmissionsImpact2:null,EmissionsImpactRealizationDate:o.businessOption2InfoSelector.EmissionsImpactRealizationDate!=null&&o.businessOption2InfoSelector.EmissionsImpactRealizationDate!==""?o.businessOption2InfoSelector.EmissionsImpactRealizationDate:null,NoCarbonImpact:o.businessOption2InfoSelector.NoCarbonImpact!=null&&o.businessOption2InfoSelector.NoCarbonImpact!==""?o.businessOption2InfoSelector.NoCarbonImpact:null};o.businessOption3InfoSelectedData={BusinessCaseOptionUniqueID:o.businessOption3InfoSelector!=null?o.businessOption3InfoSelector.BusinessCaseOptionUniqueID!=null?o.businessOption3InfoSelector.BusinessCaseOptionUniqueID:null:null,ProjectID:o.businessOption3InfoSelector.ProjectID,OptionTitle:o.businessOption3InfoSelector.OptionTitle,RecommendedOption:o.businessOption3InfoSelector.RecommendedOption==undefined?!1:o.businessOption3InfoSelector.RecommendedOption,ProposalStatement:o.businessOption3InfoSelector.ProposalStatement!=null?o.businessOption3InfoSelector.ProposalStatement:null,DetailedDescription:o.businessOption3InfoSelector.DetailedDescription!=null?o.businessOption3InfoSelector.DetailedDescription:null,RationaleWhyBestOption:o.businessOption3InfoSelector.RationaleWhyBestOption!=null?o.businessOption3InfoSelector.RationaleWhyBestOption:null,TradeoffsConsiderations:o.businessOption3InfoSelector.TradeoffsConsiderations!=null?o.businessOption3InfoSelector.TradeoffsConsiderations:null,PeopleRatingID:o.selectedBCPeopleRatingOption3!=null?o.selectedBCPeopleRatingOption3.LookUpMemberID:null,TechnologyRatingID:o.selectedBCTechnologyRatingOption3!=null?o.selectedBCTechnologyRatingOption3.LookUpMemberID:null,BusinessCaseProcessID:o.selectedBCBusinessCaseProcessOption3!=null?o.selectedBCBusinessCaseProcessOption3.LookUpMemberID:null,ManufacturingProcessID:o.selectedBCManufacturingProcessOption3!=null?o.selectedBCManufacturingProcessOption3.LookUpMemberID:null,EquipmentRatingID:o.selectedBCEquipmentRatingOption3!=null?o.selectedBCEquipmentRatingOption3.LookUpMemberID:null,PeopleJustification:o.businessOption3InfoSelector.PeopleJustification!=null?o.businessOption3InfoSelector.PeopleJustification:null,TechnologyJustification:o.businessOption3InfoSelector.TechnologyJustification!=null?o.businessOption3InfoSelector.TechnologyJustification:null,BusinessProcessJustification:o.businessOption3InfoSelector.BusinessProcessJustification!=null?o.businessOption3InfoSelector.BusinessProcessJustification:null,ManufacturingProcessJustification:o.businessOption3InfoSelector.ManufacturingProcessJustification!=null?o.businessOption3InfoSelector.ManufacturingProcessJustification:null,EquipementJustification:o.businessOption3InfoSelector.EquipementJustification!=null?o.businessOption3InfoSelector.EquipementJustification:null,ExecutionStartDate:o.businessOption3InfoSelector.ExecutionStartDate!=null&&o.businessOption3InfoSelector.ExecutionStartDate!=""?o.businessOption3InfoSelector.ExecutionStartDate:null,ExecutionEndDate:o.businessOption3InfoSelector.ExecutionEndDate!=null&&o.businessOption3InfoSelector.ExecutionEndDate!=""?o.businessOption3InfoSelector.ExecutionEndDate:null,CapexRequired:o.showCapexOpt3!=null?h:null,TotalCapexBaseCase:h==!1?null:o.businessOption3InfoSelector.TotalCapexBaseCase!=null&&o.businessOption3InfoSelector.TotalCapexBaseCase!==""?o.businessOption3InfoSelector.TotalCapexBaseCase:null,TotalCapexHighCase:h==!1?null:o.businessOption3InfoSelector.TotalCapexHighCase!=null&&o.businessOption3InfoSelector.TotalCapexHighCase!==""?o.businessOption3InfoSelector.TotalCapexHighCase:null,ProjectSpendStart:o.businessOption3InfoSelector.ProjectSpendStart!=null&&o.businessOption3InfoSelector.ProjectSpendStart!=""?o.businessOption3InfoSelector.ProjectSpendStart:null,IsProjectSpentNA:o.businessOption3InfoSelector.IsProjectSpentNA!=null?o.businessOption3InfoSelector.IsProjectSpentNA:!1,AssetInService:o.businessOption3InfoSelector.AssetInService!=null&&o.businessOption3InfoSelector.AssetInService!=""?o.businessOption3InfoSelector.AssetInService:null,AssetInServiceNA:o.businessOption3InfoSelector.AssetInServiceNA!=null?o.businessOption3InfoSelector.AssetInServiceNA:!1,OpexRequired:o.showOpexOpt3!=null?w:null,StrategicAlignment:o.businessOption3InfoSelector.StrategicAlignment!=null?o.businessOption3InfoSelector.StrategicAlignment:null,StrategicAlignmentJustification:o.businessOption3InfoSelector.StrategicAlignmentJustification!=null?o.businessOption3InfoSelector.StrategicAlignmentJustification:null,NPVBaseCase:o.businessOption3InfoSelector.NPVBaseCase!=null?o.businessOption3InfoSelector.NPVBaseCase:null,NPVHighCase:o.businessOption3InfoSelector.NPVHighCase!=null?o.businessOption3InfoSelector.NPVHighCase:null,NPVRationale:o.businessOption3InfoSelector.NPVRationale!=null?o.businessOption3InfoSelector.NPVRationale:null,DurationBaseCase:o.businessOption3InfoSelector.DurationBaseCase!=null&&o.businessOption3InfoSelector.DurationBaseCase!==""?o.businessOption3InfoSelector.DurationBaseCase:null,DurationHighCase:o.businessOption3InfoSelector.DurationHighCase!=null&&o.businessOption3InfoSelector.DurationHighCase!==""?o.businessOption3InfoSelector.DurationHighCase:null,DurationBasisofEstimate:o.businessOption3InfoSelector.DurationBasisofEstimate!=null?o.businessOption3InfoSelector.DurationBasisofEstimate:null,PeopleFTEMonthsRequiredBaseCase:o.businessOption3InfoSelector.PeopleFTEMonthsRequiredBaseCase!=null&&o.businessOption3InfoSelector.PeopleFTEMonthsRequiredBaseCase!==""?o.businessOption3InfoSelector.PeopleFTEMonthsRequiredBaseCase:null,PeopleFTEMonthsRequiredHighCase:o.businessOption3InfoSelector.PeopleFTEMonthsRequiredHighCase!=null&&o.businessOption3InfoSelector.PeopleFTEMonthsRequiredHighCase!==""?o.businessOption3InfoSelector.PeopleFTEMonthsRequiredHighCase:null,PeopleFTEMonthsRequiredBasisofEstimate:o.businessOption3InfoSelector.PeopleFTEMonthsRequiredBasisofEstimate!=null?o.businessOption3InfoSelector.PeopleFTEMonthsRequiredBasisofEstimate:null,TotalCapExBasisofEstimate:o.businessOption3InfoSelector.TotalCapExBasisofEstimate!=null?o.businessOption3InfoSelector.TotalCapExBasisofEstimate:null,TotalNonFTEBaseCase:w==!1?null:o.businessOption3InfoSelector.TotalNonFTEBaseCase!=null&&o.businessOption3InfoSelector.TotalNonFTEBaseCase!==""?o.businessOption3InfoSelector.TotalNonFTEBaseCase:null,TotalNonFTEHighCase:w==!1?null:o.businessOption3InfoSelector.TotalNonFTEHighCase!=null&&o.businessOption3InfoSelector.TotalNonFTEHighCase!==""?o.businessOption3InfoSelector.TotalNonFTEHighCase:null,TotalNonFTEBasisofEstimate:o.businessOption3InfoSelector.TotalNonFTEBasisofEstimate!=null?o.businessOption3InfoSelector.TotalNonFTEBasisofEstimate:null,InLineProductID:o.businessOption3InfoSelector.InLineProductID!=null?o.businessOption3InfoSelector.InLineProductID.LookUpMemberID==undefined?o.businessOption3InfoSelector.InLineProductID:o.businessOption3InfoSelector.InLineProductID.LookUpMemberID:null,InLineProductRationale:o.businessOption3InfoSelector.InLineProductRationale!=null?o.businessOption3InfoSelector.InLineProductRationale:null,ImpactMultiplierID:o.businessOption3InfoSelector.ImpactMultiplierID!=null?o.businessOption3InfoSelector.ImpactMultiplierID.LookUpMemberID==undefined?o.businessOption3InfoSelector.ImpactMultiplierID:o.businessOption3InfoSelector.ImpactMultiplierID.LookUpMemberID:null,ImpactMultiplierRationale:o.businessOption3InfoSelector.ImpactMultiplierRationale!=null?o.businessOption3InfoSelector.ImpactMultiplierRationale:null,FunctionsRequiredID:o.businessOption3InfoSelector.FunctionsRequiredID!=null?o.businessOption3InfoSelector.FunctionsRequiredID.LookUpMemberID==undefined?o.businessOption3InfoSelector.FunctionsRequiredID:o.businessOption3InfoSelector.FunctionsRequiredID.LookUpMemberID:null,CurrentYearPlannedSpend:o.businessOption3InfoSelector.CurrentYearPlannedSpend!=null&&o.businessOption3InfoSelector.CurrentYearPlannedSpend!=""?o.businessOption3InfoSelector.CurrentYearPlannedSpend:null,ProjectScope:o.businessOption3InfoSelector.ProjectScope!=null?o.businessOption3InfoSelector.ProjectScope.LookUpMemberID==undefined?o.businessOption3InfoSelector.ProjectScope:o.businessOption3InfoSelector.ProjectScope.LookUpMemberID:null,CalculatedEmissionsImpact:o.formattedCalculatedEmissionsImpact3!=null&&o.formattedCalculatedEmissionsImpact3!==""?o.formattedCalculatedEmissionsImpact3:null,EmissionsImpactRealizationDate:o.businessOption3InfoSelector.EmissionsImpactRealizationDate!=null&&o.businessOption3InfoSelector.EmissionsImpactRealizationDate!==""?o.businessOption3InfoSelector.EmissionsImpactRealizationDate:null,NoCarbonImpact:o.businessOption3InfoSelector.NoCarbonImpact!=null&&o.businessOption3InfoSelector.NoCarbonImpact!==""?o.businessOption3InfoSelector.NoCarbonImpact:null};it.push(o.insertUpdateDeleteMilestone);rt.push(o.insertUpdateDeleteRisk);ft.push(o.insertUpdateDeleteKeySuccess);ut.push(o.insertUpdateDeleteAssumption);et.push(o.insertUpdateDeleteFunding);st.push(o.insertUpdateDeleteWaterWasteOpt1);ot.push(o.businessOptionInfoSelectedData);ht.push(o.insertUpdateDeleteMilestoneOpt2);ct.push(o.insertUpdateDeleteRiskOpt2);at.push(o.insertUpdateDeleteKeySuccessOpt2);lt.push(o.insertUpdateDeleteAssumptionOpt2);vt.push(o.insertUpdateDeleteFundingOpt2);pt.push(o.insertUpdateDeleteWaterWasteOpt2);yt.push(o.businessOption2InfoSelectedData);wt.push(o.insertUpdateDeleteMilestoneOpt3);bt.push(o.insertUpdateDeleteRiskOpt3);dt.push(o.insertUpdateDeleteKeySuccessOpt3);kt.push(o.insertUpdateDeleteAssumptionOpt3);gt.push(o.insertUpdateDeleteFundingOpt3);ti.push(o.insertUpdateDeleteWaterWasteOpt3);ni.push(o.businessOption3InfoSelectedData);tt.push(du());var pf=er("gridOption1Tops"),wf=er("gridOption2Tops"),bf=er("gridOption3Tops"),kf=!1,df=oi+","+si+","+hi,gf={ProjectID:o.SelectedProject.ProjectID,BusinessOptionID:df};$.when(f.postDataWCFAsync("deleteBusinessCase",gf)).then(function(){var t={ProjectBussinessCaseInfo:JSON.stringify(tt),ProjectID:o.SelectedProject.ProjectID,BusinessOptionID:BusinessCaseOption1,objRiskIssue:JSON.stringify(rt),objMilestone:JSON.stringify(it),objKeySuccess:JSON.stringify(ft),objAssumption:JSON.stringify(ut),objFunding:JSON.stringify(et),objCapsEMSource:JSON.stringify(o.capsGridOpt1),BusinessCaseOptionInfo:JSON.stringify(ot),TOPSKPI:JSON.stringify(pf),userId:currentUserId,objCapsWaterWaste:JSON.stringify(st)},i={ProjectBussinessCaseInfo:"",ProjectID:o.SelectedProject.ProjectID,BusinessOptionID:BusinessCaseOption2,objRiskIssue:JSON.stringify(ct),objMilestone:JSON.stringify(ht),objKeySuccess:JSON.stringify(at),objAssumption:JSON.stringify(lt),objFunding:JSON.stringify(vt),objCapsEMSource:JSON.stringify(o.capsGridOpt2),BusinessCaseOptionInfo:JSON.stringify(yt),TOPSKPI:JSON.stringify(wf),userId:currentUserId,objCapsWaterWaste:JSON.stringify(pt)},r={ProjectBussinessCaseInfo:"",ProjectID:o.SelectedProject.ProjectID,BusinessOptionID:BusinessCaseOption3,objRiskIssue:JSON.stringify(bt),objMilestone:JSON.stringify(wt),objKeySuccess:JSON.stringify(dt),objAssumption:JSON.stringify(kt),objFunding:JSON.stringify(gt),objCapsEMSource:JSON.stringify(o.capsGridOpt3),BusinessCaseOptionInfo:JSON.stringify(ni),TOPSKPI:JSON.stringify(bf),userId:currentUserId,objCapsWaterWaste:JSON.stringify(ti)};$.when(f.postDataWCFAsync("updateBusinessCase",t)).then(function(t){$.when(f.postDataWCFAsync("updateBusinessCase",i)).then(function(i){$.when(f.postDataWCFAsync("updateBusinessCase",r)).then(function(r){t=="Success"&&i=="Success"&&r=="Success"?(pi=!0,oi="",si="",hi="",or(),wr(),alert(saveMessage),hideLoading(),$.when(f.postDataWCFAsync("getProjectNameByID",SeletedProjectId),f.postDataWCFAsync("getBusinessCaseSchedule",SeletedProjectId)).then(function(t){var i,u;try{i=JSON.parse(t.getProjectNameByIDResult);SeletedProjectName=i[0].ProjectName;n.$emit("UpdateProjectNameHub",SeletedProjectName);n.$emit("ProjectHubGetCall",SeletedProjectName)}catch(r){hideLoading();u={method:"SaveBusinessCaseData_getProjectNameByID",exceptionMessage:"message:"+r.message+" stack:"+r.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",u)).then(function(){alert(errormessage)})}}),n.$emit("UpdateGeneralInfo",!0)):(kf=!0,or(),wr(),hideLoading(),alert("Error occurred in Business case data update."))})})})})}function yr(){o.selectedPrimaryProduct!=null&&o.selectedPrimaryProduct!=""?(o.SelectedProject.PrimaryProductID=o.selectedPrimaryProduct.LookUpMemberID,o.SelectedProject.PrimaryProductName=o.selectedPrimaryProduct.LookUpMemberName):(o.SelectedProject.PrimaryProductID=null,o.SelectedProject.PrimaryProductName=null);o.SelectedProject.OtherImpactedProducts=o.ImpactedProductIds!=null&&o.ImpactedProductIds.length>0?o.ImpactedProductIds.join(","):null;o.selectedPortfolioOwner!=null&&o.selectedPortfolioOwner!=""?(o.SelectedProject.PortfolioOwnerID=o.selectedPortfolioOwner.LookUpMemberID,o.SelectedProject.PortfolioOwner=o.selectedPortfolioOwner.LookUpMemberName):(o.SelectedProject.PortfolioOwnerID=null,o.SelectedProject.PortfolioOwner=null);o.SelectedProject.ExecutionScopeID=o.ExecutionScopeIds!=null&&o.ExecutionScopeIds.length>0?o.ExecutionScopeIds.join(","):null;$("#ddlSponsor").data("kendoComboBox")!=null&&$("#ddlSponsor").data("kendoComboBox").selectedIndex!=-1?(o.SelectedProject.SponsorId=$("#ddlSponsor").data("kendoComboBox").value(),o.SelectedProject.SponsorName=$("#ddlSponsor").data("kendoComboBox").text()):(o.SelectedProject.SponsorId=null,o.SelectedProject.SponsorName=null);$("#ddlbusinessCaseAuthor").data("kendoComboBox")!=null&&$("#ddlbusinessCaseAuthor").data("kendoComboBox").selectedIndex!=-1?(o.SelectedProject.BusinessCaseAuthorID=$("#ddlbusinessCaseAuthor").data("kendoComboBox").value(),o.SelectedProject.BusinessCaseAuthorName=$("#ddlbusinessCaseAuthor").data("kendoComboBox").text()):(o.SelectedProject.BusinessCaseAuthorID=null,o.SelectedProject.BusinessCaseAuthorName=null);var n="",i=$("#ddl_GI_AdditionalAuthorsContributor").data("kendoMultiSelect"),t=i.value();t!=null&&t.length>0?(angular.forEach(t,function(t){n=n+","+t}),n=n.substring(1,n.length),o.SelectedProject.AdditionalAuthorsContributorsID=n):o.SelectedProject.AdditionalAuthorsContributorsID=null;$("#peopleRating").data("kendoComboBox")!=null&&$("#peopleRating").data("kendoComboBox").value()!=""&&$("#peopleRating").data("kendoComboBox").value()!=null?(o.businessOptionInfoSelector.People=o.selectedBCPeopleRating.LookUpMemberName,o.businessOptionInfoSelector.PeopleRatingID=o.selectedBCPeopleRating.LookUpMemberID):(o.businessOptionInfoSelector.People=null,o.businessOptionInfoSelector.PeopleRatingID=null);$("#technologyRating").data("kendoComboBox")!=null&&$("#technologyRating").data("kendoComboBox").value()!=""&&$("#technologyRating").data("kendoComboBox").value()!=null?(o.businessOptionInfoSelector.Technology=o.selectedBCTechnologyRating.LookUpMemberName,o.businessOptionInfoSelector.TechnologyRatingID=o.selectedBCTechnologyRating.LookUpMemberID):(o.businessOptionInfoSelector.Technology=null,o.businessOptionInfoSelector.TechnologyRatingID=null);$("#businessProcessRating").data("kendoComboBox")!=null&&$("#businessProcessRating").data("kendoComboBox").value()!=""&&$("#businessProcessRating").data("kendoComboBox").value()!=null?(o.businessOptionInfoSelector.BusinessCaseProcess=o.selectedBCBusinessCaseProcess.LookUpMemberName,o.businessOptionInfoSelector.BusinessCaseProcessID=o.selectedBCBusinessCaseProcess.LookUpMemberID):(o.businessOptionInfoSelector.BusinessCaseProcess=null,o.businessOptionInfoSelector.BusinessCaseProcessID=null);$("#manufacturingRating").data("kendoComboBox")!=null&&$("#manufacturingRating").data("kendoComboBox").value()!=""&&$("#manufacturingRating").data("kendoComboBox").value()!=null?(o.businessOptionInfoSelector.ManufacturingProcess=o.selectedBCManufacturingProcess.LookUpMemberName,o.businessOptionInfoSelector.ManufacturingProcessID=o.selectedBCManufacturingProcess.LookUpMemberID):(o.businessOptionInfoSelector.ManufacturingProcess=null,o.businessOptionInfoSelector.ManufacturingProcessID=null);$("#equipmentRating").data("kendoComboBox")!=null&&$("#equipmentRating").data("kendoComboBox").value()!=""&&$("#equipmentRating").data("kendoComboBox").value()!=null?(o.businessOptionInfoSelector.Equipment=o.selectedBCEquipmentRating.LookUpMemberName,o.businessOptionInfoSelector.EquipmentRatingID=o.selectedBCEquipmentRating.LookUpMemberID):(o.businessOptionInfoSelector.Equipment=null,o.businessOptionInfoSelector.EquipmentRatingID=null);$("#functions1").data("kendoComboBox")!=null&&$("#functions1").data("kendoComboBox").value()!=""&&$("#functions1").data("kendoComboBox").value()!=null&&(o.businessOptionInfoSelector.FunctionsRequiredID=$("#functions1").data("kendoComboBox").value());$("#impactOpt1").data("kendoComboBox")!=null&&$("#impactOpt1").data("kendoComboBox").value()!=null&&$("#impactOpt1").data("kendoComboBox").value()!=""&&(o.businessOptionInfoSelector.ImpactMultiplierID=$("#impactOpt1").data("kendoComboBox").value());$("#InlineProductOpt1").data("kendoComboBox")!=null&&$("#InlineProductOpt1").data("kendoComboBox").value()!=""&&$("#InlineProductOpt1").data("kendoComboBox").value()!=null&&(o.businessOptionInfoSelector.InLineProductID=$("#InlineProductOpt1").data("kendoComboBox").value());$("#peopleRating2").data("kendoComboBox")!=null&&$("#peopleRating2").data("kendoComboBox").value()!=""&&$("#peopleRating2").data("kendoComboBox").value()!=null?(o.businessOption2InfoSelector.People=o.selectedBCPeopleRatingOption2.LookUpMemberName,o.businessOption2InfoSelector.PeopleRatingID=o.selectedBCPeopleRatingOption2.LookUpMemberID):(o.businessOption2InfoSelector.People=null,o.businessOption2InfoSelector.PeopleRatingID=null);$("#technologyRating2").data("kendoComboBox")!=null&&$("#technologyRating2").data("kendoComboBox").value()!=""&&$("#technologyRating2").data("kendoComboBox").value()!=null?(o.businessOption2InfoSelector.Technology=o.selectedBCTechnologyRatingOption2.LookUpMemberName,o.businessOption2InfoSelector.TechnologyRatingID=o.selectedBCTechnologyRatingOption2.LookUpMemberID):(o.businessOption2InfoSelector.Technology=null,o.businessOption2InfoSelector.TechnologyRatingID=null);$("#businessProcessRating2").data("kendoComboBox")!=null&&$("#businessProcessRating2").data("kendoComboBox").value()!=""&&$("#businessProcessRating2").data("kendoComboBox").value()!=null?(o.businessOption2InfoSelector.BusinessCaseProcess=o.selectedBCBusinessCaseProcessOption2.LookUpMemberName,o.businessOption2InfoSelector.BusinessCaseProcessID=o.selectedBCBusinessCaseProcessOption2.LookUpMemberID):(o.businessOption2InfoSelector.BusinessCaseProcess=null,o.businessOption2InfoSelector.BusinessCaseProcessID=null);$("#manufacturingRating2").data("kendoComboBox")!=null&&$("#manufacturingRating2").data("kendoComboBox").value()!=""&&$("#manufacturingRating2").data("kendoComboBox").value()!=null?(o.businessOption2InfoSelector.ManufacturingProcess=o.selectedBCManufacturingProcessoption2.LookUpMemberName,o.businessOption2InfoSelector.ManufacturingProcessID=o.selectedBCManufacturingProcessoption2.LookUpMemberID):(o.businessOption2InfoSelector.ManufacturingProcess=null,o.businessOption2InfoSelector.ManufacturingProcessID=null);$("#equipmentRating2").data("kendoComboBox")!=null&&$("#equipmentRating2").data("kendoComboBox").value()!=""&&$("#equipmentRating2").data("kendoComboBox").value()!=null?(o.businessOption2InfoSelector.Equipment=o.selectedBCEquipmentRatingOption2.LookUpMemberName,o.businessOption2InfoSelector.EquipmentRatingID=o.selectedBCEquipmentRatingOption2.LookUpMemberID):(o.businessOption2InfoSelector.Equipment=null,o.businessOption2InfoSelector.EquipmentRatingID=null);$("#functions2").data("kendoComboBox")!=null&&$("#functions2").data("kendoComboBox").value()!=""&&$("#functions2").data("kendoComboBox").value()!=null&&(o.businessOption2InfoSelector.FunctionsRequiredID=$("#functions2").data("kendoComboBox").value());$("#impactOpt2").data("kendoComboBox")!=null&&$("#impactOpt2").data("kendoComboBox").value()!=""&&$("#impactOpt2").data("kendoComboBox").value()!=null&&(o.businessOption2InfoSelector.ImpactMultiplierID=$("#impactOpt2").data("kendoComboBox").value());$("#InlineProductOpt2").data("kendoComboBox")!=null&&$("#InlineProductOpt2").data("kendoComboBox").value()!=""&&$("#InlineProductOpt2").data("kendoComboBox").value()!=null&&(o.businessOption2InfoSelector.InLineProductID=$("#InlineProductOpt2").data("kendoComboBox").value());$("#peopleRating3").data("kendoComboBox")!=null&&$("#peopleRating3").data("kendoComboBox").value()!=""&&$("#peopleRating3").data("kendoComboBox").value()!=null?(o.businessOption3InfoSelector.People=o.selectedBCPeopleRatingOption3.LookUpMemberName,o.businessOption3InfoSelector.PeopleRatingID=o.selectedBCPeopleRatingOption3.LookUpMemberID):(o.businessOption3InfoSelector.People=null,o.businessOption3InfoSelector.PeopleRatingID=null);$("#technologyRating3").data("kendoComboBox")!=null&&$("#technologyRating3").data("kendoComboBox").value()!=""&&$("#technologyRating3").data("kendoComboBox").value()!=null?(o.businessOption3InfoSelector.Technology=o.selectedBCTechnologyRatingOption3.LookUpMemberName,o.businessOption3InfoSelector.TechnologyRatingID=o.selectedBCTechnologyRatingOption3.LookUpMemberID):(o.businessOption3InfoSelector.Technology=null,o.businessOption3InfoSelector.TechnologyRatingID=null);$("#businessProcessRating3").data("kendoComboBox")!=null&&$("#businessProcessRating3").data("kendoComboBox").value()!=""&&$("#businessProcessRating3").data("kendoComboBox").value()!=null?(o.businessOption3InfoSelector.BusinessCaseProcess=o.selectedBCBusinessCaseProcessOption3.LookUpMemberName,o.businessOption3InfoSelector.BusinessCaseProcessID=o.selectedBCBusinessCaseProcessOption3.LookUpMemberID):(o.businessOption3InfoSelector.BusinessCaseProcess=null,o.businessOption3InfoSelector.BusinessCaseProcessID=null);$("#manufacturingRating3").data("kendoComboBox")!=null&&$("#manufacturingRating3").data("kendoComboBox").value()!=""&&$("#manufacturingRating3").data("kendoComboBox").value()!=null?(o.businessOption3InfoSelector.ManufacturingProcess=o.selectedBCManufacturingProcessOption3.LookUpMemberName,o.businessOption3InfoSelector.ManufacturingProcessID=o.selectedBCManufacturingProcessOption3.LookUpMemberID):(o.businessOption3InfoSelector.ManufacturingProcess=null,o.businessOption3InfoSelector.ManufacturingProcessID=null);$("#equipmentRating3").data("kendoComboBox")!=null&&$("#equipmentRating3").data("kendoComboBox").value()!=""&&$("#equipmentRating3").data("kendoComboBox").value()!=null?(o.businessOption3InfoSelector.Equipment=o.selectedBCEquipmentRatingOption3.LookUpMemberName,o.businessOption3InfoSelector.EquipmentRatingID=o.selectedBCEquipmentRatingOption3.LookUpMemberID):(o.businessOption3InfoSelector.Equipment=null,o.businessOption3InfoSelector.EquipmentRatingID=null);$("#functions3").data("kendoComboBox")!=null&&$("#functions3").data("kendoComboBox").value()!=""&&$("#functions3").data("kendoComboBox").value()!=null&&(o.businessOption3InfoSelector.FunctionsRequiredID=$("#functions3").data("kendoComboBox").value());$("#impactOpt3").data("kendoComboBox")!=null&&$("#impactOpt3").data("kendoComboBox").value()!=""&&$("#impactOpt3").data("kendoComboBox").value()!=null&&(o.businessOption3InfoSelector.ImpactMultiplierID=$("#impactOpt3").data("kendoComboBox").value());$("#InlineProductOpt3").data("kendoComboBox")!=null&&$("#InlineProductOpt3").data("kendoComboBox").value()!=""&&$("#InlineProductOpt3").data("kendoComboBox").value()!=null&&(o.businessOption3InfoSelector.InLineProductID=$("#InlineProductOpt3").data("kendoComboBox").value());pi==!0&&(o.businessOptionInfoSelector.ExecutionStartDate=kendo.toString(kendo.parseDate(o.businessOptionInfoSelector.ExecutionStartDate),"MM/dd/yyyy"),o.businessOptionInfoSelector.ExecutionEndDate=kendo.toString(kendo.parseDate(o.businessOptionInfoSelector.ExecutionEndDate),"MM/dd/yyyy"),o.businessOptionInfoSelector.AssetInService=kendo.toString(kendo.parseDate(o.businessOptionInfoSelector.AssetInService),"MM/dd/yyyy"),o.businessOptionInfoSelector.ProjectSpendStart=kendo.toString(kendo.parseDate(o.businessOptionInfoSelector.ProjectSpendStart),"MM/dd/yyyy"),o.businessOption2InfoSelector.ExecutionStartDate=kendo.toString(kendo.parseDate(o.businessOption2InfoSelector.ExecutionStartDate),"MM/dd/yyyy"),o.businessOption2InfoSelector.ExecutionEndDate=kendo.toString(kendo.parseDate(o.businessOption2InfoSelector.ExecutionEndDate),"MM/dd/yyyy"),o.businessOption2InfoSelector.AssetInService=kendo.toString(kendo.parseDate(o.businessOption2InfoSelector.AssetInService),"MM/dd/yyyy"),o.businessOption2InfoSelector.ProjectSpendStart=kendo.toString(kendo.parseDate(o.businessOption2InfoSelector.ProjectSpendStart),"MM/dd/yyyy"),o.businessOption3InfoSelector.ExecutionStartDate=kendo.toString(kendo.parseDate(o.businessOption3InfoSelector.ExecutionStartDate),"MM/dd/yyyy"),o.businessOption3InfoSelector.ExecutionEndDate=kendo.toString(kendo.parseDate(o.businessOption3InfoSelector.ExecutionEndDate),"MM/dd/yyyy"),o.businessOption3InfoSelector.AssetInService=kendo.toString(kendo.parseDate(o.businessOption3InfoSelector.AssetInService),"MM/dd/yyyy"),o.businessOption3InfoSelector.ProjectSpendStart=kendo.toString(kendo.parseDate(o.businessOption3InfoSelector.ProjectSpendStart),"MM/dd/yyyy"))}function pr(){var n=new kendo.data.DataSource({data:o.dsProjectScopeData,group:{field:"ProjectScope",compare:function(n,t){return n.items[0].GroupOrder===t.items[0].GroupOrder?0:n.items[0].GroupOrder>t.items[0].GroupOrder?1:-1}},schema:{model:{fields:{ProjectScope:{type:"string",hidden:!0},Category:{type:"string",editable:!1},BaseCase:{type:"number",editable:!1},HighCase:{type:"number",editable:!1},GroupOrder:{type:"number",editable:!1}}}}});$("#GridBCTopsProjectScope").kendoGrid({dataSource:n,columns:[{field:"ProjectScope",title:"ProjectScope",hidden:!0},{field:"GroupOrder",title:"GroupOrder",hidden:!1},{field:"Category",title:"Category"},{field:"BaseCase",title:"Base Case",template:"#= (InCurrency ==1 ) ?  kendo.toString(BaseCase, 'n0')+' '+LocalCurrencyAbb :  kendo.toString(BaseCase, 'n1')#",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"txt-float-R"}},{field:"HighCase",title:"High Case",template:"#= (InCurrency ==1 ) ? kendo.toString(HighCase, 'n0')+' '+LocalCurrencyAbb :  kendo.toString(HighCase, 'n1')#",attributes:{"class":"txt-float-R"},headerAttributes:{"class":"txt-float-R"}}]})}function re(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(ii)}},group:{field:"ParentKPI",compare:function(n,t){return n.items[0].GroupOrder===t.items[0].GroupOrder?0:n.items[0].GroupOrder>t.items[0].GroupOrder?1:-1}},sort:{field:"KPIOrder",dir:"asc"},schema:{model:{id:"BusinessKPIUniqueID",fields:{KPIName:{type:"string",editable:!1},KPIID:{hidden:!0},ParentKPI:{hidden:!0},LookUpName:{type:"string",defaultValue:"No Impact",editable:o.isEditable},KPIOrder:{type:"number",editable:!1}}}}});$("#gridOption1Tops").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:o.isEditable,columns:[{field:"KPIName",title:"KPIs",headerAttributes:{"class":"wrap-header"},groupHeaderTemplate:"#= value #"},{field:"ParentKPI",title:"ParentKPI",hidden:!0,groupHeaderTemplate:"#= value #"},{field:"LookUpValue",title:"KPI Impact",values:fi}],dataBound:function(){var u,n,t,r;if(o.NoImpactSelected=!0,u=$("#gridOption1Tops").data("kendoGrid"),n=this._data.map(function(n){return n}),n.length>0)for(t=0;t<n.length;t++)if(r=n[t].LookUpValue,r!=topsKPIDefaultValue){o.NoImpactSelected=!1;i.$digest();break}},edit:function(n){n.container.find('[name="LookUpValue"]').data("kendoDropDownList")!=undefined&&n.container.find('[name="LookUpValue"]').data("kendoDropDownList").bind("change",function(){var n=$("#gridOption1Tops").data("kendoGrid"),t=n.dataItem(this.wrapper.parents("tr")),r,u;t.LookUpValue!=topsKPIDefaultValue&&o.NoImpactSelected===!0?(o.NoImpactSelected=!1,i.$digest()):t.LookUpValue===topsKPIDefaultValue&&o.NoImpactSelected===!1&&(r=n.dataItems(),u=r.filter(function(n){return n.LookUpValue!=topsKPIDefaultValue}),u.length==0&&(o.NoImpactSelected=!0,i.$digest()))})}})}function ue(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(ri)}},group:{field:"ParentKPI"},sort:{field:"KPIOrder",dir:"asc"},schema:{model:{id:"BusinessKPIUniqueID",fields:{KPIName:{type:"string",editable:!1},KPIID:{hidden:!0},ParentKPI:{hidden:!0},LookUpName:{type:"string",defaultValue:"No Impact",editable:o.isEditable},KPIOrder:{type:"number",editable:!1}}}}});$("#gridOption2Tops").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:o.isEditable,columns:[{field:"KPIName",title:"KPIs",headerAttributes:{"class":"wrap-header"},groupHeaderTemplate:"#= value #"},{field:"ParentKPI",title:"ParentKPI",hidden:!0,groupHeaderTemplate:"#= value #"},{field:"LookUpValue",title:"KPI Impact",values:fi}],dataBound:function(){var u,n,t,r;if(o.NoImpactSelected2=!0,u=$("#gridOption2Tops").data("kendoGrid"),n=this._data.map(function(n){return n}),n.length>0)for(t=0;t<n.length;t++)if(r=n[t].LookUpValue,r!=topsKPIDefaultValue){o.NoImpactSelected2=!1;i.$digest();break}},edit:function(n){n.container.find('[name="LookUpValue"]').data("kendoDropDownList")!=undefined&&n.container.find('[name="LookUpValue"]').data("kendoDropDownList").bind("change",function(){var n=$("#gridOption2Tops").data("kendoGrid"),t=n.dataItem(this.wrapper.parents("tr")),r,u;t.LookUpValue!=topsKPIDefaultValue&&o.NoImpactSelected2===!0?(o.NoImpactSelected2=!1,i.$digest()):t.LookUpValue===topsKPIDefaultValue&&o.NoImpactSelected2===!1&&(r=n.dataItems(),u=r.filter(function(n){return n.LookUpValue!=topsKPIDefaultValue}),u.length==0&&(o.NoImpactSelected2=!0,i.$digest()))})}})}function fe(){var n=new kendo.data.DataSource({transport:{read:function(n){n.success(ui)}},group:{field:"ParentKPI"},sort:{field:"KPIOrder",dir:"asc"},schema:{model:{id:"BusinessKPIUniqueID",fields:{KPIName:{type:"string",editable:!1},KPIID:{hidden:!0},ParentKPI:{hidden:!0},LookUpName:{type:"string",defaultValue:"No Impact",editable:o.isEditable},KPIOrder:{type:"number",editable:!1}}}}});$("#gridOption3Tops").kendoGrid({dataSource:n,groupable:!1,sortable:!0,editable:o.isEditable,columns:[{field:"KPIName",title:"KPIs",headerAttributes:{"class":"wrap-header"},groupHeaderTemplate:"#= value #"},{field:"ParentKPI",title:"ParentKPI",hidden:!0,groupHeaderTemplate:"#= value #"},{field:"LookUpValue",title:"KPI Impact",values:fi}],dataBound:function(){var u,n,t,r;if(o.NoImpactSelected3=!0,u=$("#gridOption3Tops").data("kendoGrid"),n=this._data.map(function(n){return n}),n.length>0)for(t=0;t<n.length;t++)if(r=n[t].LookUpValue,r!=topsKPIDefaultValue){o.NoImpactSelected3=!1;i.$digest();break}},edit:function(n){n.container.find('[name="LookUpValue"]').data("kendoDropDownList")!=undefined&&n.container.find('[name="LookUpValue"]').data("kendoDropDownList").bind("change",function(){var n=$("#gridOption3Tops").data("kendoGrid"),t=n.dataItem(this.wrapper.parents("tr")),r,u;t.LookUpValue!=topsKPIDefaultValue&&o.NoImpactSelected3===!0?(o.NoImpactSelected3=!1,i.$digest()):t.LookUpValue===topsKPIDefaultValue&&o.NoImpactSelected3===!1&&(r=n.dataItems(),u=r.filter(function(n){return n.LookUpValue!=topsKPIDefaultValue}),u.length==0&&(o.NoImpactSelected3=!0,i.$digest()))})}})}function er(n){var t=[],i=$("#"+n).data("kendoGrid").dataSource.data().filter(function(n){return n.dirty}).map(function(n){return n});return angular.forEach(i,function(n){var i={BusinessKPIUniqueID:n.id,ProjectID:SeletedProjectId,KPIID:n.KPIID,KPIValueID:n.LookUpValue};t.push(i)}),t}function wr(){ft=[];c=[];v=[];y=[];var n={ProjectID:SeletedProjectId,DataType:"BusinessCaseTemplateDetails"},t={ProjectID:SeletedProjectId,DataType:"Template"};$.when(f.getDataWCFAsync("getBusinessCaseOptionByProjectID/"+SeletedProjectId),f.postDataWCFAsync("getBusinessCaseBudgetFunding",SeletedProjectId),f.postDataWCFAsync("getBusinessCaseKeyAssumption",SeletedProjectId),f.postDataWCFAsync("getBusinessCaseRiskIssue",SeletedProjectId),f.postDataWCFAsync("getGetBusinessCaseKeySuccess",SeletedProjectId),f.postDataWCFAsync("getBusinessCaseSchedule",SeletedProjectId),f.postDataWCFAsync("getBusinessCaseCapsDetails",SeletedProjectId),f.postDataWCFAsync("getMilestoneSetProjectHub",t),f.postDataWCFAsync("getMilestoneSetProjectHub",n),f.postDataWCFAsync("getBusinessCaseCAPSWaterWasteByProjectID",SeletedProjectId)).then(function(n,t,i,r,u,e,s,h,c,v){var p,ft,et,ot,ut,y,ht;try{rt=JSON.parse(h);kt=JSON.parse(c);p=new kendo.data.DataSource({data:rt});ft=$("#gridBCOptAddMilestones").data("kendoGrid");p.read();ft.setDataSource(p);et=$("#gridBCOptAddMilestones2").data("kendoGrid");et.setDataSource(p);ot=$("#gridBCOptAddMilestones3").data("kendoGrid");ot.setDataSource(p);ut=JSON.parse(v.getBusinessCaseCAPSWaterWasteByProjectIDResult);ai=ut.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1});vi=ut.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2});yi=ut.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3});y=JSON.parse(n.getBusinessCaseOptionByProjectIDResult);o.businessOptionInfoSelector=y.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1})[0]!=undefined?y.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1})[0]:y.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1});o.businessOption2InfoSelector=y.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2})[0]!=undefined?y.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2})[0]:y.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2});o.businessOption3InfoSelector=y.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3})[0]!=undefined?y.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3})[0]:y.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3});o.businessOptionInfoSelector.OpexRequired==!0?(o.showOpex="1",o.businessOptionInfoSelector.OpexRequired=!0):(o.showOpex="0",o.businessOptionInfoSelector.OpexRequired=!1);o.businessOptionInfoSelector.CapexRequired==!0?(o.showCapex="1",o.businessOptionInfoSelector.CapexRequired=!0):(o.showCapex="0",o.businessOptionInfoSelector.CapexRequired=!1);o.businessOption2InfoSelector.OpexRequired==!0?(o.showOpexOpt2="1",o.businessOption2InfoSelector.OpexRequired=!0):(o.showOpexOpt2="0",o.businessOption2InfoSelector.OpexRequired=!1);o.businessOption2InfoSelector.CapexRequired==!0?(o.showCapexOpt2="1",o.businessOption2InfoSelector.CapexRequired=!0):(o.showCapexOpt2="0",o.businessOption2InfoSelector.CapexRequired=!1);o.businessOption3InfoSelector.OpexRequired==!0?(o.showOpexOpt3="1",o.businessOption3InfoSelector.OpexRequired=!0):(o.showOpexOpt3="0",o.businessOption3InfoSelector.OpexRequired=!1);o.businessOption3InfoSelector.CapexRequired==!0?(o.showCapexOpt3="1",o.businessOption3InfoSelector.CapexRequired=!0):(o.showCapexOpt3="0",o.businessOption3InfoSelector.CapexRequired=!1);d=JSON.parse(t.getBusinessCaseBudgetFundingResult);g=JSON.parse(i.getBusinessCaseKeyAssumptionResult);nt=JSON.parse(r.getBusinessCaseRiskIssueResult);tt=JSON.parse(u.getGetBusinessCaseKeySuccessResult);a=JSON.parse(e.getBusinessCaseScheduleResult);it=JSON.parse(s.getBusinessCaseCapsDetailsResult);o.dsBCScheduleOpt1=a.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1});o.dsBCScheduleOpt2=a.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2});o.dsBCScheduleOpt3=a.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3});o.dsBCKeySuccessOpt1=tt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1});o.dsBCKeySuccessOpt2=tt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2});o.dsBCKeySuccessOpt3=tt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3});o.dsBCRiskIssueOpt1=nt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1});o.dsBCRiskIssueOpt2=nt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2});o.dsBCRiskIssueOpt3=nt.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3});o.dsBCKeyAssumptionOpt1=g.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1});o.dsBCKeyAssumptionOpt2=g.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2});o.dsBCKeyAssumptionOpt3=g.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3});o.dsBCBudgetFundingOpt1=d.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1});o.dsBCBudgetFundingOpt2=d.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2});o.dsBCBudgetFundingOpt3=d.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3});o.formattedCalculatedEmissionsImpact1=kendo.toString(o.businessOptionInfoSelector.CalculatedEmissionsImpact,"n1");o.formattedCalculatedEmissionsImpact2=kendo.toString(o.businessOption2InfoSelector.CalculatedEmissionsImpact,"n1");o.formattedCalculatedEmissionsImpact3=kendo.toString(o.businessOption3InfoSelector.CalculatedEmissionsImpact,"n1");w=it.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1});angular.copy(w,dt);b=it.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2});angular.copy(b,gt);k=it.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3});angular.copy(k,ni);$("#gridBusinessCaseOptTimeline").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptAssumption").data("kendoGrid").dataSource.read();$("#gridBusinessCaseFunding").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptKeySuccessCriteria").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptRisk").data("kendoGrid").dataSource.read();$("#gridCapsOpt1").data("kendoGrid").dataSource.read();$("#gridCapsWaterWasteOpt1").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOpt2Timeline").data("kendoGrid").dataSource.read();$("#gridBusinessCaseFundingOption2").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptKeySuccessCriteriaOption2").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptAssumptionOption2").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptRiskOption2").data("kendoGrid").dataSource.read();$("#gridCapsOpt2").data("kendoGrid").dataSource.read();$("#gridCapsWaterWasteOpt2").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOpt3Timeline").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptAssumptionOption3").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptRiskOption3").data("kendoGrid").dataSource.read();$("#gridBusinessCaseFundingOption3").data("kendoGrid").dataSource.read();$("#gridBusinessCaseOptKeySuccessCriteriaOption3").data("kendoGrid").dataSource.read();$("#gridCapsOpt3").data("kendoGrid").dataSource.read();$("#gridCapsWaterWasteOpt3").data("kendoGrid").dataSource.read();yr();wt={};angular.copy(o.SelectedProject,wt);at={};angular.copy(o.businessOptionInfoSelector,at);vt={};angular.copy(o.businessOption2InfoSelector,vt);yt={};angular.copy(o.businessOption3InfoSelector,yt)}catch(st){hideLoading();ht={method:"getDataForGrids",exceptionMessage:"message:"+st.message+" stack:"+st.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",ht)).then(function(){alert(errormessage)})}})}function or(){$.when(f.postDataWCFAsync("getBusinessCaseTOPSKPI",SeletedProjectId)).then(function(n){try{ti=JSON.parse(n.getBusinessCaseTOPSKPIResult);ii=ti.filter(function(n){return n.BusinessOptionID==BusinessCaseOption1});ri=ti.filter(function(n){return n.BusinessOptionID==BusinessCaseOption2});ui=ti.filter(function(n){return n.BusinessOptionID==BusinessCaseOption3});$("#gridOption1Tops").data("kendoGrid").dataSource.read();$("#gridOption2Tops").data("kendoGrid").dataSource.read();$("#gridOption3Tops").data("kendoGrid").dataSource.read();i.$digest()}catch(t){hideLoading();var r={method:"getDataForTops",exceptionMessage:"message:"+t.message+" stack:"+t.stack,ErrorParameter:l};$.when(f.postDataWCFAsync("WriteErrorLog",r)).then(function(){alert(errormessage)})}})}function sr(n,t){$('<input name="'+t.field+'" data-bind="value:'+t.field+'"/>').appendTo(n).kendoNumericTextBox({spinners:!1,decimals:0,format:"n0",restrictDecimals:!0,max:9999999999,min:-9999999999})}function ee(){}var o=this,l,s;o.dsBCPrimaryProduct=[];o.dsProgram=[];o.buildNo=buildNo;o.releaseDate=releaseDate;o.dsFeasibilityPeople=[];o.dsFeasibilityTechnology=[];o.dsFeasibilityBusiness=[];o.dsFeasibilityManufacturing=[];o.dsFeasibilityEquipment=[];o.dsFundingType=[];o.dsBCFunctionalOwner=[];o.deletedMilestoneData=[];o.deletedRiskData=[];o.deletedKeySuccessData=[];o.deletedAssumptionData=[];o.deletedFundingData=[];o.isOption2=!0;o.isOption3=!0;o.NoImpactSelected=!0;o.NoImpactSelected2=!0;o.NoImpactSelected3=!0;o.isCapsProjectChecked=!0;o.dateFormatlabel=dateLabel;o.dateErrorMsg=InValidDateFormat;o.deletedMilestoneDataOption2=[];o.deletedFundingDataOption2=[];o.deletedRiskDataOption2=[];o.deletedKeySuccessDataOption2=[];o.deletedAssumptionDataOption2=[];var dt=[],gt=[],ni=[];o.deletedMilestoneDataOption3=[];o.deletedFundingDataOption3=[];o.deletedRiskDataOption3=[];o.deletedKeySuccessDataOption3=[];o.deletedAssumptionDataOption3=[];var ti=[],ii=[],ri=[],ui=[],fi=[];o.dsTopsFunctions=[];o.dsTopsImpactMultiplier=[];o.dsTopsInLineProductStrategy=[];o.dsTopsProducts=[];o.dsAdditionalAuthList=[];o.localCurrencyAbbre;var et=[],ot=[],st=[],ht=[],p=[],ct=[],lt=[],d=[],g=[],nt=[],tt=[],a=[],ei=0,hr=!1,pi=!1,oi="",si="",hi="",wt={},at={},vt={},yt={},w=[],b=[],k=[],bt=[],ut=[],ci=[],li=[],cr=[],lr=[],ar=[],ai=[],vi=[],yi=[],it=[];o.SelectedProject={};o.tops={};o.businessOptionInfoSelector={};o.businessOption2InfoSelector={};o.businessOption3InfoSelector={};o.dsBCScheduleOpt1=[];o.dsBCScheduleOpt2=[];o.dsBCScheduleOpt3=[];o.dsBCKeySuccessOpt1={};o.dsBCKeySuccessOpt2={};o.dsBCKeySuccessOpt3={};o.dsBCRiskIssueOpt1={};o.dsBCRiskIssueOpt2={};o.dsBCRiskIssueOpt3={};o.dsBCKeyAssumptionOpt1={};o.dsBCKeyAssumptionOpt2={};o.dsBCKeyAssumptionOpt3={};o.dsBCBudgetFundingOpt1={};o.dsBCBudgetFundingOpt2={};o.dsBCBudgetFundingOpt3={};o.initBusinessCase=ee;o.SaveBusinessCaseData=ie;o.businessCase=businessCase;o.OpenBusinessCaseDialog=pu;o.businessCasePagepath=businessCasePagepath;o.changeShowOpex=lu;o.AddNewRow=hu;o.recommendOnChange=su;o.onChangeCarbonImpact=wu;o.onChangeWWCostImpact=bu;o.businessDialogClose=yu;o.clearOption=ou;o.trackEventFunc=iu;o.GetBCProjectScopeDialog=ru;o.CheckBulkEditGridUpdateBC=kr;o.AddMilestoneBCOpt=dr;o.showOpexDiv=!1;o.showOpex=0;o.dsProjectScopeData=[];o.changeShowCapex=cu;o.showCapexDiv=!1;o.showCapex=0;o.isEditable=!1;o.isPortfolioOwnerEditableBC=!1;l="BusinessCaseCtrl";o.localCurrencyAbbrePlaceholder;var rt=[],kt=[],ft=[],c=[],v=[],y=[];o.capsProjectTooltipBC=capsProjectTooltip;o.environmentalTootltipBC=environmentalTootltip;s=function(n,t){return n.dirty&&n.dirtyFields[t]?"<span class='k-dirty'><\/span>":""}}angular.module("SPOTApp").controller("BusinessCaseCtrl",BusinessCaseCtrl);BusinessCaseCtrl.$inject=["$rootScope","$filter","$scope","$http","$q","GETPostService"];