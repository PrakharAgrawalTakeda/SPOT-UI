function TopMenuCtrl(n,t,i,r,u,f){function rt(n){trackEvent(n)}function ut(n){var t,i,u;trackEvent("Search project on top bar");try{n.keyCode!==13&&(t=$("#ProjSearch").data("kendoAutoComplete"),t!=undefined&&t!=null&&(t.close(),t.destroy()));n.keyCode===13&&(displayLoading(),i={strUserAdId:currentUserId,strFilterString:e.projselect},$.when(f.postDataWCFAsync("getProjectByUserId",i)).then(function(n){var t,r;try{hideLoading();k=JSON.parse(n);e.dsProjectSearch=k.filter(function(n){if(n.ProjectText!=null&&n.ProjectText!=undefined)return n.ProjectText.toLowerCase().indexOf(e.projselect.toLowerCase())>=0});$("#ProjSearch").kendoAutoComplete({dataTextField:"ProjectText",dataValueField:"UrlPostfix",filter:"contains",dataSource:{data:e.dsProjectSearch},select:function(n){this.close();this.value("");this.destroy();var t=n.dataItem.UrlPostfix,i=window.location.protocol+"//"+window.location.host+projectHubpathAbs+"?"+t;window.open(i,"_blank")}});t=$("#ProjSearch").data("kendoAutoComplete");t.search(e.projselect)}catch(i){hideLoading();r={method:"GetSearchedProjects",exceptionMessage:"message:"+i.message+" stack:"+i.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",r)).then(function(){alert(errormessage)})}}));$("#ProjSearch").next("span").next("span").hasClass("k-i-loading")&&$("#ProjSearch").next("span").next("span").hide()}catch(r){hideLoading();u={method:"GetSearchedProjects",exceptionMessage:"message:"+r.message+" stack:"+r.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",u)).then(function(){alert(errormessage)})}}function ft(){trackEvent("Log out");window.location.href=authUrl+"/.auth/logout"}function et(){window.open(projectHubpath+"?"+e.redirectProject.UrlPostfix,"_blank")}function ot(n){var t=$("#"+n).data("kendoComboBox");t.setDataSource([]);t.value("");e.projectTypeSelector.ParentProgram=""}function nt(n){var t=$("#"+n);t.data("kendoWindow").open()}function st(){var n,i;try{displayLoading();e.ProjectTypeSelectorListItems=[];n=$("#DialogProjectTypeSelector");n.data("kendoWindow").open();$.when(f.getDataWCF("getProjectTypeSelectorData")).then(function(n){h=JSON.parse(n.getProjectTypeSelectorDataResult);angular.forEach(h,function(n){n.ImageName=imageFolderPath+"/"+n.ProjectTypeImageName;n.PageName=htmlfilepath+"/"+n.PageName+"?v="+buildNo;e.ProjectTypeSelectorListItems.push(n)})});ht()}catch(t){hideLoading();i={method:"ProjectTypeSelector",exceptionMessage:"message:"+t.message+" stack:"+t.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",i)).then(function(){alert(errormessage)})}}function ht(){var n,u;try{var s=new Date,h={ProjectUID:"",UserID:currentUserId};console.log("DB call started people picker "+s.toString());n=portfolioOwner+","+product+","+campaignType+","+campaignPhase+","+ProductionStep+","+qualityReferenceType+","+oeProjectType+","+executionScope+","+localCurrency+","+agileAttribute+","+agileWave+","+emissionPortfolio+","+pOBOSCategory+","+siteAssessmentCategory+","+topsPrimaryKpi+","+copyProjectTemplate+","+strategicYear+","+annualMustWin;$.when(f.postDataWCFAsync("getLookupData",n),f.postDataWCFAsync("getUserPermissionById",currentUserId),f.postDataWCFAsync("getPortfolioOwnerWithCurrency",h),f.postDataWCFAsync("getHubSetting","")).then(function(n,r,u,f){var o,h,c,s,a,v;for(e.dsPOCurrency=JSON.parse(u),o=JSON.parse(n.getLookupDataResult),e.dsPrimaryKPI=t("orderBy")(o.filter(function(n){return n.LookUpName==topsPrimaryKpi}),"LookUpMemberOrder"),e.dsUserPermission=JSON.parse(r.getUserPermissionByIdResult).filter(function(n){return n.Permission=="CreateConfidential"}),e.dsPrimaryProduct=o.filter(function(n){return n.LookUpName==product}),e.dsOwner=o.filter(function(n){return n.LookUpName==portfolioOwner}),e.dsExecutionScopeData=t("orderBy")(o.filter(function(n){return n.LookUpName==executionScope}),"LookUpMemberOrder"),e.dsCampaignType=o.filter(function(n){return n.LookUpName==campaignType}),e.dsCampaign=o.filter(function(n){return n.LookUpName===campaignPhase}),e.dsProductionStep=o.filter(function(n){return n.LookUpName==ProductionStep}),e.dsHubSettings=JSON.parse(f.getHubSettingResult),e.dsOEProjectType=t("orderBy")(o.filter(function(n){return n.LookUpName==oeProjectType}),"LookUpMemberOrder"),e.dslocalCurrency=o.filter(function(n){return n.LookUpName==localCurrency}),e.isConfidentialVisible=e.dsUserPermission.length>0?!0:!1,e.dsPrograms=[],l=o.filter(function(n){return n.LookUpName==qualityReferenceType}),e.dsAgilePrimaryWorkstation=o.filter(function(n){return n.LookUpName==agileAttribute}),e.dsAgileWave=o.filter(function(n){return n.LookUpName==agileWave}),e.dsEmissionPortfolio=o.filter(function(n){return n.LookUpName==emissionPortfolio}),h=o.filter(function(n){return n.LookUpName==copyProjectTemplate}),e.CopyProjectTempleList=[],c=disableCopyProjectType.toLowerCase().split(","),angular.forEach(h,function(n){var t={};t.LookUpMemberID=n.LookUpMemberID;t.LookUpMemberName=n.LookUpMemberName;t.checked=!0;t.disable=c.indexOf(n.LookUpMemberID.toLowerCase())>-1?!0:!1;e.CopyProjectTempleList.push(t)}),p=[],s=0;s<l.length;s++)a={text:l[s].LookUpMemberName,value:l[s].LookUpMemberID},p.push(a);v=new Date;console.log("people picker binded "+v.toString());e.dsPrimaryProduct=t("orderBy")(e.dsPrimaryProduct,"LookUpMemberOrder");e.dsImpactedProducts={placeholder:"Select and/or Type to Search",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsPrimaryProduct,filter:"contains"};e.dsExecutionScope={placeholder:"Select scope...",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsExecutionScopeData,filter:"contains"};e.dsExecutionScope1={placeholder:"Select scope...",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsOwner,filter:"contains"};e.dsOEType={placeholder:"Select and/or Type to Search",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsOEProjectType,filter:"contains"};e.dsAgileSecWorkstation={placeholder:"Select secondary workstream...",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsAgilePrimaryWorkstation,filter:"contains"};e.dsPOBOSCategory=o.filter(function(n){return n.LookUpName==pOBOSCategory});e.dsStrategicYear=o.filter(function(n){return n.LookUpName==strategicYear});e.dsAnnualMustWin=o.filter(function(n){return n.LookUpName==annualMustWin});e.dsSiteAssessmentCategory=o.filter(function(n){return n.LookUpName==siteAssessmentCategory});e.dsPOBOSCategories={placeholder:"Select and/or Type to Search",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsPOBOSCategory,filter:"contains"};e.dsSiteAssessmentCategories={placeholder:"Select and/or Type to Search",dataTextField:"LookUpMemberName",dataValueField:"LookUpMemberID",valuePrimitive:!0,autoBind:!1,dataSource:e.dsSiteAssessmentCategory,filter:"contains"};i.$digest();hideLoading()})}catch(r){hideLoading();u={method:"GetProjectTypeData",exceptionMessage:"message:"+r.message+" stack:"+r.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",u)).then(function(){alert(errormessage)})}}function tt(n){f.searchPeople(n,"PeopleSearch")}function it(n){f.searchPeople(n,"PeopleSearchSimple")}function ct(){e.OEProjectVisible=!1;e.projectTypeSelector.OEProjectType=""}function lt(){e.OEProjectVisibleSolution=!1;e.projectTypeSelector.OEProjectType=""}function at(){e.OEProjectVisibleTechOps=!1;e.projectTypeSelector.OEProjectType=""}function vt(){e.OEProjectVisibleTechTransfer=!1;e.projectTypeSelector.OEProjectType=""}function yt(){e.OEProjectVisibleSimple=!1;e.projectTypeSelector.OEProjectTypeSimple=""}function pt(){e.techTransferVisible=!1;e.projectTypeSelector.CampaignType="";e.projectTypeSelector.CampaignPhase="";e.projectTypeSelector.ProductionStepID=""}function wt(){e.standardPOBOSVisible=!1;e.projectTypeSelector.POBOSCategory=""}function bt(){e.simplePOBOSVisible=!1;e.projectTypeSelector.POBOSCategory=""}function kt(){e.simpleGMSGQLTAnnualMustWinVisible=!1;e.projectTypeSelector.StrategicYear="";e.projectTypeSelector.AnnualMustWin=""}function dt(){e.standardGMSGQLTAnnualMustWinVisible=!1;e.projectTypeSelector.StrategicYear="";e.projectTypeSelector.AnnualMustWin=""}function gt(){e.isSiteAssessmentVisible=!1;e.projectTypeSelector.SiteAssessmentCategory=""}function ni(){e.isSimpleSiteAssessmentVisible=!1;e.projectTypeSelector.SiteAssessmentCategory=""}function ti(){e.standardAgileVisible=!1;e.projectTypeSelector.agilePrimaryWorkstation="";e.projectTypeSelector.agileSecWorkstream="";e.projectTypeSelector.agileWave=""}function ii(){e.simpleAgileVisible=!1;e.projectTypeSelector.agilePrimaryWorkstation="";e.projectTypeSelector.agileSecWorkstream="";e.projectTypeSelector.agileWave=""}function ri(){e.standardQualityRef=!1}function ui(n){var l,a,v,y,t,p,i,r,u,it,s,rt,ut,et;try{b=1;displayLoading();w=wi();var h=[],c=[];if(n==e.ProblemCapture){if(l=$("#problemCapture").kendoValidator().data("kendoValidator"),!l.validate())return e.problemCaptureValidationMessage=!0,e.solutionValidationMessage=!1,e.techOpsValidationMessage=!1,e.techTransferValidationMessage=!1,e.simpleProjectValidationMessage=!1,hideLoading(),!1}else if(n==e.SolutionIdentified){if(a=$("#SolutionIdentified").kendoValidator().data("kendoValidator"),!a.validate())return e.solutionValidationMessage=!0,e.problemCaptureValidationMessage=!1,e.techOpsValidationMessage=!1,e.techTransferValidationMessage=!1,e.simpleProjectValidationMessage=!1,hideLoading(),!1}else if(n==e.TechOpsProgram){if(v=$("#TechOpsProgram").kendoValidator().data("kendoValidator"),!v.validate())return e.techOpsValidationMessage=!0,e.solutionValidationMessage=!1,e.problemCaptureValidationMessage=!1,e.techTransferValidationMessage=!1,e.simpleProjectValidationMessage=!1,hideLoading(),!1}else if(n==e.StandardProject){if(t=$("#PeopleSearch").data("kendoComboBox").selectedIndex!=-1?$("#PeopleSearch").data("kendoComboBox")._old:null,y=$("#StandardTechTransfer").kendoValidator().data("kendoValidator"),!y.validate()||$("#ddl_StandardCurrency").data("kendoComboBox").value()&&$("#ddl_StandardCurrency").data("kendoComboBox").select()===-1)return e.techTransferValidationMessage=!0,e.techOpsValidationMessage=!1,e.solutionValidationMessage=!1,e.problemCaptureValidationMessage=!1,e.simpleProjectValidationMessage=!1,hideLoading(),!1}else if(n==e.simpleProject){if(t=$("#PeopleSearchSimple").data("kendoComboBox").selectedIndex!=-1?$("#PeopleSearchSimple").data("kendoComboBox")._old:null,p=$("#simpleProject").kendoValidator().data("kendoValidator"),!p.validate()||$("#simpleLocalCurrency").data("kendoComboBox").value()&&$("#simpleLocalCurrency").data("kendoComboBox").select()===-1)return e.simpleProjectValidationMessage=!0,e.techTransferValidationMessage=!1,e.techOpsValidationMessage=!1,e.solutionValidationMessage=!1,e.problemCaptureValidationMessage=!1,hideLoading(),!1}else e.techTransferValidationMessage=!1,e.techOpsValidationMessage=!1,e.solutionValidationMessage=!1,e.problemCaptureValidationMessage=!1,e.simpleProjectValidationMessage=!1,hideLoading();if(t==null)return e.techTransferValidationMessage=!0,e.techOpsValidationMessage=!1,e.solutionValidationMessage=!1,e.problemCaptureValidationMessage=!1,e.simpleProjectValidationMessage=!1,hideLoading(),!1;var k=[],d=[],g=[],nt=[],tt=[];e.projectTypeSelector.OtherImpactedProduct!=null&&(k=e.projectTypeSelector.OtherImpactedProduct.length>1?e.projectTypeSelector.OtherImpactedProduct.join(","):e.projectTypeSelector.OtherImpactedProduct[0]);e.projectTypeSelector.ExecutionScope!=null&&(d=e.projectTypeSelector.ExecutionScope.length>1?e.projectTypeSelector.ExecutionScope.join(","):e.projectTypeSelector.ExecutionScope[0]);e.projectTypeSelector.agileSecWorkstream!=null&&e.projectTypeSelector.agileSecWorkstream!=""&&(g=e.projectTypeSelector.agileSecWorkstream.length>1?e.projectTypeSelector.agileSecWorkstream.join(","):e.projectTypeSelector.agileSecWorkstream[0]);e.projectTypeSelector.POBOSCategory!=null&&e.projectTypeSelector.POBOSCategory!=""&&(nt=e.projectTypeSelector.POBOSCategory.length>1?e.projectTypeSelector.POBOSCategory.join(","):e.projectTypeSelector.POBOSCategory[0]);e.projectTypeSelector.SiteAssessmentCategory!=null&&e.projectTypeSelector.SiteAssessmentCategory!=""&&(tt=e.projectTypeSelector.SiteAssessmentCategory.length>1?e.projectTypeSelector.SiteAssessmentCategory.join(","):e.projectTypeSelector.SiteAssessmentCategory[0]);c=n==e.StandardProject?e.projectTypeSelector.OEProjectType!=null&&e.projectTypeSelector.OEProjectType!=""?e.projectTypeSelector.OEProjectType.join(","):null:e.projectTypeSelector.OEProjectType!=null&&e.projectTypeSelector.OEProjectType!=""?e.projectTypeSelector.OEProjectType.join(","):null;i="";r="";n==e.StandardProject?(i=$("#PeopleSearch").data("kendoComboBox"),r=e.projectTypeSelector.IsAgileStandard!=null?e.projectTypeSelector.IsAgileStandard:null):(i=$("#PeopleSearchSimple").data("kendoComboBox"),r=e.projectTypeSelector.IsAgileSimple!=null?e.projectTypeSelector.IsAgileSimple:null);e.projectTypeSelectorData={ProblemUniqueID:w,ProblemTitle:e.projectTypeSelector.Title!=null?e.projectTypeSelector.Title:null,ProblemType:n,PortfolioOwnerID:e.projectTypeSelector.PortfolioOwner!=null?e.projectTypeSelector.PortfolioOwner.LookUpMemberID:null,CreatedByID:currentUserId,ProblemOwnerID:t,ProblemOwnerName:t!=null?i.dataItem()!=undefined?i.dataItem().UserDisplayName:null:null,ParentProgramID:e.projectTypeSelector.ParentProgram!=null?e.projectTypeSelector.ParentProgram:null,PrimaryProductID:e.projectTypeSelector.PrimaryProduct!=null?e.projectTypeSelector.PrimaryProduct.LookUpMemberID:null,ProjectDescription:e.projectTypeSelector.ProblemDescription!=null?e.projectTypeSelector.ProblemDescription:null,ExecutionScope:e.projectTypeSelector.ExecutionScope!=null?d:null,OtherImpactedProducts:e.projectTypeSelector.OtherImpactedProduct!=null?k:null,IsTechTransfer:e.projectTypeSelector.IsTechTransfer!=null?e.projectTypeSelector.IsTechTransfer:null,CampaignTypeID:e.projectTypeSelector.CampaignType!=null?e.projectTypeSelector.CampaignType.LookUpMemberID:null,CampaignPhaseID:e.projectTypeSelector.CampaignPhase!=null?e.projectTypeSelector.CampaignPhase.LookUpMemberID:null,ProductionStepID:e.projectTypeSelector.ProductionStepID!=null?e.projectTypeSelector.ProductionStepID.LookUpMemberID:null,TargetEndState:e.projectTypeSelector.TargetEndState!=null?e.projectTypeSelector.TargetEndState:null,IsConfidential:e.projectTypeSelector.isConfidential==undefined?!1:e.projectTypeSelector.isConfidential,LocalCurrencyID:e.projectTypeSelector.localCurrency!=null?e.projectTypeSelector.localCurrency.LookUpMemberID:null,IsOEProject:n==e.StandardProject?e.projectTypeSelector.IsOEProject!=null?e.projectTypeSelector.IsOEProject:null:e.projectTypeSelector.IsOEProjectSimple!=null?e.projectTypeSelector.IsOEProjectSimple:null,OEProjectType:c,IsAgile:r,AgilePrimaryWorkstream:e.projectTypeSelector.agilePrimaryWorkstation!=null&&e.projectTypeSelector.agilePrimaryWorkstation!=""?e.projectTypeSelector.agilePrimaryWorkstation.LookUpMemberID:null,AgileSecondaryWorkstream:g,agileWave:e.projectTypeSelector.agileWave!=null&&e.projectTypeSelector.agileWave!=""?e.projectTypeSelector.agileWave.LookUpMemberID:null,IsCapsProject:n==e.StandardProject?e.projectTypeSelector.IsCapsProject!=null?e.projectTypeSelector.IsCapsProject:null:e.projectTypeSelector.IsCapsProjectSimple!=null?e.projectTypeSelector.IsCapsProjectSimple:null,EmissionPortfolioID:e.projectTypeSelector.CapsProjectValue!=null?e.projectTypeSelector.CapsProjectValue.LookUpMemberID:null,IsPOBOS:n==e.StandardProject?e.projectTypeSelector.IsPOBOSStandard!=null?e.projectTypeSelector.IsPOBOSStandard:null:e.projectTypeSelector.IsPOBOSSimple!=null?e.projectTypeSelector.IsPOBOSSimple:null,IsSiteAssessment:n==e.StandardProject?e.projectTypeSelector.IsSiteAssessment!=null?e.projectTypeSelector.IsSiteAssessment:null:e.projectTypeSelector.IsSiteAssessmentSimple!=null?e.projectTypeSelector.IsSiteAssessmentSimple:null,POBOSCategory:e.projectTypeSelector.POBOSCategory!=null?nt:null,SiteAssessmentCategory:e.projectTypeSelector.SiteAssessmentCategory!=null?tt:null,PrimaryKPI:e.projectTypeSelector.PrimaryKPI!=null&&e.projectTypeSelector.PrimaryKPI!=""?e.projectTypeSelector.PrimaryKPI.LookUpMemberID:null,IsGMSGQLTAnnualMustWin:n==e.StandardProject?e.projectTypeSelector.IsGMSGQLTAnnualMustWinStandard!=null?e.projectTypeSelector.IsGMSGQLTAnnualMustWinStandard:null:e.projectTypeSelector.IsGMSGQLTAnnualMustWin!=null?e.projectTypeSelector.IsGMSGQLTAnnualMustWin:null,StrategicYearID:e.projectTypeSelector.StrategicYear!=null&&e.projectTypeSelector.StrategicYear!=""?e.projectTypeSelector.StrategicYear.LookUpMemberID:null,AnnualMustWinID:e.projectTypeSelector.AnnualMustWin!=null&&e.projectTypeSelector.AnnualMustWin!=""?e.projectTypeSelector.AnnualMustWin.LookUpMemberID:null};e.qualityInsertListItems=[];u=[];$("#standardProjectQualityGrid").data("kendoGrid")!=undefined&&(it=$("#standardProjectQualityGrid").data("kendoGrid").dataSource.data(),angular.forEach(it,function(n){var t={};t.ProblemUniqueID=e.projectTypeSelectorData.ProblemUniqueID;t.QualityReferenceTypeID=n.QualityReferenceTypeID;t.QualityReference=n.QualityReference;u.push(t)}));e.projectTypeSelector.qualityref==!1&&(u=[]);s=[];n==e.simpleProject&&$("#gridHubSettingsProblemCapture").data("kendoTreeList")!=undefined&&(rt=$("#gridHubSettingsProblemCapture").data("kendoTreeList").dataSource.data(),angular.forEach(rt,function(n){var t={};t.ProjectID=w;t.LookUpID=n.LookUpID;t.HubSettingID=n.HubSettingID;t.HubValue=n.HubValue;s.push(t)}));h.push(e.projectTypeSelectorData);ut=JSON.stringify({problemCaptureData:h,hubSettingsData:s,ProjectIDTemplate:e.TemplateProjectID,CopyProjectParameter:e.SelectedValues});f.postDataWCF("insertProblemCaptureData",ut).then(function(t){t.insertProblemCaptureDataResult=="Success"?n==e.StandardProject&&e.projectTypeSelector.qualityref==!0?f.postDataWCF("insertQualityReferenceData",JSON.stringify(u)).then(function(n){hideLoading();n.insertQualityReferenceDataResult=="Success"&&(e.ProblemName=e.projectTypeSelectorData.ProblemTitle,e.ProblemID=e.projectTypeSelectorData.ProblemUniqueID,e.projectTypeSelector={},$("#btnSubmit").closest(".k-window-content").data("kendoWindow").close(),window.location.href=projectHubpath+"?ProblemID="+e.ProblemID+"&ProblemTitle="+e.ProblemName)}):(hideLoading(),e.ProblemName=e.projectTypeSelectorData.ProblemTitle,e.ProblemID=e.projectTypeSelectorData.ProblemUniqueID,e.projectTypeSelector={},$("#btnSubmit").closest(".k-window-content").data("kendoWindow").close(),window.location.href=projectHubpath+"?ProblemID="+e.ProblemID+"&ProblemTitle="+e.ProblemName):(hideLoading(),alert("Error occurred in Problem Capture Insertion"))})}catch(ft){hideLoading();et={method:"CreateProblemCaptureData",exceptionMessage:"message:"+ft.message+" stack:"+ft.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",et)).then(function(){alert(errormessage)})}}function fi(){var n=[];n.push(e.projectTypeSelector.PortfolioOwner.LookUpMemberID);e.projectTypeSelector.ExecutionScope=n;i.$digest()}function ei(){var n=[];n.push(e.projectTypeSelector.PortfolioOwner.LookUpMemberID);e.projectTypeSelector.ExecutionScope=n;i.$digest()}function oi(){var u=e.dsPOCurrency.filter(function(n){return n.PortfolioOwnerID==e.projectTypeSelector.PortfolioOwner.LookUpMemberID}),n,t,r;e.notCenterFunction=u[0].PortfolioGroup==centerFunctionName?!1:!0;$("#standardPortfolioOwner").data("kendoComboBox").value()&&$("#standardPortfolioOwner").data("kendoComboBox").select()===-1&&$("#standardPortfolioOwner").data("kendoComboBox").value("");e.projectTypeSelector.PortfolioOwner!=null&&(n=[],n.push(e.projectTypeSelector.PortfolioOwner.LookUpMemberID),e.projectTypeSelector.ExecutionScope=n,e.currencyValue=e.dsPOCurrency.filter(function(n){return n.PortfolioOwnerID==e.projectTypeSelector.PortfolioOwner.LookUpMemberID}),t={LookUpMemberID:e.currencyValue[0].LocalCurrencyID,LookUpMemberName:e.currencyValue[0].LocalCurrencyName},e.projectTypeSelector.localCurrency=t,e.EmissionPortfolioEqualOne=e.dsEmissionPortfolio.filter(function(n){return n.LookUpMemberID==e.projectTypeSelector.PortfolioOwner.LookUpMemberID}),r={LookUpMemberID:e.projectTypeSelector.PortfolioOwner.LookUpMemberID,LookUpMemberName:e.projectTypeSelector.PortfolioOwner.LookUpMemberName},e.projectTypeSelector.CapsProjectValue=e.EmissionPortfolioEqualOne.length!=0?r:"");i.$digest()}function si(){var n=[];n.push(e.projectTypeSelector.PortfolioOwner.LookUpMemberID);e.projectTypeSelector.ExecutionScope=n;i.$digest()}function hi(){var u=e.dsPOCurrency.filter(function(n){return n.PortfolioOwnerID==e.projectTypeSelector.PortfolioOwner.LookUpMemberID}),n,t,r;e.notCenterFunctionSimple=u[0].PortfolioGroup==centerFunctionName?!1:!0;$("#simplePortfolio").data("kendoComboBox").value()&&$("#simplePortfolio").data("kendoComboBox").select()===-1&&$("#simplePortfolio").data("kendoComboBox").value("");e.projectTypeSelector.PortfolioOwner!=null&&(n=[],n.push(e.projectTypeSelector.PortfolioOwner.LookUpMemberID),e.projectTypeSelector.ExecutionScope=n,e.currencyValue=e.dsPOCurrency.filter(function(n){return n.PortfolioOwnerID==e.projectTypeSelector.PortfolioOwner.LookUpMemberID}),t={LookUpMemberID:e.currencyValue[0].LocalCurrencyID,LookUpMemberName:e.currencyValue[0].LocalCurrencyName},e.projectTypeSelector.localCurrency=t,e.EmissionPortfolioEqualOne=e.dsEmissionPortfolio.filter(function(n){return n.LookUpMemberID==e.projectTypeSelector.PortfolioOwner.LookUpMemberID}),r={LookUpMemberID:e.projectTypeSelector.PortfolioOwner.LookUpMemberID,LookUpMemberName:e.projectTypeSelector.PortfolioOwner.LookUpMemberName},e.projectTypeSelector.CapsProjectValue=e.EmissionPortfolioEqualOne.length!=0?r:"");i.$digest()}function ci(){return[{field:"QualityReferenceTypeID",title:"Quality Reference Type",values:p,width:"45%"},{field:"QualityReference",title:"Quality Reference #",width:"45%"},{field:"QualityUniqueID",title:"id",hidden:!0},{command:[{name:" ",iconClass:"k-icon k-i-close",width:"10%",click:function(n){var r,t,u;confirm(gridDeleteMessage)?(n.preventDefault(),r=$(n.target).closest("tr"),t=this.dataItem(r),t!=undefined&&t.QualityUniqueID!=undefined&&t.QualityUniqueID!=""&&e.deletedQualityData.push({QualityUniqueID:t.QualityUniqueID}),u=$("#standardProjectQualityGrid").data("kendoGrid"),u.removeRow(r),i.$digest()):n.preventDefault()}}]}]}function li(){v("ddl_Copy_Prog")}function ai(){var t,n,i;if(e.SelectedValues="",t=!1,a=[],e.TemplateProjectID!=undefined&&e.TemplateProjectID!=""){for(n=0;n<e.CopyProjectTempleList.length;n++)e.CopyProjectTempleList[n].checked&&(e.SelectedValues=e.SelectedValues==""?e.CopyProjectTempleList[n].LookUpMemberID:e.SelectedValues+","+e.CopyProjectTempleList[n].LookUpMemberID,e.CopyProjectTempleList[n].LookUpMemberID=="085b590b-016c-47fa-9c87-4e2a09775e9d"&&(t=!0));i={ProjectIDTemplate:e.TemplateProjectID,CopyUserID:currentUserId,CopyProjectParameter:e.SelectedValues};$.when(f.postDataWCFAsync("getProjectTemplateInfoByID",i),f.getDataWCFAsync("getQualityReferenceByProjectId/"+e.TemplateProjectID)).then(function(n,i){var r=JSON.parse(n.getProjectTemplateInfoByIDResult),u;e.projectTypeSelector=r.length>0?r[0]:{};e.projectTypeSelector.qualityref=!1;c=!0;t==!0&&(a=JSON.parse(i.getQualityReferenceByProjectIdResult),a.length>0&&(e.projectTypeSelector.qualityref=!0));u=e.projectTypeSelector.ProjectTypeID==undefined||e.projectTypeSelector.ProjectTypeID==""?standardProjectTypeID:e.projectTypeSelector.ProjectTypeID;nt(u)})}else alert(noTemplateSelectedMessage)}function vi(){var t=ci(),i=new kendo.data.DataSource({transport:{read:function(n){n.success(a)}},batch:!0,schema:{model:{id:"QualityUniqueID",fields:{QualityUniqueID:{editable:!1},QualityReferenceTypeID:{type:"string"},QualityReference:{type:"string"}}}}}),n;$("#standardProjectQualityGrid").kendoGrid({dataSource:i,columns:t,navigatable:!0,editable:{createAt:"bottom"}});e.isEditable&&(n=$("#standardProjectQualityGrid").data("kendoGrid"),n.addRow())}function yi(){var n=$("#standardProjectQualityGrid").data("kendoGrid");n.addRow()}function pi(n){var y,p,w,k,nt,rt,ut,ft,et,ht,st;try{if(c){var t=e.projectTypeSelector.IsAgile==1?!0:!1,i=e.projectTypeSelector.IsOEProject==1?!0:!1,r=e.projectTypeSelector.IsCapsProject==1?!0:!1,u=e.projectTypeSelector.IsPOBOS==1?!0:!1,l=e.projectTypeSelector.IsSiteAssessment==1?!0:!1,a=e.projectTypeSelector.IsGMSGQLTAnnualMustWin==1?!0:!1;n=e.projectTypeSelector.ProblemType;e.projectTypeSelector.isConfidential=e.projectTypeSelector.isConfidential==1?!0:!1;e.projectTypeSelector.IsTechTransfer=e.projectTypeSelector.IsTechTransfer==1?!0:!1;e.projectTypeSelector.IsOEProject=e.projectTypeSelector.IsOEProjectSimple=i;e.projectTypeSelector.IsAgileSimple=e.projectTypeSelector.IsAgileStandard=t;e.projectTypeSelector.IsCapsProjectSimple=e.projectTypeSelector.IsCapsProject=r;e.projectTypeSelector.IsPOBOSStandard=e.projectTypeSelector.IsPOBOSSimple=u;e.projectTypeSelector.IsSiteAssessment=e.projectTypeSelector.IsSiteAssessmentSimple=l;e.projectTypeSelector.IsGMSGQLTAnnualMustWin=e.projectTypeSelector.IsGMSGQLTAnnualMustWinStandard=a;e.OEProjectVisibleTechTransfer=e.projectTypeSelector.IsTechTransfer;e.CapsProjectVisible=e.CapsProjectVisibleSimple=r;e.OEProjectVisibleSimple=i;e.techTransferVisible=e.projectTypeSelector.IsTechTransfer;e.standardAgileVisible=e.simpleAgileVisible=t;e.simplePOBOSVisible=e.standardPOBOSVisible=u;e.isSimpleSiteAssessmentVisible=e.isSiteAssessmentVisible=l;e.simpleGMSGQLTAnnualMustWinVisible=e.standardGMSGQLTAnnualMustWinVisible=a;e.projectTypeSelector.PrimaryProduct!=""&&(y=e.dsPrimaryProduct.filter(function(n){return n.LookUpMemberID==e.projectTypeSelector.PrimaryProduct}),e.projectTypeSelector.PrimaryProduct=y[0]);e.projectTypeSelector.StrategicYear!=""&&(p=e.dsStrategicYear.filter(function(n){return n.LookUpMemberID==e.projectTypeSelector.StrategicYear}),e.projectTypeSelector.StrategicYear=p[0]);e.projectTypeSelector.AnnualMustWin!=""&&(w=e.dsAnnualMustWin.filter(function(n){return n.LookUpMemberID==e.projectTypeSelector.AnnualMustWin}),e.projectTypeSelector.AnnualMustWin=w[0]);e.projectTypeSelector.CampaignPhase!=""&&(k=e.dsCampaign.filter(function(n){return n.LookUpMemberID==e.projectTypeSelector.CampaignPhase}),e.projectTypeSelector.CampaignPhase=k[0]);e.projectTypeSelector.ProductionStepID!=""&&(nt=e.dsProductionStep.filter(function(n){return n.LookUpMemberID==e.projectTypeSelector.ProductionStepID}),e.projectTypeSelector.ProductionStepID=nt[0]);e.projectTypeSelector.CampaignType!=""&&(rt=e.dsCampaignType.filter(function(n){return n.LookUpMemberID==e.projectTypeSelector.CampaignType}),e.projectTypeSelector.CampaignType=rt[0]);e.projectTypeSelector.PrimaryKPI!=""&&(ut=e.dsPrimaryKPI.filter(function(n){return n.LookUpMemberID==e.projectTypeSelector.PrimaryKPI}),e.projectTypeSelector.PrimaryKPI=ut[0]);e.projectTypeSelector.agilePrimaryWorkstation!=""&&(ft=e.dsAgilePrimaryWorkstation.filter(function(n){return n.LookUpMemberID==e.projectTypeSelector.agilePrimaryWorkstation}),e.projectTypeSelector.agilePrimaryWorkstation=ft[0]);e.projectTypeSelector.agileWave!=""&&(et=e.dsAgileWave.filter(function(n){return n.LookUpMemberID==e.projectTypeSelector.agileWave}),e.projectTypeSelector.agileWave=et[0]);e.projectTypeSelector.POBOSCategory=e.projectTypeSelector.POBOSCategory==null||e.projectTypeSelector.POBOSCategory==""||e.projectTypeSelector.POBOSCategory==undefined?"":e.projectTypeSelector.POBOSCategory.split(",");e.projectTypeSelector.SiteAssessmentCategory=e.projectTypeSelector.SiteAssessmentCategory==null||e.projectTypeSelector.SiteAssessmentCategory==""||e.projectTypeSelector.SiteAssessmentCategory==undefined?"":e.projectTypeSelector.SiteAssessmentCategory.split(",");e.projectTypeSelector.agileSecWorkstream=e.projectTypeSelector.agileSecWorkstream==null||e.projectTypeSelector.agileSecWorkstream==""||e.projectTypeSelector.agileSecWorkstream==undefined?"":e.projectTypeSelector.agileSecWorkstream.split(",");e.projectTypeSelector.OEProjectType=e.projectTypeSelector.OEProjectType==null||e.projectTypeSelector.OEProjectType==""||e.projectTypeSelector.OEProjectType==undefined?"":e.projectTypeSelector.OEProjectType.split(",");e.projectTypeSelector.OtherImpactedProduct=e.projectTypeSelector.OtherImpactedProducts==null||e.projectTypeSelector.OtherImpactedProducts==""||e.projectTypeSelector.OtherImpactedProducts==undefined?"":e.projectTypeSelector.OtherImpactedProducts.split(",")}else e.projectTypeSelector.isConfidential=!1,e.projectTypeSelector.qualityref=!1,e.projectTypeSelector.IsTechTransfer=!1,e.projectTypeSelector.IsOEProject=!1,e.projectTypeSelector.IsOEProjectSimple=!1,e.projectTypeSelector.IsAgileSimple=!1,e.projectTypeSelector.IsAgileStandard=!1,e.projectTypeSelector.IsCapsProject=!1,e.projectTypeSelector.IsCapsProjectSimple=!1,e.projectTypeSelector.IsPOBOSStandard=!1,e.projectTypeSelector.IsPOBOSSimple=!1,e.projectTypeSelector.IsSiteAssessment=!1,e.projectTypeSelector.IsSiteAssessmentSimple=!1,e.projectTypeSelector.IsGMSGQLTAnnualMustWin=!1,e.projectTypeSelector.IsGMSGQLTAnnualMustWinStandard=!1,e.OEProjectVisibleTechTransfer=!1,e.CapsProjectVisible=!1,e.CapsProjectVisibleSimple=!1,e.OEProjectVisibleSimple=!1,e.techTransferVisible=!1,e.standardAgileVisible=!1,e.simpleAgileVisible=!1,e.simplePOBOSVisible=!1,e.standardPOBOSVisible=!1,e.isSimpleSiteAssessmentVisible=!1,e.isSiteAssessmentVisible=!1,e.simpleGMSGQLTAnnualMustWinVisible=!1,e.standardGMSGQLTAnnualMustWinVisible=!1;bindChangeComboBox("standardPrimProduct");bindChangeComboBox("campaignPhase");bindChangeComboBox("productionStep");bindChangeComboBox("campaignType");bindChangeComboBox("primaryWorkstation");bindChangeComboBox("agileWave");bindChangeComboBox("simplePrimartProduct");bindChangeComboBox("localCurrency");bindChangeComboBox("ddlSiteAssessment");bindChangeComboBox("ddlPROBSCat");bindChangeComboBox("ddlPrimaryKPI");bindChangeComboBox("standardPortfolioOwner");bindChangeComboBox("ddl_StandardCurrency");bindChangeComboBox("ddl_StandardEmission");bindChangeComboBox("simplePortfolio");bindChangeComboBox("simpleLocalCurrency");bindChangeComboBox("ddl_SimpleEmission");vi();n!=simpleProjectType||g||(ki(),g=!0);angular.forEach(h,function(n,t){t<h.length&&d==0&&$("#"+n.ProjectTypeUniqueID).data("kendoWindow").bind("close",function(n){b==0?angular.equals(s,e.projectTypeSelector)==!1?confirm(dialogCloseMessage)?(e.projectTypeSelector={},angular.copy(e.projectTypeSelector,s)):n.preventDefault():(e.projectTypeSelector={},angular.copy(e.projectTypeSelector,s)):(e.projectTypeSelector={},angular.copy(e.projectTypeSelector,s))});t==h.length-1&&(d=1)});ht=currentUserId;switch(n){case"Standard Project / Program":f.setDefaultUser("PeopleSearch").then(function(){var n=$("#PeopleSearch").data("kendoComboBox");n.input.keydown(tt)});v("standParentProgram");c=!1;break;case"Simple Project":f.setDefaultUser("PeopleSearchSimple").then(function(){var n=$("#PeopleSearchSimple").data("kendoComboBox");n.input.keydown(it)});v("simpleParentProgram");c=!1;break;case"SimpleProject":f.setDefaultUser("PeopleSearchSimple").then(function(){var n=$("#PeopleSearchSimple").data("kendoComboBox");n.input.keydown(it)});v("simpleParentProgram");c=!1;break;case"Copy an existing project":li();break;default:console.log("default")}angular.copy(e.projectTypeSelector,s)}catch(ot){hideLoading();st={method:"SetDefaultValues",exceptionMessage:"message:"+ot.message+" stack:"+ot.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",st)).then(function(){alert(errormessage)})}}function wi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})}function bi(){try{$.when(f.postDataWCFAsync("getGlobalMessage")).then(function(n){var t,u;try{t=JSON.parse(n.getGlobalMessageResult);t.length>0&&t!==t[0].GlobalMessageText&&(e.globalMesaage="",e.globalMesaage=t[0].GlobalMessageText,i.$digest())}catch(r){hideLoading();u={method:"updateGlobalMessage",exceptionMessage:"message:"+r.message+" stack:"+r.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",u)).then(function(){})}})}catch(n){hideLoading();var t={method:"updateGlobalMessage",exceptionMessage:"message:"+n.message+" stack:"+n.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",t)).then(function(){})}}function v(n){var t=[],i=$("#"+n).data("kendoComboBox"),u;if(i==undefined){$("#"+n).kendoComboBox({dataTextField:"ProjectText",dataValueField:"ProblemUniqueID",dataSource:t,minLength:3,placeholder:projectPickerPlaceholder,select:function(t){n=="ddl_Copy_Prog"?e.TemplateProjectID=t.dataItem.ProblemUniqueID:e.projectTypeSelector.ParentProgram=t.dataItem.ProblemUniqueID}});try{$("#"+n).data().kendoComboBox.input.on("keydown",function(i){var c,u,s,h,r;i.keyCode==13?(r=$("#"+n).data("kendoComboBox"),c="",console.log(r.value()),u=r.input[0].value,console.log(u),u.length>=3?(displayLoading(),s=e.projectTypeSelector.isConfidential==undefined?"":e.projectTypeSelector.isConfidential,h={strUserAdId:currentUserId+"Ãž"+s,strFilterString:u},$.when(f.postDataWCFAsync("getProjectByUserId",h)).then(function(n){try{t=JSON.parse(n);r.setDataSource(t);r.open();hideLoading()}catch(i){var u={method:"searchProject",exceptionMessage:"message:"+i.message+" stack:"+i.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",u)).then(function(){alert(errormessage)});hideLoading()}})):(alert(minThreeLetterMsg),t=[],r=$("#"+n).data("kendoComboBox"),r.setDataSource(t),r.close(),hideLoading())):(t=[],r=$("#"+n).data("kendoComboBox"),i.keyCode==8&&r.value(""),r.setDataSource(t),r.close())})}catch(r){u={method:"searchProject",exceptionMessage:"message:"+r.message+" stack:"+r.stack,ErrorParameter:o};$.when(f.postDataWCFAsync("WriteErrorLog",u)).then(function(){alert(errormessage)});hideLoading()}}else i.setDataSource(t),hideLoading();return""}function ki(){var n=new kendo.data.TreeListDataSource({transport:{read:function(n){n.success(e.dsHubSettings)}},schema:{model:{id:"LookUpID",fields:{parentId:{field:"Parent",nullable:!0},LookUpName:{type:"string",editable:!1},HubSettingID:{hidden:!0},ProjectID:{type:"string"},LookUpID:{type:"string",hidden:!0},Parent:{type:"string"},HubValue:{type:"boolean"}}}}});$("#gridHubSettingsProblemCapture").kendoTreeList({dataSource:n,batch:!0,expanded:!0,columns:[{field:"LookUpName",title:"Hub Section"},{field:"LookUpID",title:"LookUpID",hidden:!0},{field:"HubValue",title:" ",template:'#if(LookUpName != "Project Board Section") { # <input type="checkbox" #= data.HubValue ? checked="checked" : "" #  class="HubValueChkbx"/># } #'}],dataBound:function(){$(".HubValueChkbx").bind("click",function(n){var i=$("#gridHubSettingsProblemCapture").data("kendoTreeList"),t=i.dataItem($(n.target).closest("tr"));t!=null&&t.set("HubValue",this.checked)})}})}function di(){var u=/iPhone|iPhone XR|iPad|iPod|Android|Tablet|Windows Phone|blackberry|webOS/i.test(navigator.userAgent.toLowerCase()),o="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch||navigator.maxTouchPoints>0||window.navigator.msMaxTouchPoints>0,t=!1,n,r;t=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);navigator.platform=="Win32"?t||alert(chromeBrowserMsg):(u||navigator.platform=="iOS")&&alert(mobileDeviceMsg);n=document.createElement("img");n.width="85";r=document.getElementById("logo");switch(environment){case"qa":n.src="../Images/spot-qa-logo.svg";break;case"training":n.src="../Images/spot-training-logo.svg";break;default:n.src="../Images/spot_logo.svg"}r.appendChild(n);$.when(f.postDataWCF("getUserPermissionById",currentUserId),f.postDataWCF("getGlobalMessage")).then(function(n,t){var r,u;r=JSON.parse(n.getUserPermissionByIdResult);e.MailSubject="DL.SPOTSupport@takeda.com?Subject=SPOT Support Request "+currentUserName+" (Logged on "+y+")";e.canManageUser=r.filter(function(n){return n.Permission==manageUsers}).length>0?!0:!1;e.canCreateProj=r.filter(function(n){return n.Permission==createProject}).length>0?!0:!1;e.globalMesaage="";u=JSON.parse(t.getGlobalMessageResult);u.length>0&&(e.globalMesaage=u[0].GlobalMessageText);setInterval(bi,9e5);i.$digest()})}var e=this,y;e.validationMsg=validationMessages;e.validationMessage;e.validationClass;e.projectTypeSelector={};e.projectVisible=!0;e.programVisible=!1;e.OEProjectVisible=!1;e.OEProjectVisibleSolution=!1;e.OEProjectVisibleTechTransfer=!1;e.OEProjectVisibleTechOps=!1;e.OEProjectVisibleSimple=!1;e.CapsProjectVisible=!1;e.notCenterFunction=!0;e.notCenterFunctionSimple=!0;e.productMasterListUrl=productMasterListUrl;e.securityGroupUserspath=securityGroupUserspath;e.myPreferencesPagepath=myPreferencesPagepath;e.portfolioCenterpath=portfolioCenterpath;e.simplePOBOSChange=bt;e.simpleGMSGQLTAnnualMustWinChange=kt;e.standardGMSGQLTAnnualMustWinChange=dt;e.capsProjectTooltipNew=capsProjectTooltip;e.environmentalTootltipNew=environmentalTootltip;e.CurrentUserNameValue="";e.ProjectTypeSelectorListItems=[];e.dsResList=[];e.dsPrimaryProduct=[];e.dsOwner=[];e.dsExecutionScopeData=[];e.qualityType=[];e.dsCampaign=[];e.dsCampaignType=[];e.dsProductionStep=[];e.dsProject=[];e.customOptions=[];e.dsUserPermission=[];e.dsProjectSearch=[];e.dsOEProjectType=[];e.dsHubSettings=[];e.ProblemCapture="ProblemCapture";e.SolutionIdentified="SolutionIdentified";e.TechOpsProgram="TechOpsProgram";e.TechTransfer="TechTransfer";e.StandardProject="Standard Project / Program";e.simpleProject="SimpleProject";e.ProblemName;e.ProblemID;e.redirectProject;e.problemCaptureValidationMessage=!1;e.solutionValidationMessage=!1;e.techOpsValidationMessage=!1;e.techTransferValidationMessage=!1;e.isConfidentialVisible=!1;e.canManageUser=!1;e.canCreateProj=!1;e.simpleProjectValidationMessage=!1;e.dsPOCurrency=[];e.dsStrategicYear=[];e.dsAnnualMustWin=[];e.currentDate=new Date;y=kendo.toString(e.currentDate,"ddd MMM d yyyy hh:mm:ss tt");e.MailSubject="DL.SPOTSupport@takeda.com?Subject=SPOT Support Request "+currentUserName+" (Logged on "+y+")";e.initTopMenu=di;e.ProjectTypeSelector=st;e.CreateProblemCaptureData=ui;e.techTransferChange=pt;e.standardAgileChange=ti;e.simpleAgileChange=ii;e.oeTypeChange=ct;e.oeTypeChangeSolution=lt;e.oeTypeChangeTechOps=at;e.oeTypeChangeTransfer=vt;e.oeTypeChangeSimpleProject=yt;e.SetDefaultValues=pi;e.portfolioOnChange=fi;e.solutionOnChange=ei;e.techTransferOnChange=oi;e.techOps=si;e.navigateToHub=et;e.simpleproject=hi;e.logout=ft;e.openModel=nt;e.GetSearchedProjects=ut;e.userControlSearch=tt;e.AddNewQualityRow=yi;e.onChangeStandardQualityRef=ri;e.isConfidentialProjectFunc=ot;e.trackEventFunc=rt;e.standardSiteAssessmentChange=gt;e.simpleSiteAssessmentChange=ni;e.standardPOBOSChange=wt;e.CopyProject=ai;var b=0,k=[],s={},l=[],p=[],a=[],o="TopMenuCtrl",h,d=0,w,g=!1,c=!1}angular.module("SPOTApp").controller("TopMenuCtrl",TopMenuCtrl);TopMenuCtrl.$inject=["$rootScope","$filter","$scope","$http","$q","GETPostService"];