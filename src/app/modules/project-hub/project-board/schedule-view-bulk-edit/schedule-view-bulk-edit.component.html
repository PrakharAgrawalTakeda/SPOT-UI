<div class="flex items-start justify-between bg-primary sidepanel-header">
  <div class="text-on-primary" style="padding-top: 6px">Bulk Edit Milestones</div>
  <div style="padding-top: 2px">
    <a (click)="projecthubservice.toggleDrawerOpen('', '',[],'',false)"
      href="javascript:void(0)" title="Close">
      <mat-icon class="text-on-primary" svgIcon="heroicons_outline:x"></mat-icon>
    </a>
  </div>
</div>
<!-- <form class="w-full form-ask-need" [formGroup]="schedulebulkeditForm" (ngSubmit)="submitschedule()"
    style="overflow-y: scroll; height: 95vh;"> -->

    <div class="mt-6 flex justify-between items-center">
      <button class="w-15" mat-flat-button [color]="'primary'" type="button" (click)="addMilestoneRecord()">
        Add New
      </button>
      <button class="w-15" mat-flat-button [color]="'primary'" type="button" (click)="reset()">
        Cancel
      </button>
      <button class="w-15" mat-flat-button [color]="'primary'" type="button" (click)="submitschedule()">
        Submit
      </button>
    </div>

<!-- <div class="flex items-start justify-between">

  <div style="padding-left: 1%;padding-top: 10px;padding-bottom: 10px;">
    <button class="w-20" mat-flat-button [color]="'primary'" type="submit">
      Submit
  </button>
  </div>
  <div style="padding-right: 90%;padding-top: 10px;padding-bottom: 10px;">
  <a class="w-20" mat-flat-button [color]="'primary'"
      (click)="this.projecthubservice.toggleDrawerOpen('', '',[],'',false)">
      Cancel
  </a>
</div>

</div> -->
 <!-- <div class="overflow-x-auto mx-6">
    </div>  -->
    <div class="mt-3">
      <ngx-datatable
        class="pr-6 material font-medium text-sm text-secondary whitespace-nowrap"
        [rows]="scheduleData.scheduleData"
        #scheduleTable
        columnMode="flex"
        [headerHeight]="'auto'"
        [rowHeight]="'auto'"
        [scrollbarV]="false">
        <ngx-datatable-column name="Milestone" prop="milestone" [resizeable]="false"
          [flexGrow]="1">
          <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
            <a *ngIf="!milestoneTableEditStack.includes(rowIndex)" (click)="milestoneTableEditRow(rowIndex)">{{value}}</a>
            <form [formGroup]="milestoneForm.controls[rowIndex]" *ngIf="milestoneTableEditStack.includes(rowIndex)">
              <spot-input formControlName="milestone" name="milestone" [showLabel]="false"
                [placeholder]="'Milestone Name'">
              </spot-input>
            </form>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Planned Finish" prop="plannedFinish" [resizeable]="false" [flexGrow]="1">
          <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
            <a *ngIf="!milestoneTableEditStack.includes(rowIndex)" (click)="milestoneTableEditRow(rowIndex)">{{value | date:'dd-MMM-yyyy'}}</a>
            <form [formGroup]="milestoneForm.controls[rowIndex]" *ngIf="milestoneTableEditStack.includes(rowIndex)">
              <spot-input-date formControlName="plannedFinish" name="plannedFinish" [showLabel]="false"
        [placeholder]="'Planned Finish Date'"></spot-input-date>
            </form>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Baseline Finish" prop="baselineFinish" [resizeable]="false" [flexGrow]="1">
          <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
            <a *ngIf="!milestoneTableEditStack.includes(rowIndex)" (click)="milestoneTableEditRow(rowIndex)">{{value | date:'dd-MMM-yyyy'}}</a>
            <form [formGroup]="milestoneForm.controls[rowIndex]" *ngIf="milestoneTableEditStack.includes(rowIndex)">
              <spot-input-date formControlName="baselineFinish" name="baselineFinish" [showLabel]="false"
        [placeholder]="'Baseline Finish Date'"></spot-input-date>
            </form>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Variance" prop="variance" [resizeable]="false" [flexGrow]="1">
          <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
            
            <a *ngIf="!milestoneTableEditStack.includes(rowIndex)" (click)="milestoneTableEditRow(rowIndex)">{{calculateVariance(row)}}</a>
          
          </ng-template>
        </ngx-datatable-column>
        <!-- <ngx-datatable-column name="Responsible Person" prop="functionGroupId" [resizeable]="false"
            [flexGrow]="1">
            <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
              <a *ngIf="!milestoneTableEditStack.includes(rowIndex)" (click)="milestoneTableEditRow(rowIndex)">{{value}}</a>
              <form [formGroup]="milestoneForm.controls[rowIndex]" *ngIf="milestoneTableEditStack.includes(rowIndex)">
                <spot-singleselect-autocomplete formControlName="function"
                [showLabel]="false" [placeholder]="'Function Owner'" [valuePointer]="'lookUpName'"
                  [dropDownArray]="getFunctionOwner()">
                </spot-singleselect-autocomplete>
              </form>
            </ng-template>
          </ngx-datatable-column> -->
        <ngx-datatable-column name="Function Owner" prop="functionGroupId" [resizeable]="false"
            [flexGrow]="1">
            <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
              <a *ngIf="!milestoneTableEditStack.includes(rowIndex)" (click)="milestoneTableEditRow(rowIndex)">{{value}}</a>
              <form [formGroup]="milestoneForm.controls[rowIndex]" *ngIf="milestoneTableEditStack.includes(rowIndex)">
                <spot-singleselect-autocomplete formControlName="function"
                [showLabel]="false" [placeholder]="'Function Owner'" [valuePointer]="'lookUpName'"
                  [dropDownArray]="getFunctionOwner()">
                </spot-singleselect-autocomplete>
              </form>
            </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Completion Date" prop="completionDate" [resizeable]="false" [flexGrow]="1">
            <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
              <a *ngIf="!milestoneTableEditStack.includes(rowIndex)" (click)="milestoneTableEditRow(rowIndex)">{{value | date:'dd-MMM-yyyy'}}</a>
              <form [formGroup]="milestoneForm.controls[rowIndex]" *ngIf="milestoneTableEditStack.includes(rowIndex)">
                <spot-input-date formControlName="completionDate" name="completionDate" [showLabel]="false"
          [placeholder]="'Completion Date'"></spot-input-date>
              </form>
            </ng-template>
          </ngx-datatable-column>
          <ngx-datatable-column name="Comments" prop="comments" [resizeable]="false"
          [flexGrow]="1">
          <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
            <a *ngIf="!milestoneTableEditStack.includes(rowIndex)" (click)="milestoneTableEditRow(rowIndex)">{{value}}</a>
            <form [formGroup]="milestoneForm.controls[rowIndex]" *ngIf="milestoneTableEditStack.includes(rowIndex)">
              <spot-input formControlName="comments" name="comments" [showLabel]="false"
                [placeholder]="'Comments'">
              </spot-input>
            </form>
          </ng-template>
        </ngx-datatable-column>
        <!-- <ngx-datatable-column name="Comments" prop="comments" [resizeable]="false"
        [flexGrow]="1">
        <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
        <mat-slide-toggle
            [matTooltip]="this.scheduleForm.controls['includeInReport'].disabled ? 'Only 8 can be selected at a time for dashboard report display' : null"
            formControlName="includeInReport">Include in Project Dashboard</mat-slide-toggle>
            
          </ng-template>
        </ngx-datatable-column> -->
      </ngx-datatable>
    </div>






    <!-- <div class="overflow-x-auto mx-6">
    <ngx-datatable
        class="pr-6 material font-medium text-sm text-secondary whitespace-nowrap"
        [rows]="schedulengxdata"
        #scheduleTable
        [columnMode]="ColumnMode.force"
        [headerHeight]="'auto'"
        [footerHeight]="'auto'"
        [rowHeight]="'auto'">
        
        
          <ngx-datatable-column name="Milestone" prop="milestone">
          <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
            <span
              title="Double click to edit"
              (click)="editing[rowIndex] = true"
              *ngIf="!editing[rowIndex]">
              {{value}}
            </span>
            <input
              (blur)="updateValue($event, 'milestone', rowIndex)"
              *ngIf="editing[rowIndex]"
              type="text"
              [value]="value"
            />
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Planned Finish" prop="plannedFinish">
          <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
            <span
              title="Double click to edit"
              (click)="editing[rowIndex] = true"
              *ngIf="!editing[rowIndex]">
              {{value | date:'dd-MMM-yyyy'}}
            </span>
            <mat-form-field *ngIf="editing[rowIndex]">
              <input matInput [value]="value" [matDatepicker]="picker" placeholder="Choose a date">
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker (selectedChanged)="updateValue($event, 'plannedFinish', rowIndex)"   #picker  ></mat-datepicker>
            </mat-form-field>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Baseline Finish" prop="baselineFinish">
          <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
            <span
              title="Double click to edit"
              (click)="editing[rowIndex] = true"
              *ngIf="!editing[rowIndex]">
              {{value | date:'dd-MMM-yyyy'}}
            </span>
            <mat-form-field *ngIf="editing[rowIndex]">
              <input matInput [value]="value" [matDatepicker]="picker1" placeholder="Choose a date">
              <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
              <mat-datepicker (selectedChanged1)="updateValue($event, 'baselineFinish', rowIndex)"   #picker1  ></mat-datepicker>
            </mat-form-field>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Variance" prop="variance">
          <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
            
              {{calculateVariance(row)}}
          
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Responsible Person" prop="responsiblePersonName">
          <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
            <span
              title="Double click to edit"
              (click)="editing[rowIndex] = true"
              *ngIf="!editing[rowIndex]">
              {{row.responsiblePersonName}}
            </span>
            <input
              
              (blur)="updateValue($event, 'responsiblePersonName', rowIndex)"
              *ngIf="editing[rowIndex]"
              type="text"
              [value]="value"
            />
          </ng-template>
        </ngx-datatable-column> -->
        <!-- <ngx-datatable-column name="Function Owner" prop="functionGroupId">
          <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
            <span
              title="Double click to edit"
              (click)="editing[rowIndex + '-name'] = true"
              *ngIf="!editing[rowIndex+ '-name']">
              {{lookup.get(row.functionGroupId)}}
            </span>
            <input
              autofocus
              (blur)="updateValue($event, 'name', rowIndex)"
              *ngIf="editing[rowIndex+ '-name']"
              type="text"
              [value]="value"
            />
          </ng-template>
        </ngx-datatable-column> -->
        <!-- <ngx-datatable-column name="Completion Date" prop="completionDate">
          <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
            <span
              title="Double click to edit"
              (click)="editing[rowIndex] = true"
              *ngIf="!editing[rowIndex]">
              {{value | date:'dd-MMM-yyyy'}}
            </span>
            <mat-form-field *ngIf="editing[rowIndex]">
              <input matInput [value]="value" [matDatepicker]="picker2" placeholder="Choose a date">
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker (selectedChanged2)="updateValue($event, 'completionDate', rowIndex)"   #picker2  ></mat-datepicker>
            </mat-form-field>
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Comments" prop="comments">
          <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
            <span
              title="Double click to edit"
              (click)="editing[rowIndex] = true"
              *ngIf="!editing[rowIndex]">
              {{row.comments}}
            </span>
            <input
              
              (blur)="updateValue($event, 'comments', rowIndex)"
              *ngIf="editing[rowIndex]"
              type="text"
              [value]="value"
            />
          </ng-template>
        </ngx-datatable-column>
        </ngx-datatable>
      </div> -->
      <!-- </form> -->
