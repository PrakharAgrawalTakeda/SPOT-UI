<div class="flex items-start justify-between bg-primary sidepanel-header">
    <div *ngIf="mode=='Capex'" class="text-on-primary" style="padding-top: 6px">CAPEX Forecast Edit</div>
    <div *ngIf="mode=='Opex'" class="text-on-primary" style="padding-top: 6px">OPEX Forecast Edit</div>
    <div style="padding-top: 2px">
        <a (click)="projecthubservice.toggleDrawerOpen('', '',[],'', true)" href="javascript:void(0)" title="Close">
            <mat-icon class="text-on-primary" svgIcon="heroicons_outline:x"></mat-icon>
        </a>
    </div>
</div>
<div class="space-y-4" >
    <div class="h-[85vh] overflow-auto space-y-3">
        <div class="grid justify-items-stretch m-2">
            <div class=" text-xl font-medium tracking-tight leading-6 truncate text-secondary justify-self-left">{{headerLabel}}</div>
        </div>
        <form [formGroup]="budgetForecastForm" class="grid m-2 grid-cols-4 gap-x-6 gap-y-0 w-19/20" *ngIf="mode=='Capex'">
            <div >
                <mat-label class="flex">Total Forecast Projection TFP ({{this.localCurrency.localCurrencyAbbreviation}})</mat-label>
                <div class="grid grid-cols-2 divide-x-2 w-full bg-[#f1f5f9] border border-gray-300 mt-1 h-12 rounded items-center">
                    <div class="pl-4" [ngStyle]="{'color': tfpColor}">
                        {{ budgetForecastForm.controls.tfpPercentage.value  }}  %
                    </div>
                    <div class="flex justify-end" [ngStyle]="{'color': tfpColor}">
                        <div class="mr-4">
                            {{budgetForecastForm.controls.tfpValue.value | number : fractionSize}}
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <mat-label class="flex">Annual Forecast Performance AFP ({{this.localCurrency.localCurrencyAbbreviation}})</mat-label>
                <div class="grid grid-cols-2 divide-x-2 w-full bg-[#f1f5f9] border border-gray-300 mt-1 h-12 rounded items-center">
                    <div class="pl-4" [ngStyle]="{'color': afpColor}">
                        {{ budgetForecastForm.controls.afpPercentage.value }}  %
                    </div>
                    <div class="flex justify-end" [ngStyle]="{'color': afpColor}">
                        <div class="mr-4">
                            {{ budgetForecastForm.controls.afpValue.value | number : fractionSize  }}
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <mat-label class="flex">Year To Date Performance YTDP ({{this.localCurrency.localCurrencyAbbreviation}})</mat-label>
                <div class="grid grid-cols-2 divide-x-2 w-full bg-[#f1f5f9] border border-gray-300 mt-1 h-12 rounded items-center">
                    <div class="pl-4" [ngStyle]="{'color': ydtpColor}">
                        {{ budgetForecastForm.controls.ytdpPercentage.value }}  %
                    </div>
                    <div class="flex justify-end" [ngStyle]="{'color': ydtpColor}">
                        <div class="mr-4">
                            {{ budgetForecastForm.controls.ytdpValue.value | number : fractionSize}}
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <mat-label class="flex">Month To Date Performance MTDP ({{this.localCurrency.localCurrencyAbbreviation}})</mat-label>
                <div class="grid grid-cols-2 divide-x-2 w-full bg-[#f1f5f9] border border-gray-300 mt-1 h-12 rounded items-center">
                    <div class="pl-4" [ngStyle]="{'color': mdtpColor}">
                        {{ budgetForecastForm.controls.mtdpPercentage.value }}  %
                    </div>
                    <div class="flex justify-end" [ngStyle]="{'color': mdtpColor}">
                        <div class="mr-4">
                            {{ budgetForecastForm.controls.mtdpValue.value | number : fractionSize}}
                        </div>
                    </div>
                </div>
            </div>
        </form>
        <div class="overflow-y-hidden w-[94vw] h-auto pl-3 mt-2 ">
            <div class="flex items-center justify-start gap-3 pt-3 pr-3 ">
                <div class="mr-4 text-xl font-medium tracking-tight leading-6 truncate text-primary mb-2">{{y0Label}} (Current Fiscal Year)</div>
            </div>
            <ngx-datatable [headerHeight]="'auto'" [rowHeight]="'auto'" [scrollbarV]="false" columnMode="flex"
                           class="material font-medium text-sm text-default whitespace-nowrap cursor-pointer fast-load-table"
                           [rows]="forecasts">
                <ngx-datatable-column name="Reference" prop="active" [flexGrow]="1"
                                      [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a (click)="fTableEditRow(rowIndex)">
                            <p *ngIf="!value">&nbsp;</p>
                            <p>{{value}}</p>
                        </a>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Apr" prop="apr" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !aprEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('apr', aprEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex) && aprEditable">
                            <spot-input-forecast formControlName="apr" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateAnnualTotal()"  (pasteEvent)="onPaste($event, rowIndex, 'apr')"
                                                     [isBlue]="firstPreliminary == 'apr' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="May" prop="may" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !mayEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('may', mayEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex) && mayEditable">
                            <mat-form-field class="w-full px-1" [floatLabel]="'always'">
                                <input matInput formControlName="may" type="number"  min="0"  (input)="recalculateAnnualTotal()"  (paste)="onPaste($event, rowIndex,'may')" class="no-spinners"
                                       placeholder="0" pattern="\d*" [style.color]="{'blue' : firstPreliminary == 'may' && row.active=='Preliminary'}" [ngClass]="'text-right'"/>
                            </mat-form-field>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Jun" prop="jun" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader" [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !junEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('jun', junEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex) && junEditable">
                            <spot-input-forecast formControlName="jun" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateAnnualTotal()"  (pasteEvent)="onPaste($event, rowIndex, 'jun')"
                                                     [isBlue]="firstPreliminary == 'jun' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Jul" prop="jul" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false" [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !julEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('jul', julEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex) && julEditable">
                            <spot-input-forecast formControlName="jul" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateAnnualTotal()"  (pasteEvent)="onPaste($event, rowIndex, 'jul')"
                                                     [isBlue]="firstPreliminary == 'jul' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Aug" prop="aug" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader" [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !augEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('aug', augEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex) && augEditable">
                            <spot-input-forecast formControlName="aug" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateAnnualTotal()"  (pasteEvent)="onPaste($event, rowIndex, 'aug')"
                                                     [isBlue]="firstPreliminary == 'aug' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Sep" prop="sep" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false" [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !sepEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('sep', sepEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]"  class="mt-4 px-1"
                              *ngIf="fTableEditStack.includes(rowIndex) && sepEditable">
                                <spot-input-forecast formControlName="sep" [decimalCount]="0" [autoAddDecimal]="false"
                                                         (valueChanged)="recalculateAnnualTotal()"  (pasteEvent)="onPaste($event, rowIndex, 'sep')"
                                                         [isBlue]="firstPreliminary == 'sep' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>

                <ngx-datatable-column name="Oct" prop="oct" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false" [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !octEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('oct', octEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex) && octEditable">
                            <spot-input-forecast formControlName="oct" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateAnnualTotal()"  (pasteEvent)="onPaste($event, rowIndex, 'oct')"
                                                     [isBlue]="firstPreliminary == 'oct' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Nov" prop="nov" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false" [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !novEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('nov', novEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex) && novEditable">
                            <spot-input-forecast formControlName="nov" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateAnnualTotal()"  (pasteEvent)="onPaste($event, rowIndex, 'nov')"
                                                     [isBlue]="firstPreliminary == 'nov' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Dec" prop="dec" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false" [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !decEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('dec', decEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex) && decEditable">
                            <spot-input-forecast formControlName="dec" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateAnnualTotal()"  (pasteEvent)="onPaste($event, rowIndex, 'dec')"
                                                     [isBlue]="firstPreliminary == 'dec' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Jan" prop="jan" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false" [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !janEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('jan', janEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]"  class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex) && janEditable">
                            <spot-input-forecast formControlName="jan" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateAnnualTotal()"  (pasteEvent)="onPaste($event, rowIndex, 'jan')"
                                                     [isBlue]="firstPreliminary == 'jan' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Feb" prop="feb" [width]="150" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false" [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !febEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('feb', febEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex) && febEditable">
                            <spot-input-forecast formControlName="feb" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateAnnualTotal()"  (pasteEvent)="onPaste($event, rowIndex, 'feb')"
                                                     [isBlue]="firstPreliminary == 'feb' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Mar" prop="mar" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false" [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex) || !marEditable" (click)="fTableEditRow(rowIndex)" [ngClass]="getRowStyle('mar', marEditable,row)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex) && marEditable">
                            <spot-input-forecast formControlName="mar" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateAnnualTotal()"  (pasteEvent)="onPaste($event, rowIndex, 'mar')"
                                                     [isBlue]="firstPreliminary == 'mar' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="FY2023" prop="annualTotal" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false" [sortable]="false" [draggable]="false" >
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{y0Label}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a  (click)="fTableEditRow(rowIndex)" [ngClass]="'closed'">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                    </ng-template>
                </ngx-datatable-column>

            </ngx-datatable>
        </div>

    <!--    Y1 starts here-->

        <div class="overflow-y-hidden w-[94vw] h-auto pl-3 mt-4">
            <div class="flex items-center justify-start gap-3 pt-3 pr-3 ">
                <div class="mr-4 text-xl font-medium tracking-tight leading-6 truncate text-primary mb-2">{{y1Label}} (Next Fiscal Year)</div>
            </div>
            <ngx-datatable [headerHeight]="'auto'" [rowHeight]="'auto'" [scrollbarV]="false" columnMode="flex"
                           class="material font-medium text-sm text-default whitespace-nowrap cursor-pointer fast-load-table"
                           [rows]="forecastsY1">
                <ngx-datatable-column name="Reference" prop="active" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false">
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value">&nbsp;</p>
                            <p>{{value }}</p>
                        </a>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Apr" prop="apr" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex)" (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex)">
                            <spot-input-forecast formControlName="apr" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'apr')"
                                                     [isBlue]="firstPreliminary == 'apr' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="May" prop="may" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex)" (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex) ">
                            <spot-input-forecast formControlName="may" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'may')"
                                                     [isBlue]="firstPreliminary == 'may' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Jun" prop="jun" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex) " (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex)">
                            <spot-input-forecast formControlName="jun" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'jun')"
                                                     [isBlue]="firstPreliminary == 'jun' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Jul" prop="jul" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex)" (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex)">
                            <spot-input-forecast formControlName="jul" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'jul')"
                                                     [isBlue]="firstPreliminary == 'jul' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Aug" prop="aug" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex)" (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex)">
                            <spot-input-forecast formControlName="aug" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'aug')"
                                                     [isBlue]="firstPreliminary == 'aug' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Sep" prop="sep" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex)" (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex)">
                            <spot-input-forecast formControlName="sep" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'sep')"
                                                     [isBlue]="firstPreliminary == 'sep' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Oct" prop="oct" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex) " (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex)">
                            <spot-input-forecast formControlName="oct" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'oct')"
                                                     [isBlue]="firstPreliminary == 'oct' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Nov" prop="nov" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex) " (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex) ">
                            <spot-input-forecast formControlName="nov" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'nov')"
                                                     [isBlue]="firstPreliminary == 'nov' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Dec" prop="dec" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex)" (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex) ">
                            <spot-input-forecast formControlName="dec" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'dec')"
                                                     [isBlue]="firstPreliminary == 'dec' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Jan" prop="jan" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex)" (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex) ">
                            <spot-input-forecast formControlName="jan" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'jan')"
                                                     [isBlue]="firstPreliminary == 'jan' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Feb" prop="feb" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex) " (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex) ">
                            <spot-input-forecast formControlName="feb" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'feb')"
                                                     [isBlue]="firstPreliminary == 'feb' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Mar" prop="mar" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{column.name}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fy1TableEditStack.includes(rowIndex)" (click)="fy1TableEditRow(rowIndex)">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value ?  (value | number : fractionSize) : 0}}</p>
                        </a>
                        <form [formGroup]="forecastsY1Form.controls[rowIndex]" class="mt-4"
                              *ngIf="fy1TableEditStack.includes(rowIndex)">
                            <spot-input-forecast formControlName="mar" [decimalCount]="0" [autoAddDecimal]="false"
                                                     (valueChanged)="recalculateY1()"  (pasteEvent)="onPasteY1($event, rowIndex, 'mar')"
                                                     [isBlue]="firstPreliminary == 'mar' && row.active=='Preliminary'"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column  [flexGrow]="0.75" prop="annualTotal" [resizeable]="false" [sortable]="false" [draggable]="false" [headerClass]="getNgxDatatableNumberHeader">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{y1Label}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template >
                        <a (click)="fTableEditRow(rowIndex)" [ngClass]="'closed'">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{value | number : fractionSize}}</p>
                        </a>
                    </ng-template>
                </ngx-datatable-column>
            </ngx-datatable>
        </div>
        <div class="overflow-y-hidden w-[94vw] h-auto pl-3 mt-4" >
            <div class="flex items-center justify-start gap-3 pt-3 pr-3 ">
                <div class="mr-4 text-xl font-medium tracking-tight leading-6 truncate text-primary  mb-2">Yearly Totals</div>
            </div>
            <ngx-datatable [headerHeight]="'auto'" [rowHeight]="'auto'" [scrollbarV]="false" columnMode="flex"
                           class="material font-medium text-sm text-default whitespace-nowrap cursor-pointer fast-load-table"
                           [rows]="forecasts">
                <ngx-datatable-column name="Reference" prop="active" [flexGrow]="1" [resizeable]="false" [sortable]="false" [draggable]="false">
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a (click)="fTableEditRow(rowIndex)">
                            <p *ngIf="!value">&nbsp;</p>
                            <p>{{value}}</p>
                        </a>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Historical" prop="historical" [flexGrow]="0.75" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="grayBg headBgHeight"><div class="mr-2 pt-1">Historical</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template >
                        <a (click)="fTableEditRow(rowIndex)" [ngClass]="'closed'">
                            <p *ngIf="row.active == 'Plan' || row.active=='Previous'">&nbsp;</p>
                            <p *ngIf="row.active == 'Current' || row.active=='Preliminary'" style="text-align:right"> {{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column  prop="annualTotal"  [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                       [resizeable]="false"
                                       [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="blueBg headBgHeight"><div class="mr-2 pt-1">{{y0Label}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a (click)="fTableEditRow(rowIndex)" [ngClass]="'closed'">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column  prop="y1"  [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="greenBg headBgHeight"><div class="mr-2 pt-1">{{y1Label}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a (click)="fTableEditRow(rowIndex)" [ngClass]="'closed'">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="y2" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="pinkBg headBgHeight"><div class="mr-2 pt-1">{{y2Label}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template >
                        <a *ngIf="!fTableEditStack.includes(rowIndex)" (click)="fTableEditRow(rowIndex)" [ngClass]="{'closed': row.isopen==false}">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex)">
                            <spot-input-forecast formControlName="y2" [decimalCount]="0" [autoAddDecimal]="false"
                                                 (valueChanged)="recalculateTotalCapex()"  (pasteEvent)="onPaste($event, rowIndex, 'y2')"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="y3" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader" [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="pinkBg headBgHeight"><div class="mr-2 pt-1">{{y3Label}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex)" (click)="fTableEditRow(rowIndex)" [ngClass]="{'closed': row.isopen==false}">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex)">
                            <spot-input-forecast formControlName="y3" [decimalCount]="0" [autoAddDecimal]="false"
                                                 (valueChanged)="recalculateTotalCapex()"  (pasteEvent)="onPaste($event, rowIndex, 'y3')"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="y4" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="pinkBg headBgHeight"><div class="mr-2 pt-1">{{y4Label}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex)" (click)="fTableEditRow(rowIndex)" [ngClass]="{'closed': row.isopen==false}">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex)">
                            <spot-input-forecast formControlName="y4" [decimalCount]="0" [autoAddDecimal]="false"
                                                 (valueChanged)="recalculateTotalCapex()"  (pasteEvent)="onPaste($event, rowIndex, 'y4')"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column prop="y5" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="pinkBg headBgHeight"><div class="mr-2 pt-1">{{y5Label}}</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a *ngIf="!fTableEditStack.includes(rowIndex)" (click)="fTableEditRow(rowIndex)" [ngClass]="{'closed': row.isopen==false}">
                            <p *ngIf="!value && value!=0">&nbsp;</p>
                            <p style="text-align:right">{{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                        <form [formGroup]="forecastsForm.controls[rowIndex]" class="mt-4"
                              *ngIf="fTableEditStack.includes(rowIndex)">
                                <spot-input-forecast formControlName="y5" [decimalCount]="0" [autoAddDecimal]="false"
                                                         (valueChanged)="recalculateTotalCapex()"  (pasteEvent)="onPaste($event, rowIndex, 'y5')"></spot-input-forecast>
                        </form>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column *ngIf="mode=='Capex'" name="Total CAPEX" prop="cumulativeTotal" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="purpleBg headBgHeight"><div class="mr-2 pt-1">Total CAPEX</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a (click)="fTableEditRow(rowIndex)" [ngClass]="'closed'">
                            <p *ngIf="row.active == 'Plan' || row.active=='Previous'">&nbsp;</p>
                            <p *ngIf="row.active == 'Current' || row.active=='Preliminary'" style="text-align:right"> {{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                    </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column *ngIf="mode=='Opex'" name="Total OPEX" prop="cumulativeTotal" [flexGrow]="1" [headerClass]="getNgxDatatableNumberHeader"
                                      [resizeable]="false"
                                      [sortable]="false" [draggable]="false">
                    <ng-template let-column="column" ngx-datatable-header-template>
                        <ng-container>
                            <span class="datatable-header-cell-wrapper">
                                <span class="purpleBg headBgHeight"><div class="mr-2 pt-1">Total OPEX</div></span>
                            </span>
                        </ng-container>
                    </ng-template>
                    <ng-template let-row="row" let-rowIndex="rowIndex" let-value="value" ngx-datatable-cell-template>
                        <a (click)="fTableEditRow(rowIndex)" [ngClass]="'closed'">
                            <p *ngIf="row.active == 'Plan' || row.active=='Previous'">&nbsp;</p>
                            <p *ngIf="row.active == 'Current' || row.active=='Preliminary'" style="text-align:right"> {{(value ?  value : 0 ) | number : fractionSize}}</p>
                        </a>
                    </ng-template>
                </ngx-datatable-column>
            </ngx-datatable>
        </div>
        <form [formGroup]="budgetForecastForm" *ngIf="mode=='Capex'">
            <div class="grid m-2 grid-cols-4 gap-x-6 gap-y-0 w-19/20" >

                    <spot-singleselect-autocomplete class="w-full" formControlName="afpDeviationCode"
                                                    [label]="'AFP Deviation Code'" [placeholder]="'AFP Deviation Code'" [valuePointer]="'lookUpName'"  [Required]="false"
                                                    [dropDownArray]="getAfdDeviationCodes()" [sortByType]="'custom'" [customSortPointer]="'lookUpOrder'">
                    </spot-singleselect-autocomplete>
                    <spot-singleselect-autocomplete class="w-full" formControlName="mtdpDeviationCode"
                                                    [label]="'MTDP Deviation Code'" [placeholder]="'MTP Deviation Code'" [valuePointer]="'lookUpName'"  [Required]="false"
                                                    [dropDownArray]="getMtdpDeviationCodes()" [sortByType]="'custom'" [customSortPointer]="'lookUpOrder'">
                    </spot-singleselect-autocomplete>
                    <spot-input class="w-full" formControlName="committedSpend" [label]="'Committed Spend'" [autoAddDecimal]="false" [inputType]="'Number'" [decimalCount]="0">
                    </spot-input>
                    <spot-input class="w-full" formControlName="totalApprovedCapex" [autoAddDecimal]="false" [inputType]="'Number'" [decimalCount]="0"
                                [label]="'Total Approved CAPEX (' + this.localCurrency.localCurrencyAbbreviation + ')'"  *ngIf="mode === 'Capex'">
                    </spot-input>
            </div>
        </form>
    </div>
    <div class="absolute bottom-2 w-full px-3">
        <div class="pr-3 flex items-start justify-between mt-6">
            <a class="min-w-26" mat-flat-button [color]="'primary'" type="button"
               (click)="projecthubservice.toggleDrawerOpen('', '',[],'',true)">
                Cancel
            </a>
            <button class="min-w-26" mat-flat-button [color]="'primary'" [disabled]="!editable" (click)="submitForecasts()" type="button">
                Submit
            </button>
        </div>
    </div>
</div>




